function amzn_ads(e){"use strict";try{amznads.updateAds(e)}catch(t){try{}catch(n){}}}function aax_write(e,t){e.write(t),e.close()}function matchCookiePB(e){function t(e){if(!n){n=!0;var t=document.createElement("iframe");t.style.display="none",t.src=e.cmp,document.body.appendChild(t)}}var n=!1;document.addEventListener?document.addEventListener("DOMContentLoaded",function(){t(e)},!1):document.attachEvent&&document.attachEvent("onreadystatechange",function(){t(e)})}function aax_render_ad(e){var t,n,i,r,o,s,a,l;if(e&&e.cmp&&""!=e.cmp&&"undefined"!=e.cmp&&matchCookiePB(e),e.passback)return void aax_write(document,e.html);if(t=e.slotSize,!t)return void aax_write(document,e.html);n=t.indexOf("x"),i=t.substring(0,n),r=t.substring(n+1),o="amznad"+Math.round(1e6*Math.random()),aax_write(document,'<iframe id="'+o+'" width="'+i+'" height="'+r+'" src="javascript:\'\'" scrolling="no" frameborder="0" marginwidth="0" marginheight="0" bgcolor="#FFFFFF" topmargin="0" leftmargin="0" rightmargin="0" bottommargin="0"></iframe>');try{s=document.getElementById(o),a=s.contentWindow||s.contentDocument,a.document&&(a=a.document),aax_write(a,e.html);try{e.iid&&(document.write('<script type="text/javascript" src="'+amznpassback.CSM_JS+'"></script>'),document.write('<script type="text/javascript">'),l="aax.amazon-adsystem.com",document.write('  amzncsm.host="'+l+'";\n'),document.write('  amzncsm.rmC(document.getElementById("'+o+'"), "'+e.iid+'", window, document);'),document.write("</script>"),document.close())}catch(c){console&&console.log}}catch(u){s&&(s.style.display="none")}}function nativoComplete(){"use strict";jQuery(".zn.zn-staggered").each(function(){$staggeredZone=jQuery(this),layoutSize=($staggeredZone.attr("data-eq-state")||"").replace(/^(\S+\s+)*/,""),$staggeredZone.find(".zn__containers .column").each(function(){$staggeredColumn=jQuery(this),void 0!==$staggeredColumn.attr("class")&&$staggeredColumn.attr("class").indexOf("ntv")>-1&&($nativeContainer=$staggeredColumn.find(".cn").addClass("nativeSponsor").clone(),$staggeredColumn.remove(),$staggeredNativo=$staggeredZone.find(".column"),$staggeredNativo="xsmall"===layoutSize?$staggeredNativo.eq(0).find(".cn").eq(1):$staggeredNativo.eq(1).find(".cn").eq(0),$staggeredNativo.before($nativeContainer))})}),jQuery(".pg-wrapper").find("section.nativeSponsor").addClass("zn-loaded"),jQuery(window).load(function(){$nativeHubCarousel=jQuery(document.getElementById("ntv-videoZone")).find(".js-owl-carousel"),$nativeHubCarousel.length>0&&!isGalleryRendered&&(CNN.Carousel.restore($nativeHubCarousel.parent()),isGalleryRendered=!0)})}function onNativoRenderAd(e){"use strict";nativo.fbFeed=e.facebook_feed,nativo.twFeed=e.twitter_feed,nativo.twitterImage=e.twitter_image,nativo.authorName=e.author_name,nativo.epicAdName=e.native_adv,$nativeEmbedVideo=jQuery(document.getElementById("prx_full_ad_video")),$nativeEmbedVideo.length>0&&$nativeEmbedVideo.parent().addClass("ntv_video_p"),$bigPicture=jQuery(document.getElementById("bigPicture")),$bigPicture.length>0&&!isGalleryRendered&&(nativo.renderGallery(),isGalleryRendered=!0),jQuery(window).load(function(){nativo.renderAuthor(),nativo.renderFacebook(),nativo.renderTwitter(),nativo.renderEpic()})}function changeOwlCarousalWidth(){"use strict";var e=jQuery(".js-pg-sponsor .owl-stage-outer .owl-stage"),t=e.find(".owl-item").length;e.css("width",70*t)}!function(e,t,n){function i(e,t){return typeof e===t}function r(){var e,t,n,r,o,s,a;for(var l in C)if(C.hasOwnProperty(l)){if(e=[],t=C[l],t.name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(r=i(t.fn,"function")?t.fn():t.fn,o=0;o<e.length;o++)s=e[o],a=s.split("."),1===a.length?b[a[0]]=r:(!b[a[0]]||b[a[0]]instanceof Boolean||(b[a[0]]=new Boolean(b[a[0]])),b[a[0]][a[1]]=r),y.push((r?"":"no-")+a.join("-"))}}function o(e){var t=A.className,n=b._config.classPrefix||"";if(T&&(t=t.baseVal),b._config.enableJSClass){var i=new RegExp("(^|\\s)"+n+"no-js(\\s|$)");t=t.replace(i,"$1"+n+"js$2")}b._config.enableClasses&&(t+=" "+n+e.join(" "+n),T?A.className.baseVal=t:A.className=t)}function s(e,t){if("object"==typeof e)for(var n in e)P(e,n)&&s(n,e[n]);else{e=e.toLowerCase();var i=e.split("."),r=b[i[0]];if(2==i.length&&(r=r[i[1]]),"undefined"!=typeof r)return b;t="function"==typeof t?t():t,1==i.length?b[i[0]]=t:(!b[i[0]]||b[i[0]]instanceof Boolean||(b[i[0]]=new Boolean(b[i[0]])),b[i[0]][i[1]]=t),o([(t&&0!=t?"":"no-")+i.join("-")]),b._trigger(e,t)}return b}function a(e,t){return!!~(""+e).indexOf(t)}function l(){return"function"!=typeof t.createElement?t.createElement(arguments[0]):T?t.createElementNS.call(t,"http://www.w3.org/2000/svg",arguments[0]):t.createElement.apply(t,arguments)}function c(e){return e.replace(/([a-z])-([a-z])/g,function(e,t,n){return t+n.toUpperCase()}).replace(/^-/,"")}function u(){var e=t.body;return e||(e=l(T?"svg":"body"),e.fake=!0),e}function d(e,n,i,r){var o,s,a,c,d="modernizr",h=l("div"),p=u();if(parseInt(i,10))for(;i--;)a=l("div"),a.id=r?r[i]:d+(i+1),h.appendChild(a);return o=l("style"),o.type="text/css",o.id="s"+d,(p.fake?p:h).appendChild(o),p.appendChild(h),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),h.id=d,p.fake&&(p.style.background="",p.style.overflow="hidden",c=A.style.overflow,A.style.overflow="hidden",A.appendChild(p)),s=n(h,e),p.fake?(p.parentNode.removeChild(p),A.style.overflow=c,A.offsetHeight):h.parentNode.removeChild(h),!!s}function h(e,t){return function(){return e.apply(t,arguments)}}function p(e,t,n){var r;for(var o in e)if(e[o]in t)return n===!1?e[o]:(r=t[e[o]],i(r,"function")?h(r,n||t):r);return!1}function f(e){return e.replace(/([A-Z])/g,function(e,t){return"-"+t.toLowerCase()}).replace(/^ms-/,"-ms-")}function g(t,i){var r=t.length;if("CSS"in e&&"supports"in e.CSS){for(;r--;)if(e.CSS.supports(f(t[r]),i))return!0;return!1}if("CSSSupportsRule"in e){for(var o=[];r--;)o.push("("+f(t[r])+":"+i+")");return o=o.join(" or "),d("@supports ("+o+") { #modernizr { position: absolute; } }",function(e){return"absolute"==getComputedStyle(e,null).position})}return n}function m(e,t,r,o){function s(){d&&(delete F.style,delete F.modElem)}if(o=i(o,"undefined")?!1:o,!i(r,"undefined")){var u=g(e,r);if(!i(u,"undefined"))return u}for(var d,h,p,f,m,_=["modernizr","tspan"];!F.style;)d=!0,F.modElem=l(_.shift()),F.style=F.modElem.style;for(p=e.length,h=0;p>h;h++)if(f=e[h],m=F.style[f],a(f,"-")&&(f=c(f)),F.style[f]!==n){if(o||i(r,"undefined"))return s(),"pfx"==t?f:!0;try{F.style[f]=r}catch(v){}if(F.style[f]!=m)return s(),"pfx"==t?f:!0}return s(),!1}function _(e,t,n,r,o){var s=e.charAt(0).toUpperCase()+e.slice(1),a=(e+" "+R.join(s+" ")+s).split(" ");return i(t,"string")||i(t,"undefined")?m(a,t,r,o):(a=(e+" "+k.join(s+" ")+s).split(" "),p(a,t,n))}function v(e,t,i){return _(e,n,n,t,i)}var y=[],C=[],w={_version:"3.3.1",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout(function(){t(n[e])},0)},addTest:function(e,t,n){C.push({name:e,fn:t,options:n})},addAsyncTest:function(e){C.push({name:null,fn:e})}},b=function(){};b.prototype=w,b=new b,b.addTest("geolocation","geolocation"in navigator),b.addTest("websockets","WebSocket"in e&&2===e.WebSocket.CLOSING),b.addTest("localstorage",function(){var e="modernizr";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(t){return!1}}),b.addTest("webworkers","Worker"in e);var E=w._config.usePrefixes?" -webkit- -moz- -o- -ms- ".split(" "):["",""];w._prefixes=E;var A=t.documentElement,T="svg"===A.nodeName.toLowerCase();T||!function(e,t){function n(e,t){var n=e.createElement("p"),i=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",i.insertBefore(n.lastChild,i.firstChild)}function i(){var e=y.elements;return"string"==typeof e?e.split(" "):e}function r(e,t){var n=y.elements;"string"!=typeof n&&(n=n.join(" ")),"string"!=typeof e&&(e=e.join(" ")),y.elements=n+" "+e,c(t)}function o(e){var t=v[e[m]];return t||(t={},_++,e[m]=_,v[_]=t),t}function s(e,n,i){if(n||(n=t),d)return n.createElement(e);i||(i=o(n));var r;return r=i.cache[e]?i.cache[e].cloneNode():g.test(e)?(i.cache[e]=i.createElem(e)).cloneNode():i.createElem(e),!r.canHaveChildren||f.test(e)||r.tagUrn?r:i.frag.appendChild(r)}function a(e,n){if(e||(e=t),d)return e.createDocumentFragment();n=n||o(e);for(var r=n.frag.cloneNode(),s=0,a=i(),l=a.length;l>s;s++)r.createElement(a[s]);return r}function l(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return y.shivMethods?s(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+i().join().replace(/[\w\-:]+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(y,t.frag)}function c(e){e||(e=t);var i=o(e);return!y.shivCSS||u||i.hasCSS||(i.hasCSS=!!n(e,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),d||l(e,i),e}var u,d,h="3.7.3",p=e.html5||{},f=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,g=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,m="_html5shiv",_=0,v={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",u="hidden"in e,d=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(n){u=!0,d=!0}}();var y={elements:p.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output picture progress section summary template time video",version:h,shivCSS:p.shivCSS!==!1,supportsUnknownElements:d,shivMethods:p.shivMethods!==!1,type:"default",shivDocument:c,createElement:s,createDocumentFragment:a,addElements:r};e.html5=y,c(t),"object"==typeof module&&module.exports&&(module.exports=y)}("undefined"!=typeof e?e:this,t);var S="Moz O ms Webkit",k=w._config.usePrefixes?S.toLowerCase().split(" "):[];w._domPrefixes=k;var P;!function(){var e={}.hasOwnProperty;P=i(e,"undefined")||i(e.call,"undefined")?function(e,t){return t in e&&i(e.constructor.prototype[t],"undefined")}:function(t,n){return e.call(t,n)}}(),w._l={},w.on=function(e,t){this._l[e]||(this._l[e]=[]),this._l[e].push(t),b.hasOwnProperty(e)&&setTimeout(function(){b._trigger(e,b[e])},0)},w._trigger=function(e,t){if(this._l[e]){var n=this._l[e];setTimeout(function(){var e,i;for(e=0;e<n.length;e++)(i=n[e])(t)},0),delete this._l[e]}},b._q.push(function(){w.addTest=s});var x="CSS"in e&&"supports"in e.CSS,I="supportsCSS"in e;b.addTest("supports",x||I);var R=w._config.usePrefixes?S.split(" "):[];w._cssomPrefixes=R;var L=w.testStyles=d;b.addTest("touchevents",function(){var n;if("ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch)n=!0;else{var i=["@media (",E.join("touch-enabled),("),"heartz",")","{#modernizr{top:9px;position:absolute}}"].join("");L(i,function(e){n=9===e.offsetTop})}return n});var D=function(){var e=navigator.userAgent,t=e.match(/applewebkit\/([0-9]+)/gi)&&parseFloat(RegExp.$1),n=e.match(/w(eb)?osbrowser/gi),i=e.match(/windows phone/gi)&&e.match(/iemobile\/([0-9])+/gi)&&parseFloat(RegExp.$1)>=9,r=533>t&&e.match(/android/gi);return n||r||i}();D?b.addTest("fontface",!1):L('@font-face {font-family:"font";src:url("https://")}',function(e,n){var i=t.getElementById("smodernizr"),r=i.sheet||i.styleSheet,o=r?r.cssRules&&r.cssRules[0]?r.cssRules[0].cssText:r.cssText||"":"",s=/src/i.test(o)&&0===o.indexOf(n.split(" ")[0]);b.addTest("fontface",s)});var O={elem:l("modernizr")};b._q.push(function(){delete O.elem});var F={style:O.elem.style};b._q.unshift(function(){delete F.style});var M=w.testProp=function(e,t,i){return m([e],n,t,i)};b.addTest("textshadow",M("textShadow","1px 1px")),w.testAllProps=_,w.testAllProps=v,function(){b.addTest("csscolumns",function(){var e=!1,t=v("columnCount");try{(e=!!t)&&(e=new Boolean(e))}catch(n){}return e});for(var e,t,n=["Width","Span","Fill","Gap","Rule","RuleColor","RuleStyle","RuleWidth","BreakBefore","BreakAfter","BreakInside"],i=0;i<n.length;i++)e=n[i].toLowerCase(),t=v("column"+n[i]),("breakbefore"===e||"breakafter"===e||"breakinside"==e)&&(t=t||v(n[i])),b.addTest("csscolumns."+e,t)}(),b.addTest("flexbox",v("flexBasis","1px",!0)),b.addTest("csstransforms3d",function(){var e=!!v("perspective","1px",!0),t=b._config.usePrefixes;if(e&&(!t||"webkitPerspective"in A.style)){var n,i="#modernizr{width:0;height:0}";b.supports?n="@supports (perspective: 1px)":(n="@media (transform-3d)",t&&(n+=",(-webkit-transform-3d)")),n+="{#modernizr{width:7px;height:18px;margin:0;padding:0;border:0}}",L(i+n,function(t){e=7===t.offsetWidth&&18===t.offsetHeight})}return e}),r(),o(y),delete w.addTest,delete w.addAsyncTest;for(var N=0;N<b._q.length;N++)b._q[N]();e.Modernizr=b}(window,document),Modernizr.addTest("ios",function(){"use strict";return!!navigator.userAgent.match(/(iPod|iPhone|iPad)/i)}),Modernizr.addTest("android",function(){"use strict";return!!navigator.userAgent.match(/android/i)}),Modernizr.addTest("iemobile",function(){"use strict";return!!navigator.userAgent.match(/iemobile/i)}),Modernizr.addTest("ie8",function(){"use strict";var e,t=-1,n=navigator.userAgent,i=!1;return n.match(/MSIE/i)&&(e=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!==e.exec(n)&&(t=parseFloat(RegExp.$1),8===t&&(i=!0))),i}),Modernizr.addTest("ie",function(){"use strict";return navigator.userAgent.search(/\s+(MSIE|rv:11|Edge\/\d+\.)/)>=0}),Modernizr.addTest("edge",function(){"use strict";return navigator.userAgent.search(/\s+(Edge\/\d+\.)/)>=0}),function(e){var t=navigator.userAgent;e.HTMLPictureElement&&/ecko/.test(t)&&t.match(/rv\:(\d+)/)&&RegExp.$1<45&&addEventListener("resize",function(){var t,n=document.createElement("source"),i=function(e){var t,i,r=e.parentNode;"PICTURE"===r.nodeName.toUpperCase()?(t=n.cloneNode(),r.insertBefore(t,r.firstElementChild),setTimeout(function(){r.removeChild(t)})):(!e._pfLastSize||e.offsetWidth>e._pfLastSize)&&(e._pfLastSize=e.offsetWidth,i=e.sizes,e.sizes+=",100vw",setTimeout(function(){e.sizes=i}))},r=function(){var e,t=document.querySelectorAll("picture > img, img[srcset][sizes]");for(e=0;e<t.length;e++)i(t[e])},o=function(){clearTimeout(t),t=setTimeout(r,99)},s=e.matchMedia&&matchMedia("(orientation: landscape)"),a=function(){o(),s&&s.addListener&&s.addListener(o)};return n.srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",/^[c|i]|d$/.test(document.readyState||"")?a():document.addEventListener("DOMContentLoaded",a),o}())}(window),function(e,t,n){"use strict";function i(e){return" "===e||"	"===e||"\n"===e||"\f"===e||"\r"===e}function r(t,n){var i=new e.Image;return i.onerror=function(){S[t]=!1,te()},i.onload=function(){S[t]=1===i.width,te()},i.src=n,"pending"}function o(){j=!1,q=e.devicePixelRatio,B={},U={},v.DPR=q||1,V.width=Math.max(e.innerWidth||0,T.clientWidth),V.height=Math.max(e.innerHeight||0,T.clientHeight),V.vw=V.width/100,V.vh=V.height/100,_=[V.height,V.width,q].join("-"),V.em=v.getEmValue(),V.rem=V.em}function s(e,t,n,i){var r,o,s,a;return"saveData"===k.algorithm?e>2.7?a=n+1:(o=t-n,r=Math.pow(e-.6,1.5),s=o*r,i&&(s+=.1*r),a=e+s):a=n>1?Math.sqrt(e*t):e,a>n}function a(e){var t,n=v.getSet(e),i=!1;"pending"!==n&&(i=_,n&&(t=v.setRes(n),v.applySetCandidate(t,e))),e[v.ns].evaled=i}function l(e,t){return e.res-t.res}function c(e,t,n){var i;return!n&&t&&(n=e[v.ns].sets,n=n&&n[n.length-1]),i=u(t,n),i&&(t=v.makeUrl(t),e[v.ns].curSrc=t,e[v.ns].curCan=i,i.res||ee(i,i.set.sizes)),i}function u(e,t){var n,i,r;if(e&&t)for(r=v.parseSet(t),e=v.makeUrl(e),n=0;n<r.length;n++)if(e===v.makeUrl(r[n].url)){i=r[n];break}return i}function d(e,t){var n,i,r,o,s=e.getElementsByTagName("source");for(n=0,i=s.length;i>n;n++)r=s[n],r[v.ns]=!0,o=r.getAttribute("srcset"),o&&t.push({srcset:o,media:r.getAttribute("media"),type:r.getAttribute("type"),sizes:r.getAttribute("sizes")})}function h(e,t){function n(t){var n,i=t.exec(e.substring(h));return i?(n=i[0],h+=n.length,n):void 0}function r(){var e,n,i,r,o,l,c,u,d,h=!1,f={};for(r=0;r<a.length;r++)o=a[r],l=o[o.length-1],c=o.substring(0,o.length-1),u=parseInt(c,10),d=parseFloat(c),J.test(c)&&"w"===l?((e||n)&&(h=!0),0===u?h=!0:e=u):G.test(c)&&"x"===l?((e||n||i)&&(h=!0),0>d?h=!0:n=d):J.test(c)&&"h"===l?((i||n)&&(h=!0),0===u?h=!0:i=u):h=!0;h||(f.url=s,e&&(f.w=e),n&&(f.d=n),i&&(f.h=i),i||n||e||(f.d=1),1===f.d&&(t.has1x=!0),f.set=t,p.push(f))}function o(){for(n(H),l="",c="in descriptor";;){if(u=e.charAt(h),"in descriptor"===c)if(i(u))l&&(a.push(l),l="",c="after descriptor");else{if(","===u)return h+=1,l&&a.push(l),void r();if("("===u)l+=u,c="in parens";else{if(""===u)return l&&a.push(l),void r();l+=u}}else if("in parens"===c)if(")"===u)l+=u,c="in descriptor";else{if(""===u)return a.push(l),void r();l+=u}else if("after descriptor"===c)if(i(u));else{if(""===u)return void r();c="in descriptor",h-=1}h+=1}}for(var s,a,l,c,u,d=e.length,h=0,p=[];;){if(n(W),h>=d)return p;s=n(K),a=[],","===s.slice(-1)?(s=s.replace($,""),r()):o()}}function p(e){function t(e){function t(){o&&(s.push(o),o="")}function n(){s[0]&&(a.push(s),s=[])}for(var r,o="",s=[],a=[],l=0,c=0,u=!1;;){if(r=e.charAt(c),""===r)return t(),n(),a;if(u){if("*"===r&&"/"===e[c+1]){u=!1,c+=2,t();continue}c+=1}else{if(i(r)){if(e.charAt(c-1)&&i(e.charAt(c-1))||!o){c+=1;continue}if(0===l){t(),c+=1;continue}r=" "}else if("("===r)l+=1;else if(")"===r)l-=1;else{if(","===r){t(),n(),c+=1;continue}if("/"===r&&"*"===e.charAt(c+1)){u=!0,c+=2;continue}}o+=r,c+=1}}}function n(e){return u.test(e)&&parseFloat(e)>=0?!0:d.test(e)?!0:"0"===e||"-0"===e||"+0"===e}var r,o,s,a,l,c,u=/^(?:[+-]?[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?(?:ch|cm|em|ex|in|mm|pc|pt|px|rem|vh|vmin|vmax|vw)$/i,d=/^calc\((?:[0-9a-z \.\+\-\*\/\(\)]+)\)$/i;for(o=t(e),s=o.length,r=0;s>r;r++)if(a=o[r],l=a[a.length-1],n(l)){if(c=l,a.pop(),0===a.length)return c;if(a=a.join(" "),v.matchesMedia(a))return c}return"100vw"}t.createElement("picture");var f,g,m,_,v={},y=!1,C=function(){},w=t.createElement("img"),b=w.getAttribute,E=w.setAttribute,A=w.removeAttribute,T=t.documentElement,S={},k={algorithm:""},P="data-pfsrc",x=P+"set",I=navigator.userAgent,R=/rident/.test(I)||/ecko/.test(I)&&I.match(/rv\:(\d+)/)&&RegExp.$1>35,L="currentSrc",D=/\s+\+?\d+(e\d+)?w/,O=/(\([^)]+\))?\s*(.+)/,F=e.picturefillCFG,M="position:absolute;left:0;visibility:hidden;display:block;padding:0;border:none;font-size:1em;width:1em;overflow:hidden;clip:rect(0px, 0px, 0px, 0px)",N="font-size:100%!important;",j=!0,B={},U={},q=e.devicePixelRatio,V={px:1,"in":96},z=t.createElement("a"),Q=!1,H=/^[ \t\n\r\u000c]+/,W=/^[, \t\n\r\u000c]+/,K=/^[^ \t\n\r\u000c]+/,$=/[,]+$/,J=/^\d+$/,G=/^-?(?:[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?$/,X=function(e,t,n,i){e.addEventListener?e.addEventListener(t,n,i||!1):e.attachEvent&&e.attachEvent("on"+t,n)},Y=function(e){var t={};return function(n){return n in t||(t[n]=e(n)),t[n]}},Z=function(){var e=/^([\d\.]+)(em|vw|px)$/,t=function(){for(var e=arguments,t=0,n=e[0];++t in e;)n=n.replace(e[t],e[++t]);return n},n=Y(function(e){return"return "+t((e||"").toLowerCase(),/\band\b/g,"&&",/,/g,"||",/min-([a-z-\s]+):/g,"e.$1>=",/max-([a-z-\s]+):/g,"e.$1<=",/calc([^)]+)/g,"($1)",/(\d+[\.]*[\d]*)([a-z]+)/g,"($1 * e.$2)",/^(?!(e.[a-z]|[0-9\.&=|><\+\-\*\(\)\/])).*/gi,"")+";"});return function(t,i){var r;if(!(t in B))if(B[t]=!1,i&&(r=t.match(e)))B[t]=r[1]*V[r[2]];else try{B[t]=new Function("e",n(t))(V)}catch(o){}return B[t]}}(),ee=function(e,t){return e.w?(e.cWidth=v.calcListLength(t||"100vw"),e.res=e.w/e.cWidth):e.res=e.d,e},te=function(e){if(y){var n,i,r,o=e||{};if(o.elements&&1===o.elements.nodeType&&("IMG"===o.elements.nodeName.toUpperCase()?o.elements=[o.elements]:(o.context=o.elements,o.elements=null)),n=o.elements||v.qsa(o.context||t,o.reevaluate||o.reselect?v.sel:v.selShort),r=n.length){for(v.setupRun(o),Q=!0,i=0;r>i;i++)v.fillImg(n[i],o);v.teardownRun(o)}}};f=e.console&&console.warn?function(e){console.warn(e)}:C,L in w||(L="src"),S["image/jpeg"]=!0,S["image/gif"]=!0,S["image/png"]=!0,S["image/svg+xml"]=t.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1"),v.ns=("pf"+(new Date).getTime()).substr(0,9),v.supSrcset="srcset"in w,v.supSizes="sizes"in w,v.supPicture=!!e.HTMLPictureElement,v.supSrcset&&v.supPicture&&!v.supSizes&&!function(e){w.srcset="data:,a",e.src="data:,a",v.supSrcset=w.complete===e.complete,v.supPicture=v.supSrcset&&v.supPicture}(t.createElement("img")),v.supSrcset&&!v.supSizes?!function(){var e="data:image/gif;base64,R0lGODlhAgABAPAAAP///wAAACH5BAAAAAAALAAAAAACAAEAAAICBAoAOw==",n="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",i=t.createElement("img"),r=function(){var e=i.width;2===e&&(v.supSizes=!0),m=v.supSrcset&&!v.supSizes,y=!0,setTimeout(te)};i.onload=r,i.onerror=r,i.setAttribute("sizes","9px"),i.srcset=n+" 1w,"+e+" 9w",i.src=n}():y=!0,v.selShort="picture>img,img[srcset]",v.sel=v.selShort,v.cfg=k,v.DPR=q||1,v.u=V,v.types=S,v.setSize=C,v.makeUrl=Y(function(e){return z.href=e,z.href}),v.qsa=function(e,t){return"querySelector"in e?e.querySelectorAll(t):[]},v.matchesMedia=function(){return e.matchMedia&&(matchMedia("(min-width: 0.1em)")||{}).matches?v.matchesMedia=function(e){return!e||matchMedia(e).matches}:v.matchesMedia=v.mMQ,v.matchesMedia.apply(this,arguments)},v.mMQ=function(e){return e?Z(e):!0},v.calcLength=function(e){var t=Z(e,!0)||!1;return 0>t&&(t=!1),t},v.supportsType=function(e){return e?S[e]:!0},v.parseSize=Y(function(e){var t=(e||"").match(O);return{media:t&&t[1],length:t&&t[2]}}),v.parseSet=function(e){return e.cands||(e.cands=h(e.srcset,e)),e.cands},v.getEmValue=function(){var e;if(!g&&(e=t.body)){var n=t.createElement("div"),i=T.style.cssText,r=e.style.cssText;n.style.cssText=M,T.style.cssText=N,e.style.cssText=N,e.appendChild(n),g=n.offsetWidth,e.removeChild(n),g=parseFloat(g,10),T.style.cssText=i,e.style.cssText=r}return g||16},v.calcListLength=function(e){if(!(e in U)||k.uT){var t=v.calcLength(p(e));U[e]=t?t:V.width}return U[e]},v.setRes=function(e){var t;if(e){t=v.parseSet(e);for(var n=0,i=t.length;i>n;n++)ee(t[n],e.sizes)}return t},v.setRes.res=ee,v.applySetCandidate=function(e,t){if(e.length){var n,i,r,o,a,u,d,h,p,f=t[v.ns],g=v.DPR;if(u=f.curSrc||t[L],d=f.curCan||c(t,u,e[0].set),d&&d.set===e[0].set&&(p=R&&!t.complete&&d.res-.1>g,p||(d.cached=!0,d.res>=g&&(a=d))),!a)for(e.sort(l),o=e.length,a=e[o-1],i=0;o>i;i++)if(n=e[i],n.res>=g){r=i-1,a=e[r]&&(p||u!==v.makeUrl(n.url))&&s(e[r].res,n.res,g,e[r].cached)?e[r]:n;break}a&&(h=v.makeUrl(a.url),f.curSrc=h,f.curCan=a,h!==u&&v.setSrc(t,a),v.setSize(t))}},v.setSrc=function(e,t){var n;e.src=t.url,"image/svg+xml"===t.set.type&&(n=e.style.width,e.style.width=e.offsetWidth+1+"px",e.offsetWidth+1&&(e.style.width=n))},v.getSet=function(e){var t,n,i,r=!1,o=e[v.ns].sets;for(t=0;t<o.length&&!r;t++)if(n=o[t],n.srcset&&v.matchesMedia(n.media)&&(i=v.supportsType(n.type))){"pending"===i&&(n=i),r=n;break}return r},v.parseSets=function(e,t,i){var r,o,s,a,l=t&&"PICTURE"===t.nodeName.toUpperCase(),c=e[v.ns];(c.src===n||i.src)&&(c.src=b.call(e,"src"),c.src?E.call(e,P,c.src):A.call(e,P)),(c.srcset===n||i.srcset||!v.supSrcset||e.srcset)&&(r=b.call(e,"srcset"),c.srcset=r,a=!0),c.sets=[],l&&(c.pic=!0,d(t,c.sets)),c.srcset?(o={srcset:c.srcset,sizes:b.call(e,"sizes")},c.sets.push(o),s=(m||c.src)&&D.test(c.srcset||""),s||!c.src||u(c.src,o)||o.has1x||(o.srcset+=", "+c.src,o.cands.push({url:c.src,d:1,set:o}))):c.src&&c.sets.push({srcset:c.src,sizes:null}),c.curCan=null,c.curSrc=n,c.supported=!(l||o&&!v.supSrcset||s&&!v.supSizes),a&&v.supSrcset&&!c.supported&&(r?(E.call(e,x,r),e.srcset=""):A.call(e,x)),c.supported&&!c.srcset&&(!c.src&&e.src||e.src!==v.makeUrl(c.src))&&(null===c.src?e.removeAttribute("src"):e.src=c.src),c.parsed=!0},v.fillImg=function(e,t){var n,i=t.reselect||t.reevaluate;e[v.ns]||(e[v.ns]={}),n=e[v.ns],(i||n.evaled!==_)&&(n.parsed&&!t.reevaluate||v.parseSets(e,e.parentNode,t),n.supported?n.evaled=_:a(e))},v.setupRun=function(){Q&&!j&&q===e.devicePixelRatio||o()},v.supPicture?(te=C,v.fillImg=C):!function(){var n,i=e.attachEvent?/d$|^c/:/d$|^c|^i/,r=function(){var e=t.readyState||"";o=setTimeout(r,"loading"===e?200:999),t.body&&(v.fillImgs(),n=n||i.test(e),n&&clearTimeout(o))},o=setTimeout(r,t.body?9:99),s=function(e,t){var n,i,r=function(){var o=new Date-i;t>o?n=setTimeout(r,t-o):(n=null,e())};return function(){i=new Date,n||(n=setTimeout(r,t))}},a=T.clientHeight,l=function(){j=Math.max(e.innerWidth||0,T.clientWidth)!==V.width||T.clientHeight!==a,a=T.clientHeight,j&&v.fillImgs()};X(e,"resize",s(l,99)),X(t,"readystatechange",r)}(),v.picturefill=te,v.fillImgs=te,v.teardownRun=C,te._=v,e.picturefillCFG={pf:v,push:function(e){var t=e.shift();"function"==typeof v[t]?v[t].apply(v,e):(k[t]=e[0],Q&&v.fillImgs({reselect:!0}))}};for(;F&&F.length;)e.picturefillCFG.push(F.shift());e.picturefill=te,"object"==typeof module&&"object"==typeof module.exports?module.exports=te:"function"==typeof define&&define.amd&&define("picturefill",function(){return te}),v.supPicture||(S["image/webp"]=r("image/webp","data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAABBxAR/Q9ERP8DAABWUDggGAAAADABAJ0BKgEAAQADADQlpAADcAD++/1QAA=="))}(window,document),Date.now||(Date.now=function(){return(new Date).getTime()}),function(e){var t,n=function(){},i=[];e.console=e.console||{},t=e.console,t.log||(t.log=n),t.debug||(t.debug=t.log),t.error||(t.error=t.log),t.info||(t.info=t.log),t.warn||(t.warn=t.log),t.trace||(t.trace=n),t.group||(t.group=function(e){"string"!=typeof e&&(e=Number(i.length+1).toString()),i.push(e),t.log("---- START GROUP: "+e)},t.groupCollapsed=t.group,t.groupEnd=function(){t.log("---- END GROUP: "+(i.length>0?i.pop():"???"))})}(window),Array.prototype.find||(Array.prototype.find=function(e){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");var t,n,i=Object(this),r=i.length>>>0,o=arguments[1];for(t=0;r>t;t++)if(n=i[t],e.call(o,n,t,i))return n}),"document"in self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))?!function(){"use strict";var e,t,n=document.createElement("_");n.classList.add("c1","c2"),n.classList.contains("c2")||(t=function(e){var t=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(e){var n,i=arguments.length;for(n=0;i>n;n++)e=arguments[n],t.call(this,e)}},t("add"),t("remove")),n.classList.toggle("c3",!1),n.classList.contains("c3")&&(e=DOMTokenList.prototype.toggle,DOMTokenList.prototype.toggle=function(t,n){return 1 in arguments&&!this.contains(t)==!n?n:e.call(this,t)}),n=null}():!function(e){"use strict";if("Element"in e){var t="classList",n="prototype",i=e.Element[n],r=Object,o=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},s=Array[n].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1},a=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},l=function(e,t){if(""===t)throw new a("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new a("INVALID_CHARACTER_ERR","String contains an invalid character");return s.call(e,t)},c=function(e){for(var t=o.call(e.getAttribute("class")||""),n=t?t.split(/\s+/):[],i=0,r=n.length;r>i;i++)this.push(n[i]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},u=c[n]=[],d=function(){return new c(this)};if(a[n]=Error[n],u.item=function(e){return this[e]||null},u.contains=function(e){return e+="",-1!==l(this,e)},u.add=function(){var e,t=arguments,n=0,i=t.length,r=!1;do e=t[n]+"",-1===l(this,e)&&(this.push(e),r=!0);while(++n<i);r&&this._updateClassName()},u.remove=function(){var e,t,n=arguments,i=0,r=n.length,o=!1;do for(e=n[i]+"",t=l(this,e);-1!==t;)this.splice(t,1),o=!0,t=l(this,e);while(++i<r);o&&this._updateClassName()},u.toggle=function(e,t){e+="";var n=this.contains(e),i=n?t!==!0&&"remove":t!==!1&&"add";return i&&this[i](e),t===!0||t===!1?t:!n},u.toString=function(){return this.join(" ")},r.defineProperty){var h={get:d,enumerable:!0,configurable:!0};try{r.defineProperty(i,t,h)}catch(p){-2146823252===p.number&&(h.enumerable=!1,r.defineProperty(i,t,h))}}else r[n].__defineGetter__&&i.__defineGetter__(t,d)}}(self));var amznads,amznpassback=amznpassback||{};if(amznpassback.CPM_JS||(amznpassback.CSM_JS="//c.amazon-adsystem.com/aax2/csm.js.gz"),amznads=function(e,t,n){"use strict";function i(t,n,r){this.startTime=null,this.stopTime=null,this.sourceId=n,this.sync=t,this.mode=r,this.latency=null,i.prototype.startTimer=function(){this.startTime=Date.now()},i.prototype.stopTimer=function(){this.stopTime=Date.now()},i.prototype.stopTimerAndReportLatency=function(){this.stopTimer(),this.calculateLatency(),this.isThrottled()||this.reportLatency()},i.prototype.calculateLatency=function(){this.latency=this.stopTime-this.startTime},i.prototype.isThrottled=function(){var t,n=parseInt(e.latencySamplingRate,10);if(!isNaN(n)){if(0==n)return!0;if(100==n)return!1;if(t=100*Math.random(),n>=t)return!1}return!0},i.prototype.reportLatency=function(){var t,n;null!=this.latency&&this.latency>0&&(t='/{"c":"dtb","src":"'+this.sourceId+'","'+(this.sync?"bls":"bla")+'":"'+this.latency+'","m":"'+this.mode+'"}',n=e.protocol+e.host+e.px_svc+"PH"+t,(new Image).src=n)}}var r,o="https:"===t.location.protocol;return e.latencyUtil=e.latencyUtil||null,e.protocol=o?"https://":"http://",e.DEFAULT_HOST="aax.amazon-adsystem.com",e.host=e.DEFAULT_HOST,e.dtb_svc="/e/dtb/bid",e.pb_svc="/x/getad",e.px_svc="/x/px/",e.debug_mode=e.debug_mode||!1,e.MIN_TIMEOUT=0,e.DEFAULT_TIMEOUT=1e3,e.targetingKey="amznslots",e.latencySamplingRate=1,e.vidKey="amzn_vid",e.tasks=e.tasks||[],e.VIEWABILITY_CUTOFF_AREA=e.VIEWABILITY_CUTOFF_AREA||.5,e.VIEWABILITY_CUTOFF_DURATION_SEC=e.VIEWABILITY_CUTOFF_DURATION_SEC||1,e.CSM_JS="//c.amazon-adsystem.com/aax2/csm.js.gz",e.vads={},r="_d",e.ads||(e.ads={}),e.updateAds=function(t){var n,i;if(e.ads=t.ads,e.ev=t.ev,t.vads){e.vads=t.vads,e.ads||(e.ads={}),i=!1;for(n in t.vads)t.vads.hasOwnProperty(n)&&-1!=n.indexOf(r)&&(e.ads[n]=t.vads[n],e.amzn_vid=t.vads[n],i=!0);if(!i)for(n in t.vads)t.vads.hasOwnProperty(n)&&(e.ads[n]=t.vads[n],e.amzn_vid=t.vads[n])}e.doAllTasks(),e.tasks.push=function(t){e.doTask(t)};try{t.lsr&&(e.latencySamplingRate=t.lsr),null!=e.latencyUtil&&e.latencyUtil.stopTimerAndReportLatency()}catch(o){}},e.saveAds=function(t){e.saved_ads=t.ads,e.updateAds(t)},e.getAdForSlot=function(n,i,r){var o,s,a,l;e.src_id=n,o=o||{},s=o.u,s||(s=e.getReferrerURL()),s&&-1!==s.indexOf("amzn_debug_mode")&&(e.debug_mode=!0),a="src="+e.src_id+"&slot_uuid="+i+"&c=100&u="+s+"&cb="+Math.round(1e7*Math.random()),l=e.protocol+e.host+e.pb_svc+"?jsd=1&"+a,r?e.appendScriptTag(l):aax_write(t,"<script type='text/javascript' src='"+l+"'></script>")},e.getAdsCallback=function(t,n,i,r,o){var s=null;o=o||{};try{n&&"function"==typeof n&&(s=e.handleCallBack(n,i))}catch(a){}o.to||(o.to=i),e.doGetAdsAsync(t,r,o,s)},e.getVideoAdsCallback=function(t,n,i,r,o){var o=o||{};o.mt="V",e.getAdsCallback(t,n,i,r,o)},e.getDisplayAdsCallback=function(t,n,i,r,o){var o=o||{};o.mt="D",e.getAdsCallback(t,n,i,r,o)},e.getAdsAsync=function(t,n,i){e.doGetAdsAsync(t,n,i)},e.getVideoAdsAsync=function(t,n,i){var i=i||{};i.mt="V",e.getAdsAsync(t,n,i)},e.getDisplayAdsAsync=function(t,n,i){var i=i||{};i.mt="D",e.getAdsAsync(t,n,i)},e.handleCallBack=function(t,i){var r=!1,o=null,s=function(e){if(!r){try{t(e),o&&clearTimeout(o)}catch(n){}r=!0}},a=e.getValidMilliseconds(i);return o=a?n.setTimeout(s,a):n.setTimeout(s,e.DEFAULT_TIMEOUT),s},e.getValidMilliseconds=function(t){if(!t)return!1;
try{var n=~~Number(t);if(n>e.MIN_TIMEOUT)return n}catch(i){return!1}return!1},e.getAds=function(n,r,o,s){if(s)return void e.doGetAdsAsync(n,r,o);var a=e.getScriptSource(n,r,o);try{e.latencyUtil=new i(!0,n,o&&o.mt?o.mt:"DV"),e.latencyUtil.startTimer()}catch(l){}aax_write(t,"<script type='text/javascript' src='"+a+"'></script>")},e.getVideoAds=function(t,n,i,r){var i=i||{};i.mt="V",e.getAds(t,n,i,r)},e.getDisplayAds=function(t,n,i,r){var i=i||{};i.mt="D",e.getAds(t,n,i,r)},e.doGetAdsAsync=function(t,n,r,o){var s=e.getScriptSource(t,n,r);try{e.latencyUtil=new i(!1,t,r&&r.mt?r.mt:"DV"),e.latencyUtil.startTimer()}catch(a){}e.appendScriptTag(s,o)},e.getScriptSource=function(n,i,r){var o,s,a,l,c,u;if(e.src_id=n,r=r||{},o=r.u,s=r.d,a=r.to,l=r.mt,o||(o=e.getReferrerURL()),o&&-1!==o.indexOf("amzn_debug_mode")&&(e.debug_mode=!0),r.mt&&"V"!=r.mt&&"DV"!=r.mt||e.vads&&(e.vads={},delete e.amzn_vid),e.ads&&(e.clearTargetingFromGPTAsync(),e.ads={}),e.saved_ads&&(e.ads=e.saved_ads),s)try{t.domain=s}catch(d){}return c="src="+n+"&u="+o+"&cb="+Math.round(1e7*Math.random()),i&&(c+="&sz="+i),a&&(c+="&t="+a),l&&(c+="&mt="+l),u=e.protocol+e.host+e.dtb_svc+"?"+c},e.getReferrerURL=function(){var i=encodeURIComponent(t.documentURI);try{i=encodeURIComponent(n.top.location.href),i&&"undefined"!=i||(i=e.detectIframeAndGetURL())}catch(r){i=e.detectIframeAndGetURL()}return i},e.detectIframeAndGetURL=function(){try{if(n.top!==n.self)return encodeURIComponent(t.referrer)}catch(e){return encodeURIComponent(t.documentURI)}},e.appendScriptTag=function(e,n){var i=t.getElementsByTagName("script")[0],r=t.createElement("script");r.type="text/javascript",r.async=!0,r.src=e;try{n&&"function"==typeof n&&(r.readyState?r.onreadystatechange=function(){("loaded"==r.readyState||"complete"==r.readyState)&&(r.onreadystatechange=null,n(!0))}:r.onload=function(){n(!0)})}catch(o){}i.parentNode.insertBefore(r,i)},e.renderAd=function(t,n){var i,r,o,s,a,l;if(e.ads[n])i=e.ads[n],e.ev&&(r="amznad"+Math.round(1e6*Math.random()),i=i.replace("window.top.amznads.detectViewability","window.amzncsm.rmD"),i=i.replace(/id=[^ ]*/,'id="'+r+'"'),o="<script type='text/javascript' src='"+e.CSM_JS+"'></script>\n",e.host!=e.DEFAULT_HOST&&(o+="<script type='text/javascript'>try{amzncsm.host=window.top.amznads.host;}catch(e){amzncsm.host=amznads.host;}</script>\n"),i=o+i),aax_write(t,i);else{s=new Object,s.c="dtb",s.src=e.src_id,s.kvmismatch=1,s.pubReturnedKey=n,s.aaxReturnedKeys=e.getTokens(),s.cb=Math.round(1e7*Math.random());try{s.u=encodeURIComponent(location.host+location.pathname),navigator&&(s.ua=encodeURIComponent(navigator.userAgent))}catch(c){}a=encodeURIComponent(JSON.stringify(s)),l=e.protocol+e.host+"/x/px/p/0/"+a,aax_write(t,"<img src='"+l+"'/>")}},e.hasAds=function(t){var n;if(!t)try{return Object.keys(e.ads).length>0}catch(i){for(n in e.ads)if(e.ads.hasOwnProperty(n))return!0}for(n in e.ads)if(e.ads.hasOwnProperty(n)&&n.indexOf(t)>0)return!0;return!1},e.getTargeting=function(t){var n={};return e.getTokens()&&e.getTokens().length>0&&(n[e.targetingKey]=e.getTokens(),e.amzn_vid&&(n[e.vidKey]=e.amzn_vid)),n},e.setTargeting=function(t,n){var i;for(i in e.ads)if(e.ads.hasOwnProperty(i)){if(n&&i.indexOf(n)<0)continue;t(i,"1")}},e.setTargetingForGPTAsync=function(t){var n,i;try{if(t)e.targetingKey=t,n=e.getTokens(),"undefined"!=typeof n&&n.length>0&&googletag.cmd.push(function(){googletag.pubads().setTargeting(t,n),e.amzn_vid&&googletag.pubads().setTargeting(e.vidKey,e.amzn_vid)});else for(i in e.ads)e.ads.hasOwnProperty(i)&&!function(){var t=i;googletag.cmd.push(function(){amznads.debug_mode,googletag.pubads().setTargeting(t,"1"),e.amzn_vid&&googletag.pubads().setTargeting(e.vidKey,e.amzn_vid)})}()}catch(r){}},e.setTargetingForGPTSync=function(t){var n,i;try{if(t)e.targetingKey=t,n=e.getTokens(),"undefined"!=typeof n&&n.length>0&&(googletag.pubads().setTargeting(t,n),e.amzn_vid&&googletag.pubads().setTargeting(e.vidKey,e.amzn_vid));else for(i in e.ads)e.ads.hasOwnProperty(i)&&(googletag.pubads().setTargeting(i,"1"),e.amzn_vid&&googletag.pubads().setTargeting(e.vidKey,e.amzn_vid))}catch(r){}},e.clearTargetingFromGPTAsync=function(){try{googletag&&googletag.pubads()&&googletag.pubads().clearTargeting(e.targetingKey),googletag.pubads().clearTargeting(e.vidKey)}catch(t){}},e.appendTargetingToAdServerUrl=function(t){var n;try{-1===t.indexOf("?")&&(t+="?");for(n in e.ads)e.ads.hasOwnProperty(n)&&(t+="&"+n+"=1")}catch(i){}return t},e.appendTargetingToQueryString=function(t){var n;try{for(n in e.ads)e.ads.hasOwnProperty(n)&&(t+="&"+n+"=1")}catch(i){}return t},e.getTokens=function(t){var n,i=[];try{for(n in e.ads)if(e.ads.hasOwnProperty(n)){if(t&&n.indexOf(t)<0)continue;i.push(n)}}catch(r){}return i},e.getKeys=e.getTokens,e.getVid=function(){return e.amzn_vid},e.doAllTasks=function(){for(;e.tasks.length>0;){var t=e.tasks.shift();e.doTask(t)}},e.doTask=function(e){try{e.call()}catch(t){}},e.tryGetAdsAsync=function(){e.asyncParams&&e.getAdsCallback(e.asyncParams.id,e.asyncParams.callbackFn,e.asyncParams.timeout,e.asyncParams.size,e.asyncParams.data)},e}(amznads||{},document,window),amznads.tryGetAdsAsync(),window.amzn_ads=amzn_ads,window.amznads=amznads,CNN=window.CNN||{},CNN.AdsConfig=CNN.AdsConfig||{},CNN.AdsConfig.amazon=CNN.AdsConfig.amazon||{},CNN.Features=CNN.Features||{},window.AmazonDirectMatchBuy=function(){function e(e,t){return null!=e&&m.call(e,t)}function t(e){return"[object Function]"===v.call(e)}function n(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function i(e){return function(){e&&(e.apply(this,arguments),e=null)}}function r(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t="[\\?&]"+e+"=([^&#]*)",n=new RegExp(t);if(document.location.search){var i=n.exec(document.location.search);return i?i[1]:""}return""}function o(){return!!window.amznads}function s(e){if(y("removing PageLevelTarget: amznslots"),window.AdFuel.removePageLevelTarget("amznslots"),!o())return e?e():!0;var t=i(function(){var t=window.amznads.getTargeting();return y("setting amazon targeting",t),window.AdFuel.setBulkTargeting(t),e?e():!0});try{window.amznads.getAdsCallback(C,t,w)}catch(n){y("Exception thrown while requesting Amazon ads:",n),t()}}function a(){var e={};return o()&&(e=window.amznads.getTargeting(),n(e)||(e={})),e}function l(e){var t=e.getId();if(E.has(t)){var n=E.getKeys(t);if(n.length){y("clearing previous ad key-values: "+n.join(", "));for(var i=0,r=n.length;r>i;++i)e.setAdKeyValue(n[i],null);E.clearKeys(t)}}}function c(e,t,n){y("setting ad key-value: "+t+' = "'+n+'"'),E.addKey(e.getId(),t),e.setAdKeyValue(t,n)}function u(t){var n=a();l(t);for(var i in n)if(e(n,i)){var r=n[i];if(r instanceof Array)for(var o=0,s=r.length;s>o;++o)c(t,r[o],"1");else c(t,i,r)}}function d(e){e.getPlayerType()===CVP.FLASH&&(y("setAdKeyValuePairs(player)"),u(e))}function h(e){function t(){window.AdFuel.registerModule("amazon",{preDispatchCallback:function(e,t){try{y("preDispatch"),s(t)}catch(n){y("error setting targeting prior to dispatch",n),t(n)}},preRefreshCallback:function(e,t){try{y("preRefresh"),s(t)}catch(n){y("error refreshing targeting prior to refresh",n),t(n)}}})}y("initializing",e),e&&(C=e.amznkey||C,w=e.timeout||w),b||(b=!0,window.AdFuel?t():document.addEventListener?document.addEventListener("AdFuelCreated",t,!0):document.attachEvent&&document.attachEvent("onAdFuelCreated",t))}function p(e){return function(){return b?void e.apply(this,arguments):void y("ERROR: init() must be called first!")}}var f=Array.prototype,g=Object.prototype,m=g.hasOwnProperty,_=f.slice,v=g.toString,y=function(){};n(window.console)&&t(window.console.log)&&"true"==r("debug")&&(y=function(){var e=["[AdFuelModule - Amazon]"];e.push.apply(e,arguments),window.console.log.apply(window.console,e)});var C=window.location.hostname.toLowerCase().match(/^edition\.cnn\.com/)?"3288":"3159",w=1e3,b=!1,E=function(){function e(e){return e in r}function t(t,n){e(t)||(r[t]=[]),r[t].push(n)}function n(t){return e(t)?_.call(r[t]):[]}function i(t){return e(t)?(r[t].length=0,!0):!1}var r={};return{has:e,clearKeys:i,getKeys:n,addKey:t}}();return{requestAdRefresh:p(s),getTargetingData:p(a),setAdKeyValuePairs:p(d),isAmazonApiAvailable:o,init:h}}(),CNN.Features.enableAmazonDisplayAds===!0&&!function(e){if(window.AmazonDirectMatchBuy.isAmazonApiAvailable())e();else{var t=document,n=t.createElement("script"),i=t.getElementsByTagName("script")[0],r=/^(complete|loaded)$/,o=!1;n.type="text/javascript",n.async=!0,n.src="http://c.amazon-adsystem.com/aax2/amzn_ads.js",n.onload=n.onreadystatechange=function(){o||"readyState"in n&&r.test(n.readyState)||(n.onload=n.onreadystatechange=null,o=!0,e())},i.parentNode.insertBefore(n,i)}}(function(){CNN.AdsConfig.amazon.amznkey?window.AmazonDirectMatchBuy.init(CNN.AdsConfig.amazon):window.AmazonDirectMatchBuy.init()}),function(){function e(e){return"[object Function]"===a.call(e)}function t(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function n(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t="[\\?&]"+e+"=([^&#]*)",n=new RegExp(t);if(document.location.search){var i=n.exec(document.location.search);return i?i[1]:""}return""}function i(e){function t(e){var t,n,i,r=document.cookie.split(";");for(t=0;t<r.length;t++)if(n=r[t].substr(0,r[t].indexOf("=")),i=r[t].substr(r[t].indexOf("=")+1),n=n.replace(/^\s+|\s+$/g,""),n==e)return decodeURIComponent(i);return""}function n(){var n={},r=t(i);if(window.crtg_content=r,r)for(var s=r.split(";"),a=0;a<s.length-1;a++){var c=s[a].split("="),u=c[0],d=c[1];n[u]=d,o.key||window.AdFuel.addPageLevelTarget(u,d)}for(var h in o)o.hasOwnProperty(h)&&!n[h]&&window.AdFuel.removePageLevelTarget(h);l("set criteo targeting",n),o=n,e&&e()}var i="crtg_trnr",r="crtg_content",s="4157",a=Math.floor(99999999999*Math.random());!function(e){var t=location.protocol+"//rtax.criteo.com/delivery/rta/rta.js?netId="+encodeURIComponent(s);t+="&cookieName="+encodeURIComponent(i),t+="&rnd="+a,t+="&varName="+encodeURIComponent(r);var n=document,o=n.createElement("script"),l=n.getElementsByTagName("script")[0],c=/^(complete|loaded)$/,u=!1;o.type="text/javascript",o.async=!0,o.src=t,o.onload=o.onreadystatechange=function(){u||"readyState"in o&&c.test(o.readyState)||(o.onload=o.onreadystatechange=null,u=!0,e())},l.parentNode.insertBefore(o,l)}(n)}function r(){function e(){window.AdFuel.registerModule("criteo",{preDispatchCallback:function(e,t){try{l("preDispatch"),i(t)}catch(n){l("error setting targeting prior to dispatch",n),t(n)}},preRefreshCallback:function(e,t){try{l("preRefresh"),i(t)}catch(n){l("error setting targeting prior to refresh",n),t(n)}}})}window.AdFuel?e():document.addEventListener?document.addEventListener("AdFuelCreated",e,!0):document.attachEvent&&document.attachEvent("onAdFuelCreated",e)}var o={};window.crtg_content="";var s=Object.prototype,a=s.toString,l=function(){};t(window.console)&&e(window.console.log)&&"true"==n("debug")&&(l=function(){var e=["[AdFuelModule - Criteo]"];e.push.apply(e,arguments),window.console.log.apply(window.console,e)}),CNN.Features.enableCriteoAds===!0&&r()}(),function(){function e(e){return"[object Function]"===h.call(e)}function t(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function n(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t="[\\?&]"+e+"=([^&#]*)",n=new RegExp(t);if(document.location.search){var i=n.exec(document.location.search);return i?i[1]:""}return""}function i(e){if(document.cookie){for(var t=document.cookie.split(";"),n=e+"=",i=0;i<t.length;i++){for(var r=t[i];" "==r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(n))return r.substring(n.length,r.length)}return null}return null}function r(){var e=window.location.hostname.toLowerCase(),t=11078,n=i("countryCode")||(i("CG")?i("CG").substr(0,2):"");("US"!==n&&"CA"!==n&&2===n.length||e.search(/^(edition|arabic|cnnespanol)\./)>=0)&&(t=11016),p("Rubicon Account ID: "+t);var r=document.createElement("script");r.type="text/javascript",r.async=!0,r.src=("https:"===document.location.protocol?"https:":"http:")+"//ads.rubiconproject.com/header/"+t+".js";var o=document.getElementsByTagName("script")[0];o.parentNode.appendChild(r)}function o(e,t){window.rubicontag.cmd.push(function(){for(var n=[],i=[],r=0;r<e.length;r++){var o,s=e[r],a={_atf_:"atf",_btf_:"btf"},l=["_ns_","_nfs_"],c=["super-ad-zone"],u=["CNN/health","CNN/health/healthgrades","CNN/health/leaf","CNN/health/list","CNN/health/photos","CNN/health/specials","CNN/health/video","CNN/student-news"],d=[];for(var h in a)if(a.hasOwnProperty(h)&&s.rktr_slot_id&&s.rktr_slot_id.indexOf(h)>=0){var f=!0;for(var g in l)s.rktr_slot_id.indexOf(l[g])>=0&&(p("Filtering out invalid slot type: ",l[g],s),f=!1);for(var m in c)s.rktr_ad_id.indexOf(c[m])>=0&&(p("Filtering out invalid ad unit segment: ",c[m],s),f=!1);for(var _ in u)s.rktr_ad_id==c[m]&&(p("Filtering out invalid ad unit: ",u[_],s),f=!1);for(var v=0;v<d.length;v++)for(var y=d[v].join("x"),C=0;C<s.sizes.length;C++){var w=s.sizes[C].join("x");w==y&&(p("Filtering out invalid size: ",y,s),s.sizes.splice(C,1))}if(f){i.indexOf(s.rktr_ad_id)<0&&i.push(s.rktr_ad_id);var b=a[h];o=window.rubicontag.defineSlot("/8664377/"+s.rktr_ad_id,s.sizes,s.rktr_slot_id),o.setPosition(b);for(var E=s.targeting,A=0;A<E.length;A++){var T=E[A];"pos"==T[0]&&(Array.isArray(T[1])?(p("Setting Keyword",T[1][0]),o.setFPI("pos",T[1][0])):(p("Setting Keyword",T[1]),o.setFPI("pos",T[1])))}p("Setting Keyword",s.rktr_ad_id),o.addKW(s.rktr_ad_id),n.push(o),window.rubiconSlotDictionary[s.rktr_slot_id]=o}}}for(var S=0;S<i.length;S++)for(var k=i[S].split("/"),P=["site","section","subsection"],x=0;x<k.length&&3>x;x++)p("Setting FPI",P[x],k[x]),window.rubicontag.setFPI(P[x],k[x]);window.rubicontag.run(function(){t()},{slots:n})})}function s(e){p("setting fastlane targeting"),window.googletag.cmd.push(function(){var t=window.AdFuel.pageSlots;p({slots:e,gptSlots:t});for(var n=0;n<e.length;n++){var i=e[n];if(p("Slot ID: ",i.rktr_slot_id),t[i.rktr_slot_id]){var r=t[i.rktr_slot_id];p("calling window.rubicontag.setTargetingForGPTSlot..."),window.rubicontag.setTargetingForGPTSlot(r);for(var o=r.getTargetingKeys(),s=0;s<o.length;s++)o[s].indexOf("rpfl_")>=0&&p("Setting Fastlane Targeting...",{slot:r.getSlotElementId(),target:{key:o[s],value:r.getTargeting(o[s])}})}}})}function a(e,t){p("preDispatch"),s(e),t()}function l(e,t){p("preRefresh");var n=[],i=[],r=window.AdFuel.pageSlots;e||(e=Object.getOwnPropertyNames(r));for(var o=0;o<e.length;o++){var a=e[o];if(p("Slot ID: ",a),r[a]){var l=r[a],c=l.getTargetingKeys();for(var u in c)if(c.hasOwnProperty(u)){var d=c[u];d.indexOf("rpfl")>=0&&window.AdFuel.removeSlotLevelTarget(a,d)}window.rubiconSlotDictionary[a]&&n.push(window.rubiconSlotDictionary[a]),i.push({rktr_slot_id:a})}}p("refreshing slots",{slotsToRefresh:n}),window.rubicontag.run(function(){s(i),t()},{slots:n})}function c(){window.AdFuel.setOptions({queueCallbackTimeoutInMilliseconds:1e3,dispatchCallbackTimeoutInMilliseconds:1e3,refreshCallbackTimeoutInMilliseconds:1e3}),window.AdFuel.registerModule("Fastlane",{preQueueCallback:o,preDispatchCallback:a,preRefreshCallback:l})}function u(){r(),window.AdFuel?c():document.addEventListener?document.addEventListener("AdFuelCreated",c,!0):document.attachEvent&&document.attachEvent("onAdFuelCreated",c)}window.rubicontag=window.rubicontag||{},window.rubicontag.cmd=window.rubicontag.cmd||[];var d=Object.prototype,h=d.toString,p=function(){};t(window.console)&&e(window.console.log)&&"true"==n("debug")&&(p=function(){var e=["[AdFuelModule - Fastlane/Rubicon]"];e.push.apply(e,arguments),window.console.log.apply(window.console,e)}),window.rubiconSlotDictionary={},CNN.Features.enableRubiconFastlane===!0&&u()}(),window.cnnad_haveCookie=function(e){return document.cookie&&(document.cookie.indexOf("; "+e+"=")>=0||0==document.cookie.indexOf(e+"="))},window.cnnad_readCookie=function(e){if(document.cookie){for(var t=document.cookie.split(";"),n=e+"=",i=0;i<t.length;i++){for(var r=t[i];" "==r.charAt(0);)r=r.substring(1,r.length);if(0==r.indexOf(n))return r.substring(n.length,r.length)}return null}},window.turner_getGuid=function(){return window.cnnad_readCookie("ug")},function(e){function t(e){return"[object Function]"===s.call(e)}function n(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function i(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t="[\\?&]"+e+"=([^&#]*)",n=new RegExp(t);if(document.location.search){var i=n.exec(document.location.search);return i?i[1]:""}return""}function r(){function e(){var e=window.turner_getGuid();a("setting guid targeting",{guid:e}),window.AdFuel.addPageLevelTarget("guid",e)}window.AdFuel?e():document.addEventListener?document.addEventListener("AdFuelCreated",e,!0):document.attachEvent&&document.attachEvent("onAdFuelCreated",e)}var o=Object.prototype,s=o.toString,a=function(){};if(n(window.console)&&t(window.console.log)&&"true"==i("debug")&&(a=function(){var e=["[AdFuelModule - Guid]"];e.push.apply(e,arguments),window.console.log.apply(window.console,e)}),window.cnnad_haveCookie("ugs"))r();else if(!e||"https:"!==location.protocol){var l="http://www.ugdturner.com/xd.sjs",c=document,u=c.createElement("script"),d=c.getElementsByTagName("script")[0],h=/^(complete|loaded)$/,p=!1;u.type="text/javascript",u.async=!0,u.src=l,u.onload=u.onreadystatechange=function(){p||"readyState"in u&&h.test(u.readyState)||(u.onload=u.onreadystatechange=null,p=!0,r())},d.parentNode.insertBefore(u,d)}}(!1),window.Krux||((window.Krux=function(){window.Krux.q.push(arguments)}).q=[]),window.kvs=[],CNN.Features.enableKrux===!0&&!function(){function e(e){var t,n="kx"+e;return window.localStorage?window.localStorage[n]||"":navigator.cookieEnabled?(t=document.cookie.match(n+"=([^;]*)"),t&&decodeURIComponent(t[1])||""):""}window.Krux.user=e("user"),window.Krux.segments=e("segs")&&e("segs").split(",")||[];for(var t=0;t<window.Krux.segments.length;t++)window.kvs.length<20&&window.kvs.push(window.Krux.segments[t])}(),window.krux_getDESegments=function(){var e="&kxid=";return window.Krux.user&&(e+=window.Krux.user),e+="&kxseg="+window.kvs.join(",")},window.krux_getFWSegments=function(){return"kxseg="+window.kvs.join(",kxseg=")},window.krux_getUser=function(){return window.Krux.user},window.krux_getFWKeyValues=function(e,t){for(var n=e||"_fwu:386123:",i=t||35,r={},o=0;o<window.Krux.segments.length;o++)i>o&&(r[n+window.Krux.segments[o]]=1);return r},window.Krux.setControlTag=function(e){function t(e){return"[object Function]"===s.call(e)}function n(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function i(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t="[\\?&]"+e+"=([^&#]*)",n=new RegExp(t);if(document.location.search){var i=n.exec(document.location.search);return i?i[1]:""}return""}function r(){function e(){var e=window.Krux.user,t=window.Krux.segments;a("setting krux targeting",{kuid:e,ksg:t}),window.AdFuel.addPageLevelTarget("kuid",e),window.AdFuel.addPageLevelTarget("ksg",t)}window.AdFuel?e():document.addEventListener?document.addEventListener("AdFuelCreated",e,!0):document.attachEvent&&document.attachEvent("onAdFuelCreated",e)}var o=Object.prototype,s=o.toString,a=function(){};n(window.console)&&t(window.console.log)&&"true"==i("debug")&&(a=function(){var e=["[AdFuelModule - Krux]"];e.push.apply(e,arguments),window.console.log.apply(window.console,e)});var l=document,c=l.createElement("script"),u=l.getElementsByTagName("script")[0],d=/^(complete|loaded)$/,h=!1;c.type="text/javascript",c.async=!0;var p,f=(p=location.href.match(/\bkxsrc=([^&]+)/))&&decodeURIComponent(p[1]);c.src=/^https?:\/\/([^\/]+\.)?krxd\.net(:\d{1,5})?\//i.test(f)?f:"disable"===f?"":("https:"===location.protocol?"https:":"http:")+"//cdn.krxd.net/controltag?confid="+e,c.onload=c.onreadystatechange=function(){h||"readyState"in c&&d.test(c.readyState)||(c.onload=c.onreadystatechange=null,h=!0,r())},u.parentNode.insertBefore(c,u)},CNN.Features.enableKrux===!0){var controlTag=window.location.hostname.toLowerCase().match(/^edition\.cnn\.com/)?"ITb_9Zup":"ITb_4eqO";window.Krux.setControlTag(controlTag)}!function(){function e(e){return"[object Function]"===g.call(e)}function t(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function n(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t="[\\?&]"+e+"=([^&#]*)",n=new RegExp(t);if(document.location.search){var i=n.exec(document.location.search);return i?i[1]:""}return""}function i(){if(!m){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"===document.location.protocol?"https:":"http:")+h;var t=document.getElementsByTagName("script")[0];t.parentNode.appendChild(e),_("Added Proximic script to head of page.",h),m=!0}}function r(e,t){""!==e&&"undefined"!=typeof e&&(_("Setting data for DFP",e),window.AdFuel.addPageLevelTarget("pconid",e),t())}function o(e,t){for(var n=1;n<e.length;n++){var s=e[n];if(!s.rktr_ad_id.toLowerCase().match(/^cnn\/video/)&&!s.rktr_ad_id.toLowerCase().match(/^cnn\/homepage/)&&!s.rktr_ad_id.toLowerCase().match(/^cnn\/.*\/landing/)){i(),_("Waiting for data..."),setTimeout(function(){l++,_("SegmentData: ",p),""!==p&&"undefined"!=typeof p?(_("Proximic Data found!"),r(p,t)):u>l*c?o(e,t):(_("Proximic Timeout Occurred!"),t())},c);break}}}function s(){window.AdFuel.registerModule("Proximic",{postQueueCallback:o})}function a(){window.AdFuel?s():document.addEventListener?document.addEventListener("AdFuelCreated",s,!0):document.attachEvent&&document.attachEvent("onAdFuelCreated",s)}var l=0,c=50,u=2e3,d=document.location.href;window.location.hostname.toLowerCase().match(/^train\.next\.cnn\.com/)&&d.replace("train.next.","www");var h="//segment-data-us-east.zqtk.net/turner-47fcf6?url="+encodeURIComponent(d),p="",f=Object.prototype,g=f.toString,m=!1,_=function(){};t(window.console)&&e(window.console.log)&&"true"==n("debug")&&(_=function(){var e=["[AdFuelModule - Proximic/comScore]"];e.push.apply(e,arguments),window.console.log.apply(window.console,e)}),window.gotSegmentData=function(e){e.data&&(_("Segment Data: ",e.data),p=e.data)},CNN.Features.enableProximic===!0&&a()}(),window.cnnad_transactionID=null,window.cnnad_getTransactionID=function(){return window.cnnad_transactionID||(window.cnnad_transactionID=Math.round((new Date).getTime()/1e3)+""+Math.floor(9007199254740992*Math.random())),window.cnnad_transactionID},window.turner_getTransactionId=window.cnnad_getTransactionID,window.turner_getTransactionId(),function(){function e(e){return"[object Function]"===o.call(e)}function t(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function n(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t="[\\?&]"+e+"=([^&#]*)",n=new RegExp(t);if(document.location.search){var i=n.exec(document.location.search);return i?i[1]:""}return""}function i(){var e=window.turner_getTransactionId();s("setting guid targeting",{transId:e}),window.AdFuel.addPageLevelTarget("transId",e)}var r=Object.prototype,o=r.toString,s=function(){};t(window.console)&&e(window.console.log)&&"true"==n("debug")&&(s=function(){var e=["[AdFuelModule - TransactionId]"];e.push.apply(e,arguments),window.console.log.apply(window.console,e)}),window.AdFuel?i():document.addEventListener?document.addEventListener("AdFuelCreated",i,!0):document.attachEvent&&document.attachEvent("onAdFuelCreated",i)}(),function(){if(!window.AspenCNNTOS){var VERSION="1.7.0",debug=-1!==[window.location.search,window.location.hash].join().search(/\bdmtdebug\b/),Class=function(){var e=!1,t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,n=function(){};return n.extend=function(n){function i(){!e&&this.init&&this.init.apply(this,arguments)}var r=this.prototype;e=!0;var o=new this;e=!1;for(var s in n)o[s]="function"==typeof n[s]&&"function"==typeof r[s]&&t.test(n[s])?function(e,t){return function(){var n=this._super;this._super=r[e];var i=t.apply(this,arguments);return this._super=n,i}}(s,n[s]):n[s];return i.prototype=o,i.constructor=i,i.extend=arguments.callee,i},n}();!function(e,t,n){function i(){var e=h;return e.loader={load:r,i:0},e}function r(e,t,n){var i="c"==t?S:T;return v=0,t=t||"j",x(e)?o(i,e,t,this.i++,p,n):(_.splice(this.i++,0,e),1==_.length&&s()),this}function o(e,n,i,r,o,a){function l(){!p&&u(d.readyState)&&(m.r=p=1,!v&&c(),d.onload=d.onreadystatechange=null,f(function(){w.removeChild(d)},0))}var d=t.createElement(e),p=0,m={t:i,s:n,e:a};d.src=d.data=n,!C&&(d.style.display="none"),d.width=d.height="0","object"!=e&&(d.type=i),d.onload=d.onreadystatechange=l,"img"==e?d.onerror=l:"script"==e&&(d.onerror=function(){m.e=m.r=1,s()}),_.splice(r,0,m),w.insertBefore(d,C?null:g),f(function(){p||(w.removeChild(d),m.r=m.e=p=1,c())},h.errorTimeout)}function s(){var e=_.shift();v=1,e?e.t?f(function(){"c"==e.t?a(e):l(e)},0):(e(),c()):v=0}function a(e){var n,i=t.createElement("link");if(i.href=e.s,i.rel="stylesheet",i.type="text/css",e.e||!E&&!y)i.onload=function(){n||(n=1,f(function(){c()},0))},e.e&&i.onload();else{var r=function(e){f(function(){if(!n)try{e.sheet.cssRules.length?(n=1,c()):r(e)}catch(t){1e3==t.code||"security"==t.message||"denied"==t.message?(n=1,f(function(){c()},0)):r(e)}},0)};r(i)}f(function(){n||(n=1,c())},h.errorTimeout),!e.e&&g.parentNode.insertBefore(i,g)}function l(e){var n,i=t.createElement("script");i.src=e.s,i.onreadystatechange=i.onload=function(){!n&&u(i.readyState)&&(n=1,c(),i.onload=i.onreadystatechange=null)},f(function(){n||(n=1,c())},h.errorTimeout),e.e?i.onload():g.parentNode.insertBefore(i,g)}function c(){for(var e=1,t=-1;_.length-++t&&(!_[t].s||(e=_[t].r)););e&&s()}function u(e){return!e||"loaded"==e||"complete"==e}var d,h,p=t.documentElement,f=e.setTimeout,g=t.getElementsByTagName("script")[0],m={}.toString,_=[],v=0,y="MozAppearance"in p.style,C=y&&!!t.createRange().compareNode,w=C?p:g.parentNode,b=e.opera&&"[object Opera]"==m.call(e.opera),E="webkitAppearance"in p.style,A=E&&"async"in t.createElement("script"),T=y?"object":b||A?"img":"script",S=E?"img":T,k=Array.isArray||function(e){return"[object Array]"==m.call(e)},P=function(e){return Object(e)===e},x=function(e){return"string"==typeof e},I=function(e){return"[object Function]"==m.call(e)},R=[],L={};h=function(e){function t(e,t){function n(e){if(x(e))r(e,l,t,0,o);else if(P(e))for(i in e)e.hasOwnProperty(i)&&r(e[i],l,t,i,o)}var i,o=!!e.test,s=o?e.yep:e.nope,a=e.load||e.both,l=e.callback;n(s),n(a),e.complete&&t.load(e.complete)}function r(e,t,r,s,a){var l=o(e),c=l.autoCallback;if(!l.bypass){if(t&&(t=I(t)?t:t[e]||t[s]||t[e.split("/").pop().split("?")[0]]),l.instead)return l.instead(e,t,r,s,a);r.load(l.url,l.forceCSS||!l.forceJS&&/css$/.test(l.url)?"c":n,l.noexec),(I(t)||I(c))&&r.load(function(){i(),t&&t(l.origUrl,a,s),c&&c(l.origUrl,a,s)})}}function o(e){var t,n,i=e.split("!"),r=R.length,o=i.pop(),s=i.length,a={url:o,origUrl:o,prefixes:i};for(n=0;s>n;n++)t=L[i[n]],t&&(a=t(a));for(n=0;r>n;n++)a=R[n](a);return a}var s,a,l=this.yepnope.loader;if(x(e))r(e,0,l,0);else if(k(e))for(s=0;s<e.length;s++)a=e[s],x(a)?r(a,0,l,0):k(a)?h(a):P(a)&&t(a,l);else P(e)&&t(e,l)},h.addPrefix=function(e,t){L[e]=t},h.addFilter=function(e){R.push(e)},h.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",d=function(){t.removeEventListener("DOMContentLoaded",d,0),t.readyState="complete"},0)),e.yepnope=i()}(this,this.document);var Ajax={requestMap:{},jsonpRegistry:{},_counter:0,request:function(e){e=Utils.extend({timeout:5e3,maxRetries:0},e||{}),e.tries=0,this._sendRequest(e)},_sendRequest:function(e){var t=this,n=this._createCallback(e),i=this._createScript(n);return i?(i.src=e.url,void(e.timeout&&setTimeout(function(){t._onError(n,e)},e.timeout))):(Utils.log("JSONP - unable to create script for request ",e.url),!1)},_onSuccess:function(id,obj,data){this.requestMap[id]&&(this._destroyRequest(id,obj),Utils.isString(data)&&(data=eval("("+data+")")),obj.success&&obj.success(data))},_onError:function(e,t){return this.requestMap[e]?(this._destroyRequest(e,t),t.tries++,t.maxRetries&&t.tries<t.maxRetries?(Utils.log("Request failed - resending"),void this._sendRequest(t)):void(t.error&&t.error(t.url))):void 0},_destroyRequest:function(e,t){if(t.jsonpCallback){var n=this._removeNameFromRegistry(t.jsonpCallback);if(!n)try{delete window[t.jsonpCallback]}catch(i){window[t.jsonpCallback]=void 0}}delete this.requestMap[e];var r=document.getElementById(this._getScriptName(e));r&&(r.parentNode.removeChild(r),r=null)},_createScript:function(e){var t=document.getElementsByTagName("head")[0];if(!t)return!1;var n=document.createElement("script");return n.type="text/javascript",e&&(n.id=this._getScriptName(e)),t.appendChild(n),n},_getScriptName:function(e){return"aspen_jsonp_"+e},_createCallback:function(e){var t=this;if(Utils.empty(e.jsonpCallback))return null;this._counter++;var n="request_"+this._counter;this.requestMap[n]=function(i){t._onSuccess(n,e,i)};this._addNameToRegistry(e.jsonpCallback);return window[e.jsonpCallback]=function(e){t.requestMap[n](e)},n},_addNameToRegistry:function(e){var t=this.jsonpRegistry;return t[e]?t[e]+=1:t[e]=1,t[e]},_removeNameFromRegistry:function(e){var t=this.jsonpRegistry;return t[e]&&(t[e]-=1,0===t[e]&&delete t[e]),t[e]}},BatchService=Class.extend({init:function(e){this._enabled=!1,this._queue=[],this._config=e,this._timer,this._firstPostTimer},start:function(e){if(this._config=e,this._enabled=!0,_analyticsConfig.batchMode==BATCH_MODE_TIMER){Utils.log("[aspen]","start timer");var t=this;this._timer=setTimeout(function(){t._postTimerEvent()},1e3*Number(_analyticsConfig.batchModeAmount));var n=Math.ceil(Math.random()*Number(_analyticsConfig.batchModeAmount));n==Number(_analyticsConfig.batchModeAmount)&&(n--,0>=n&&(n=.5)),Utils.log("[aspen]","random time: "+n),this._firstPostTimer=setTimeout(function(){t._firstPostTimerEvent()},1e3*n)}},add:function(e){return this._addToQueue(e),this._enabled?void(_analyticsConfig.enabled&&!this._config.batchThrottled?(_analyticsConfig.batchMode==BATCH_MODE_TOTAL?this._queue.length==_analyticsConfig.batchModeAmount&&this.post():_analyticsConfig.batchMode==BATCH_MODE_NONE?this.post():_analyticsConfig.batchMode!=BATCH_MODE_TIMER&&this.post(),this._queue.length>0&&("error"==e.eventType&&"undefined"!=typeof _analyticsConfig.highPriorityErrors?this.flushByError(e.eventData):"error"!=e.eventType&&"undefined"!=typeof _analyticsConfig.highPriorityEvents&&this.flushByEvent(e.eventType))):(_analyticsConfig.enabled&&Utils.log("[aspen]","Aspen is diabled via analyticsConfig. Message not added."),this._config.batchThrottled&&Utils.log("[aspen]","Batching is throttled. Message not added."))):void Utils.log("[aspen]","Batch service not enabled. Queuing message.")},_addToQueue:function(e){Utils.log("[aspen]","Adding message to batch queue."),this._queue.push(e)},post:function(){if(this._config.postThrottled)Utils.log("[aspen]","Batch posting is throttled. Batch not posted.");else{var e={sessionId:this._config.sessionId,events:this._queue};if(Utils.log("[aspen]","send batch string"),"gzip"==_analyticsConfig.batchContentEncoding){var t="?aspenJson="+JSON.stringify(e),n=encodeURIComponent(t).replace(/%20/g,"+"),i=n;e=i}TransportManager.createRequest(_analyticsConfig.batchApi,e,this._postSuccess,this._postFailure,this),this._queue=[]}},_postTimerEvent:function(){Utils.log("[aspen]","postTimer - queue.length: "+this._queue.length),this._queue.length>0?(Utils.log("[aspen]","posting "+this._queue.length+" messages"),this.post()):Utils.log("[aspen]","no messages to post");var e=this;this._timer=setTimeout(function(){e._postTimerEvent()},1e3*Number(_analyticsConfig.batchModeAmount))},_firstPostTimerEvent:function(){Utils.log("[aspen]","firstPostTimer - queue.length: "+this._queue.length),this._queue.length>0?(Utils.log("[aspen]","posting "+this._queue.length+" messages"),this.post()):Utils.log("[aspen]","no messages to post")},_postSuccess:function(e){Utils.log("[aspen]","post success: "+e)},_postFailure:function(e){Utils.log("[aspen]","post failed: "+e)},flushByError:function(e){if("undefined"!=typeof e.errorCode){var t=e.errorCode,n=t.substring(0,2),i=t.substring(2,4),r=t.substring(4,6),o=t.substring(6),s=[];
s=_analyticsConfig.highPriorityErrors.split(",");for(var a="",l="",c="",u="",d=[],h=[],p=[],f=[],g=0,m=s.length;m>g;++g)switch(g){case 0:a=String(s[g]),d=a.split("+");break;case 1:l=String(s[g]),h=l.split("+");break;case 2:c=String(s[g]),p=c.split("+");break;case 3:u=String(s[g]),f=u.split("+")}for(g=0,m=d.length;m>g;++g){var _=String(d[g]);if(n==_||"*"==_)for(var v=0,y=h.length;y>v;++v){var C=String(h[v]);if(i==C||"*"==C)for(var w=0,b=p.length;b>w;++w){var E=String(p[w]);if(r==E||"*"==E)for(var A=0,T=f.length;T>A;++A){var S=String(f[A]);o!=S&&"*"!=S||(Utils.log("[aspen","[flushByError] found match, flushing batch"),this.post())}}}}}},flushByEvent:function(e){for(var t=_analyticsConfig.highPriorityEvents.split(","),n=0,i=t.length;i>n;++n){var r=String(t[n]);r==e&&(Utils.log("[aspen]","[flushBatchByEvent] found match, flushing batch"),this.post())}},setSessionId:function(e){this._config.sessionId=e},setBatchThrottled:function(e){this._config.batchThrottled=e},setPostThrottled:function(e){this._config.postThrottled=e},disableTimer:function(){_analyticsConfig.batchMode==BATCH_MODE_TIMER&&clearTimeout(this._timer)}}),LoadState={WAITING:"loadStateWaiting",LOADING:"loadStateLoading",READY:"loadStateReady",FAILED:"loadStateFailed"},AspenCNNTOS=window.AspenCNNTOS={init:function(e,t){var n=this;if(Utils.undef(this.initialized))if(this.initialized=!0,this.ready=!1,this.batchService,this._isThrottled=!0,this.sessionId=-1,this._messageExcludes=[],this.timeDifference=0,this._shortId="",this._retryTimer,this._retries=0,this._retryTime=0,this._savedSession={},this._timestampStr="",this.sessionToken="",this._appName="",this._transportFormats=[],this._transportFormat="",this._transportFormatIndex=0,this._messageQueue=[],this._loadState=LoadState.WAITING,this._configUrl="",this._configLoaded=!1,this._appInitCallback=t,_params=this._options=e,this._appName=_params.appName=_params&&_params.appName,_params.appVersion=_params&&_params.appVersion,_params.site=_params&&_params.site,_params.context=_params&&_params.context,_params.configBaseUrl=_params&&_params.configBaseUrl,_params.platform=_params&&_params.platform,_params.platformVersion=_params&&_params.platformVersion,Utils.empty(_params.appName))Utils.log("[aspen]","Unable to start Aspen, no appName provided");else if(Utils.empty(_params.site))Utils.log("[aspen]","Unable to start Aspen, no site provided");else{var i={};i.batchThrottled=!0,i.postThrottled=!0,this.batchService=new BatchService(i),this._loadState=LoadState.LOADING;var r=new DependencyManager;r.add(new Dependency(Utils.bind(n._loadConfigFile,n))),r.add(new Dependency(Utils.bind(n._loadRequiredJS,n))),r.onComplete(Utils.bind(n._onDependenciesLoaded,n)),r.onFailure(Utils.bind(n._onDependenciesLoadFailure,n)),r.load()}},_loadConfigFile:function(e,t){var n=_params.configBaseUrl;Utils.isNull(n)&&(n=ANALYTICS_BASE_URL+_params.appName+"/"+_params.site+"/"),Utils.log("[aspen]","Using config base path: "+n),this._configUrl=n+ANALYTICS_FILE+"?_="+Utils.timeBucket(15),Ajax.request({jsonpCallback:"aspen_onAnalyticsConfigReceived",url:this._configUrl,success:Utils.bind(this._loadConfigSuccess,this,e),error:Utils.bind(this._loadConfigFailure,this,t)})},_loadConfigSuccess:function(e,t){Utils.log("[aspen]","Config loaded successfully"),_analyticsConfig=Utils.extend(Utils.extend({},t["default"]||{}),t[_params.context]||{}),Utils.undef(_analyticsConfig.batchMode)&&(_analyticsConfig.batchMode="total"),Utils.undef(_analyticsConfig.batchModeAmount)&&(_analyticsConfig.batchModeAmount="10"),Utils.undef(_analyticsConfig.helloRetryCount)&&(_analyticsConfig.helloRetryCount="5"),Utils.undef(_analyticsConfig.helloRetryTime)&&(_analyticsConfig.helloRetryTime="10000"),Utils.undef(_analyticsConfig.batchContentEncoding)&&(_analyticsConfig.batchContentEncoding="json"),Utils.undef(_analyticsConfig.aspenUserIdEnabled)&&(_analyticsConfig.aspenUserIdEnabled=!0),Utils.undef(_analyticsConfig.aspenUserIdHash)&&(_analyticsConfig.aspenUserIdHash="392aspenUID392"),Utils.undef(_analyticsConfig.transportFormats)?this._transportFormats.push(TransportFormat.JSONP):this._transportFormats=_analyticsConfig.transportFormats.split(","),this._transportFormat=this._transportFormats[this._transportFormatIndex],Utils.undef(_analyticsConfig.messageExcludes)?this._messageExcludes=[]:this._messageExcludes=_analyticsConfig.messageExcludes.split(",");var n={};n.transportFormats=this._transportFormats,n.servicesUrl=_analyticsConfig.servicesUrl,TransportManager.init(n),Utils.log("[aspen]","batchMode: ",_analyticsConfig.batchMode),Utils.log("[aspen]","batchModeAmount: ",_analyticsConfig.batchModeAmount),Utils.log("[aspen]","helloRetryCount: ",_analyticsConfig.helloRetryCount),Utils.log("[aspen]","helloRetryTime: ",_analyticsConfig.helloRetryTime),Utils.log("[aspen]","transportFormat: ",this._transportFormat),e&&e()},_loadConfigFailure:function(e,t){Utils.log("[aspen]","Config failed to load",t),e&&e()},_loadRequiredJS:function(e,t){var n=this;null!=window.JSON?this._loadRequiredJSSuccess(e):yepnope({load:"http://z.cdn.turner.com/xslo/cvp/easyxdm/js/json2.ugly.js",complete:function(){return window.JSON?void n._loadRequiredJSSuccess(e):void n._loadRequiredJSFailure(t)}})},_loadRequiredJSSuccess:function(e){Utils.log("[aspen]","External JS dependencies loaded successfully"),e&&e()},_loadRequiredJSFailure:function(e){Utils.log("[aspen]","External JS dependencies failed to load"),e&&e()},_onDependenciesLoaded:function(){this._loadState=LoadState.READY,Utils.log("[aspen]","_onDependenciesLoaded - all required dependencies successfully loaded."),Utils.undef(_analyticsConfig.enabled)||"true"!==_analyticsConfig.enabled?(Utils.log("[aspen]","analytics disabled via config"),this._initFailure()):(Utils.log("[aspen]","analytics enabled via config"),Utils.undef(_analyticsConfig.servicesUrl)||this._hello())},_onDependenciesLoadFailure:function(){this._loadState=LoadState.FAILED,Utils.log("[aspen]","_onDependenciesLoadFailure - one or more required dependencies failed to load.")},_hello:function(){Utils.log("[aspen]","hello");var e=Utils.getQueryVar("sessionToken");Utils.log("[aspen]","check querySessionToken: ",e),Utils.empty(e)||(this.sessionToken=e,this.send("authSessionReload",{}));var t={propertyName:_params.site,applicationName:_params.appName,applicationVersion:_params.appVersion,deviceType:"Javascript",deviceModel:"Javascript",deviceVersion:"Javascript",library:"Javascript",libraryVersion:VERSION,platformName:Utils.empty(_params.platform)?"Javascript":_params.platform,platformVersion:Utils.empty(_params.platformVersion)?VERSION:_params.platformVersion,aspenConfigUrl:this._configUrl,protocol:"1.0",pageUrl:document.URL};t=Utils.extend(t,this._options),_analyticsConfig.aspenUserIdEnabled&&(t.aspenUUIDToken=_analyticsConfig.aspenUserIdHash),Utils.empty(this.sessionToken)||(t.sessionToken=this.sessionToken),TransportManager.bootstrapTM(),TransportManager.createRequest(_analyticsConfig.helloApi,t,this._helloSuccess,this._helloFailure,this),this._retryTimer=setTimeout(Utils.bind(this._helloRetry,this),Number(_analyticsConfig.helloRetryTime)),this._isRetrying=!0},_helloSuccess:function(e){Utils.log("[aspen]","_helloSuccess"),clearTimeout(this._retryTimer),this._isThrottled="undefined"!=typeof e.throttled&&"no"!==e.throttled||this._isThrottled,this.sessionId="undefined"!=typeof e.sessionId?e.sessionId:this.sessionId,this._shortId="undefined"!=typeof e.shortId?e.shortId:this._shortId,this._timestampStr="undefined"!=typeof e.timestamp?e.timestamp:this.timeDifference,this.timeDifference=Number(this._timestampStr)-Utils.now(),"no"===e.throttled&&(this._isThrottled=!1),Utils.log("[aspen]","_helloSuccess"),Utils.log("[aspen]","config.throttled: "+e.throttled),Utils.log("[aspen]","throttled: "+this._isThrottled),Utils.log("[aspen]","sessionId: "+this.sessionId);var t={};t.batchThrottled=!1,t.postThrottled=!0,t.sessionId="",this.batchService.start(t),this.batchService.setSessionId(this.sessionId),this.batchService.setPostThrottled(this._isThrottled),this._initSuccess()},_helloFailure:function(e){Utils.log("[aspen]","_helloFailure url: "+e),TransportManager.fallback()&&this._hello()},_helloRetry:function(){Utils.log("[aspen]","helloRetry"),this._retries==_analyticsConfig.helloRetryCount?(Utils.log("[aspen]","retries exhasted"),clearTimeout(this._retryTimer),this._retries=0,1==TransportManager.fallback()?this._hello():(Utils.log("[aspen]","retries exhasted, fallbacks exhausted, aspen is disabled"),this._isThrottled=!0,this.batchService.setBatchThrottled(!0),this.batchService.setPostThrottled(!0),this.batchService.disableTimer())):(this._retries++,this._retryTime=this._retries*Number(_analyticsConfig.helloRetryTime),this._savedSession.retries=String(this._retries),this._savedSession.retryTime=String(this._retryTime),this._hello())},isMessageExcluded:function(e){return!!(_analyticsConfig&&_analyticsConfig.messageExcludes&&_analyticsConfig.messageExcludes.indexOf(e)>=0)},send:function(e,t,n){if(-1==this._messageExcludes.indexOf(e)){if("undefined"==typeof t&&(t={}),!this.ready)return Utils.log("[aspen]","send - Aspen's not ready, queuing message"),void this._messageQueue.push({message:t,type:e,appName:n});if(this._isThrottled)Utils.log("[aspen]","Add message to batch is throttled! Message not added.");else{if(this.isMessageExcluded(e))return void Utils.log("[aspen]","message excluded by config, not added to batch",e);t.timestamp=Utils.now()+this.timeDifference,t.applicationName="undefined"!=typeof n?n:this._appName,delete t.session_id,delete t.sessionId,delete t.hbase_timestamp,delete t.type,Utils.log("[aspen]","appName: "+t.applicationName);var i={};i.eventType=e,i.eventData=t,Utils.log("[aspen]","add to batch json message: "+JSON.stringify(i)),this.batchService.add(i)}}},setSessionToken:function(e){this.sessionToken=e},_initSuccess:function(){this.ready=!0;for(var e=0,t=this._messageQueue.length;t>e;e++)this.send(this._messageQueue[e].type,this._messageQueue[e].message);this.send("aspenConfigDetails",_analyticsConfig);var n={};n.screenWidth=screen.width,n.screenHeight=screen.height,n.browserName=navigator.appName,n.userAgent=navigator.userAgent,n.platform=navigator.platform,this.send("systemInfo",n),this._initSuccess=function(){},this._appInitCallback&&this._appInitCallback()},_initFailure:function(){},getVersion:function(){return VERSION},getSessionId:function(e){return this.sessionId},getShortId:function(e){return this._shortId},isThrottled:function(e){return this._isThrottled},getThrottled:function(e){return this._isThrottled?"yes":"no"}},DependencyManager=function(){this._dependencies=[],this._loadedCount=0,this._successHandlers=[],this._failureHandlers=[],this.add=function(e){this._dependencies.push({dependency:e,success:!1});var t=this._dependencies.length-1;e.onComplete(Utils.bind(this._onDependencyLoaded,this,t,!0)),e.onFailure(Utils.bind(this._onDependencyLoaded,this,t,!1))},this.load=function(){for(var e=0,t=this._dependencies.length;t>e;e++)this._dependencies[e].dependency.load()},this.onComplete=function(e){this._successHandlers.push(e)},this.onFailure=function(e){this._failureHandlers.push(e)},this._onDependencyLoaded=function(e,t){++this._loadedCount,this._dependencies[e].success=t,this._loadedCount===this._dependencies.length&&this._onAllDependenciesLoaded()},this._onAllDependenciesLoaded=function(){this._loadedCount=0;for(var e=!0,t=0,n=this._dependencies.length;n>t;t++)if(!this._dependencies[t].success){e=!1;break}var i=e?this._successHandlers:this._failureHandlers;for(t=0,n=i.length;n>t;t++)i[t]()}},Dependency=function(e){this._func=e,this._successHandlers=[],this._failureHandlers=[],this.load=function(){this._func(Utils.bind(this._onSuccess,this),Utils.bind(this._onFailure,this))},this.onComplete=function(e){this._successHandlers.push(e)},this.onFailure=function(e){this._failureHandlers.push(e)},this._onSuccess=function(){for(var e=0,t=this._successHandlers.length;t>e;e++)this._successHandlers[e]()},this._onFailure=function(){for(var e=0,t=this._failureHandlers.length;t>e;e++)this._failureHandlers[e]()}},AspenComm=function(){var e,t,n,i,r,o,s="http://aspen.turner.com",a=!1,l=[];return t=function(i){Utils.log("[aspen]","[easyXDM]","init",i),s=i,e=new window.CVPAux.easyXDM.Rpc({swf:"http://z.cdn.turner.com/xslo/cvp/easyxdm/swf/easyxdm.swf",remote:s+"/static/xdm_iframe.html"},{remote:{request:{}}}),Utils.log("[aspen]","[easyXDM]","init AspenComm"),a=!0,t=function(){try{throw"already init'ed - ignored"}catch(e){}},n()},i=function(e,t,n){a?o(e,t,n):r(e,t,n)},r=function(){l.push(arguments)},n=function(){for(var e=0,t=l.length;t>e;++e)o.apply(null,l[e])},o=function(t,n,i){Utils.log("[aspen]","[easyXDM]","make request",t);var r,o,s;r=Utils.extend(Utils.extend({method:"POST"},t||{})),o=function(e){var t=e.data;if("string"==typeof t&&t.charAt(0).match(/[{[]/))try{t=JSON.parse(t)}catch(i){Utils.log(i)}Utils.log("[aspen]","[easyXDM]","request success",e),n(t,e.status,e.headers)},s=function(e){var t=e.data;if("string"==typeof t&&t.charAt(0).match(/[{[]/))try{t=JSON.parse(t)}catch(n){Utils.log(n)}i(t,e.status,e.message)},e.request(r,o,s)},{init:t,request:i}}(),bootstrap=function(e){Utils.log("[aspen]","[easyXDM]","bootstrap",e),window.CVPAux=window.CVPAux||{},yepnope({test:null!=window.CVPAux.easyXDM,nope:"http://z.cdn.turner.com/xslo/cvp/easyxdm/js/easyXDM.ugly.js",complete:function(){if(window.easyXDM)window.CVPAux.easyXDM=easyXDM.noConflict("CVPAux"),yepnope({test:null!=window.JSON,nope:"http://z.cdn.turner.com/xslo/cvp/easyxdm/js/json2.ugly.js",complete:function(){if(!window.JSON)try{throw"failed to install JSON polyfill"}catch(t){}e()}});else try{throw"failed to install easyXDM"}catch(t){}}})},ANALYTICS_BASE_URL="http://z.cdn.turner.com/xslo/aspen/config/",ANALYTICS_FILE="aspenanalytics.json",BATCH_MODE_TOTAL="total",BATCH_MODE_TIMER="timer",BATCH_MODE_NONE="none",_params={},_analyticsConfig={},TransportFormat={JSON:"json",JSONP:"jsonp"},TransportManager={init:function(e){this._config=e,this._transportFormat=this._config.transportFormats[0],this._bootstrapped=!1},bootstrapTM:function(){if(Utils.log("[aspen]","TransportManager","bootstrap","_bootstrapped:",this._bootstrapped),this._transportFormat===TransportFormat.JSON&&!this._bootstrapped){var e=this._config.servicesUrl;bootstrap(function(){AspenComm.init(e)}),this._bootstrapped=!0,Utils.log("[aspen]","TransportManager","bootstrap","transportFormat",this._transportFormat)}},createRequest:function(e,t,n,i,r){if(Utils.log("[aspen]","TransportManager","createRequest"),this._transportFormat===TransportFormat.JSON)AspenComm.request({url:e+"."+this._transportFormat,data:{aspenJson:JSON.stringify(t)}},Utils.bind(n,r),Utils.bind(i,r));else if(this._transportFormat===TransportFormat.JSONP){var o=this._config.servicesUrl+e+"."+this._transportFormat;o+="?aspen_callback=parseAspenInitialization&aspenJson="+encodeURIComponent(JSON.stringify(t)).replace(/%20/g,"+"),Ajax.request({jsonpCallback:"parseAspenInitialization",url:o,error:Utils.bind(i,r),success:Utils.bind(n,r)})}},fallback:function(){return Utils.log("[aspen]","current transport format failed",this._transportFormat),this._config.transportFormats.shift(),this._config.transportFormats.length>0?(this._transportFormat=this._config.transportFormats[0],Utils.log("trying next transport format",this._transportFormat),!0):!1}},Utils={undef:function(e){return"undefined"==typeof e},isNull:function(e){return Utils.undef(e)||null===e},empty:function(e){return Utils.undef(e)||Utils.isNull(e)||""===e},isFunc:function(e){return"function"==typeof e},isObject:function(e){return"object"==typeof e},isString:function(e){return"string"==typeof e},extend:function(e,t){var n;e||(e={});for(n in t)e[n]=t[n];return e},log:function(){window.console&&window.console.log&&debug&&window.console.log(Utils.slice(arguments).join(" | ")),!Utils.undef(window.logJSAuth)&&Utils.isFunc(window.logJSAuth)&&debug&&window.logJSpAuth(Utils.slice(arguments).join(" | "))},now:"function"==typeof Date.now?Date.now:function(){return(new Date).getTime()},slice:function(e,t){return Array.prototype.slice.call(e,t||0)},bind:function(e,t){var n=Utils.slice(arguments,2);return function(){var i=n.concat(Utils.slice(arguments));return e.apply(t,i)}},setCookie:function(e,t,n){var i=new Date;i.setDate(i.getDate()+n);var r=escape(t)+(null==n?"":"; expires="+i.toUTCString());document.cookie=e+"="+r},getCookie:function(e){var t,n,i,r=document.cookie.split(";");for(t=0;t<r.length;t++)if(n=r[t].substr(0,r[t].indexOf("=")),i=r[t].substr(r[t].indexOf("=")+1),n=n.replace(/^\s+|\s+$/g,""),n==e)return unescape(i)},getQueryVar:function(e){for(var t=window.location.search.substring(1),n=t.split("&"),i=0;i<n.length;i++){var r=n[i].split("=");if(r[0]==e)return r[1]}},randomString:function(e){var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".split("");e||(e=Math.floor(Math.random()*t.length));for(var n="",i=0;e>i;i++)n+=t[Math.floor(Math.random()*t.length)];return n},timeBucket:function(e){var t=new Date,n=60*(24*t.getDate()+t.getHours())+t.getMinutes();return Math.round(n/e)}}}}.call(this),function e(t,n,i){function r(s,a){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[s]={exports:{}};t[s][0].call(u.exports,function(e){var n=t[s][1][e];return r(n?n:e)},u,u.exports,e,t,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){var i=e("./core"),r=e("./sessiontoken"),o=window.Aspen=i();o.createInstance=i,o.getSessionToken=function(){return r.read()},t.exports=o},{"./core":5,"./sessiontoken":8}],2:[function(e,t,n){var i=e("./log"),r=e("../cvp/request"),o=e("../cvp/utils"),s=e("../cvp/convert"),a=500,l=3,c=!1,u=[],d=function(e){return u.length>a&&u.splice(0,a-u.length),o.isArray(e)&&e.length?u.unshift.apply(u,e):u.push(e)},h=function(e,t,n){i.log("AspenComm::makeRequest",e);var o=function(e){i.log("AspenComm::makeRequest","request success",e);var n=s.jsonTextToJsObject(e);t(n)},a=function(t){i.debug("AspenComm::makeRequest","request failure",t),e._retries>l?n(e.url):(e._retries+=1,d(arguments))};e._retries="_retries"in e?e._retries+1:0;var c=new r(e);return c.then(o,a),c},p=function(){u.push(arguments)},f=function(){for(var e=u.splice(0,u.length),t=null;null!=(t=e.shift());)h.apply(null,t).otherwise(o.bind(d,null,t))},g=function(e,t,n){c?h(e,t,n):p(e,t,n)},m=function(){i.log("AspenComm::init"),c=!0,m=function(){throw new Error("already init'ed - ignored")},f()};n.init=m,n.request=g},{"../cvp/convert":16,"../cvp/request":37,"../cvp/utils":52,"./log":6}],3:[function(e,t,n){var i=e("../vendor/Class"),r=e("../cvp/utils"),o=e("../cvp/shared"),s=e("../vendor/json3"),a=e("./log"),l=e("./transportmanager"),c="total",u="timer",d="none",h=i.extend({init:function(e){this._enabled=!1,this._queue=[],this._postThrottled=!0,this._aspen=e||window.Aspen,this._timer=null,this._postTimerEvent=r.bind(this._postTimerEvent,this),this._firstPostTimerEvent=r.bind(this._firstPostTimerEvent,this),this.dispose=r.bind(this.dispose,this),o.addBeforeUnLoadEvent(this.dispose)},dispose:function(){this.disableTimer(),this.post()},start:function(){var e=this._aspen.getConfig("batchApi");if(e&&(this._enabled=!0,this._aspen.getConfig("batchMode")===u)){var t=r.toInt(this._aspen.getConfig("batchModeAmount")),n=Math.ceil(Math.random()*t);n===t&&(n-=1,0>=n&&(n=.5)),a.log("BatchService::start","random time: "+n),setTimeout(this._firstPostTimerEvent,1e3*n)}},add:function(e){if(!this._aspen.getConfig("enabled"))return void a.debug("BatchService::add","Aspen is disabled via aspenanalytics config. Message not added.");if(a.debug("BatchService::add","Adding message to batch queue."),this._queue.push(e),!this._enabled)return void a.debug("BatchService::add","Batch service not enabled. Queuing message.");var t=this._aspen.getConfig("batchMode"),n=this._aspen.getConfig("batchModeAmount");t===u&&null===this._timer?(a.debug("BatchService::add","Starting timer on message-add."),this._timer=setTimeout(this._postTimerEvent,1e3*n)):t===c?this._queue.length>=n&&this.post():t===d?this.post():t!==u&&this.post(),r.empty(this._queue)||("error"===e.eventType?this.flushByError(e.eventData):"error"===e.eventType||r.undef(this._aspen.getConfig("highPriorityEvents"))||this.flushByEvent(e.eventType))},post:function(){if(this._postThrottled)return void a.debug("BatchService::post","Batch posting is throttled. Batch not posted.");if(!this._enabled)return void a.debug("BatchService::post","Batch posting is not enabled.");var e={sessionId:this._sessionId,events:this._queue};if(a.debug("BatchService::post","send batch string"),"gzip"===this._aspen.getConfig("batchContentEncoding")){var t="?aspenJson="+s.stringify(e);e=encodeURIComponent(t).replace(/%20/g,"+")}l.createRequest(this._aspen.getConfig("batchApi"),e,this._postSuccess,this._postFailure,this),this._queue.length=0},_postTimerEvent:function(){r.empty(this._queue)?(a.log("BatchService::_postTimerEvent","no messages to post"),this._timer=null):(a.log("BatchService::_postTimerEvent","queue.length: "+this._queue.length),this.post(),this._timer=setTimeout(this._postTimerEvent,1e3*this._aspen.getConfig("batchModeAmount")))},_firstPostTimerEvent:function(){r.empty(this._queue)?a.log("BatchService::_firstPostTimerEvent","no messages to post"):(a.log("BatchService::_firstPostTimerEvent","queue.length: "+this._queue.length),this.post())},_postSuccess:function(e){a.log("BatchService::_postSuccess",e)},_postFailure:function(e){a.log("BatchService::_postFailure",e)},flushByError:function(e){var t=this._aspen.getConfig("highPriorityErrors");if(r.isString(e.errorCode)&&r.isString(t)){for(var n=e.errorCode,i=n.substring(0,2),o=n.substring(2,4),s=n.substring(4,6),l=n.substring(6),c=t.split(/[, ]+/),u="",d="",h="",p="",f=[],g=[],m=[],_=[],v=0,y=c.length;y>v;++v)switch(v){case 0:u=c[v],f=u.split("+");break;case 1:d=c[v],g=d.split("+");break;case 2:h=c[v],m=h.split("+");break;case 3:p=c[v],_=p.split("+")}for(v=0,y=f.length;y>v;++v){var C=f[v];if(i===C||"*"===C)for(var w=0,b=g.length;b>w;++w){var E=g[w];if(o===E||"*"===E)for(var A=0,T=m.length;T>A;++A){var S=m[A];if(s===S||"*"===S)for(var k=0,P=_.length;P>k;++k){var x=_[k];l!==x&&"*"!==x||(a.debug("BatchService::flushByError","found match, flushing batch"),this.post())}}}}}},flushByEvent:function(e){var t=this._aspen.getConfig("highPriorityEvents");if(r.isString(t))for(var n=t.split(/[, ]+/),i=0,o=n.length;o>i;++i){var s=n[i];s===e&&(a.debug("BatchService::flushByEvent","found match, flushing batch"),this.post())}},setSessionId:function(e){this._sessionId=e},setPostThrottled:function(e){this._postThrottled=e},disableTimer:function(){this._aspen.getConfig("batchMode")===u&&clearTimeout(this._timer)}});t.exports=h},{"../cvp/shared":38,"../cvp/utils":52,"../vendor/Class":96,"../vendor/json3":98,"./log":6,"./transportmanager":9}],4:[function(e,t,n){function i(e,t){return function(n){if(!n)return t("Unsuccessful attempt to obtain JSONP");var i=l.exec(n);if(!i)return t("Failed to determine JSONP callback name in response");var r=i[1];try{var o=new Function(r,n);try{o(function(t){e(t)})}catch(s){t(s)}}catch(a){t(a)}}}var r=e("../cvp/util/dependency"),o=e("./log"),s=e("../cvp/utils"),a=e("../cvp/request"),l=/\b(\S+)\(([^]+)\)/,c=r.extend({init:function(e){var t=e.basePath||".";o.log("Using config base path: "+t);var n=9e5,i=Math.round(s.now()/n).toString(36),r=t+"/aspenanalytics.json?_="+i;o.log("config url: ",r),this._super(r,!1)},load:function(){var e=s.bind(this._loadConfigSuccess,this),t=s.bind(this._loadConfigFailure,this);a.get({url:this._assetUrl}).then(i(e,t),t)},_loadConfigSuccess:function(e){o.log("Config loaded successfully"),this._success(e,this._assetUrl)},_loadConfigFailure:function(e){o.log("Config failed to load",e),this._failure(e)},getDesc:function(){return"Aspen ConfigDependency: "+this._assetUrl}});t.exports=c},{"../cvp/request":37,"../cvp/util/dependency":46,"../cvp/utils":52,"./log":6}],5:[function(e,t,n){var i=e("../core/app"),r=e("../cvp/utils"),o=e("../cvp/customevent"),s=e("../cvp/events"),a=e("../cvp/browser"),l=e("../vendor/json3"),c=e("./log"),u=e("./batchservice"),d=e("./configfile"),h=e("./transportmanager"),p=e("./sessionid"),f=e("./sessiontoken"),g=i.CDN_ORIGIN+"/xslo/cvp/config/",m=i.CDN_ORIGIN+"/xslo/aspen/config/",_={WAITING:"loadStateWaiting",LOADING:"loadStateLoading",READY:"loadStateReady",FAILED:"loadStateFailed"},v=["timestamp","aspenconfigurl","applicationname","session_id","sessionid","hbase_timestamp","type"],y=function(e){var t=!0,n={applicationName:"cvp",applicationVersion:i.VERSION,context:"default",deviceModel:"desktop",deviceType:"desktop",deviceVersion:"desktop",platformName:"javascript",platformVersion:a.version?String(a.version):void 0};return"object"==typeof e&&("aspenAppSignature"in e&&(n=r.extend({},n,e.aspenAppSignature)),"useSharedSessionToken"in e&&(t=!!e.useSharedSessionToken)),{initialized:!1,ready:!1,config:{throttled:!0,timeDifference:0,progressReportInterval:37,adProgressReportInterval:17},batchService:null,sessionObject:{},serviceUrlRoot:"",_retryTimer:null,_retries:0,_retriesMade:0,_retryTime:0,_savedSession:{},_messageQueue:[],_loadState:_.WAITING,eInitSuccess:new o("AspenInitSuccess"),eInitFailure:new o("AspenInitFailure"),init:function(e,t){var o=this;return this.initialized?void c.warn("Aspen is already set up!"):(this._helloRetry=r.bind(this._helloRetry,this),this.initialized=!0,this._options=r.extend({},e),this._options.site=this._options.site||i._cvpsetup&&i._cvpsetup.site||"cvp",r.empty(this._options.site)?void c.error("Unable to start Aspen, no site provided"):("appName"in this._options&&(n.applicationName=this._options.appName,"appVersion"in this._options&&(n.applicationVersion=this._options.appVersion)),this.batchService=new u(this),this._loadState=_.LOADING,r.isFunction(t)&&this.eInitSuccess.addListener(t),void s.onReady(function(){var e=o._options.configBaseUrl||("appName"in o._options?m+o._options.appName+"/"+o._options.site:g+o._options.site),t=o._dependency=new d({basePath:!o._options.dt&&e});t.eSuccess.addListener(o._onConfigLoaded,o),t.eFailure.addListener(o._onConfigLoadFailure,o),t.load()})))},_freeDependency:function(){this._dependency&&(this._dependency.eSuccess.removeListener(this._onConfigLoaded,this),this._dependency.eFailure.removeListener(this._onConfigLoadFailure,this),this._dependency=null)},dispose:function(){this._freeDependency(),clearTimeout(this._retryTimer),this.batchService.dispose(),this.batchService=null},_setupConfig:function(e,t){var n=r.extend({},e["default"],"context"in this._options?e[this._options.context]:null);n.enabled="true"===n.enabled&&!r.empty(n.servicesUrl),n.batchMode=n.batchMode||"total",n.batchModeAmount=n.batchModeAmount&&Number(n.batchModeAmount)||10,n.helloRetryCount=isNaN(n.helloRetryCount=Number(n.helloRetryCount))?5:n.helloRetryCount,n.helloRetryTime=n.helloRetryTime&&Number(n.helloRetryTime)||1e4,n.batchContentEncoding=n.batchContentEncoding||"json",n.messageExcludes=r.isString(n.messageExcludes)&&n.messageExcludes.split(/[, ]+/)||[],n.transportFormats=n.transportFormats&&n.transportFormats.split(/[, ]+/)||h.getDefaultFormats(),n.propertyName=n.propertyName||this._options.site,n.aspenUserIdEnabled=n.aspenUserIdEnabled||!0,n.aspenUserIdHash=n.aspenUserIdHash||"392aspenUID392",r.print(n,"Aspen config"),this.config=n,this.configSourceUrl=t,this.send("aspenConfigDetails",this.config)},getConfig:function(e){return e in this.config?this.config[e]:void 0},_onConfigLoaded:function(e,t){this._freeDependency(),this._setupConfig(e,t),this._loadState=_.READY,c.log("_onConfigLoaded - config successfully loaded"),this.config.enabled?(c.log("analytics enabled via config"),h.init({transportFormats:this.config.transportFormats,servicesUrl:this.config.servicesUrl}),this.serviceUrlRoot=this.config.servicesUrl,this._hello()):(c.log("analytics disabled via config"),this._initFailure())},_onConfigLoadFailure:function(e){this._freeDependency(),this._loadState=_.FAILED,c.log("_onConfigLoadFailure - failed to load "+e)},_hello:function(){c.log("hello");var e=p.get(),i=t?f.read():f.create(),o=r.extend({},n,{aspenConfigUrl:this.configSourceUrl,propertyName:this.config.propertyName,pageUrl:document.URL,context:this._options.context,sessionId:e,sessionToken:i,protocol:"1.0"});this._options.dt&&(o.debug="true"),this.config.aspenUserIdEnabled&&(o.aspenUUIDToken=this.config.aspenUserIdHash),h.bootstrapTM(),h.createRequest(this.config.helloApi,o,this._helloSuccess,this._helloFailure,this),this._retryTimer=setTimeout(this._helloRetry,this.config.helloRetryTime)},_helloSuccess:function(e){c.log("_helloSuccess"),clearTimeout(this._retryTimer),this.config.throttled=r.isString(e.throttled)?"no"!==e.throttled:this.config.throttled,this.config.sessionId=e.sessionId,this.config.timeDifference=e.timestamp?e.timestamp-r.now():this.config.timeDifference,this.config.progressReportInterval=e.progressReportInterval||this.config.progressReportInterval,this.config.adProgressReportInterval=e.adProgressReportInterval||this.config.adProgressReportInterval,c.debug("throttled: "+e.throttled+" => "+this.config.throttled),c.debug("sessionId: "+e.sessionId),c.debug("timeDifference: "+this.config.timeDifference),c.debug("progressReportInterval: "+this.config.progressReportInterval),c.debug("adProgressReportInterval: "+this.config.adProgressReportInterval),e.sessionId&&p.set(e.sessionId),this.batchService.setSessionId(p.get()),this.batchService.setPostThrottled(this.config.throttled),this.batchService.start();var t=r.getQueryParam("sessionToken");t&&this.send("authSessionReload",{}),this._initSuccess()},_helloFailure:function(e){c.log("_helloFailure url: "+e),h.fallback()&&this._hello()},_helloRetry:function(){c.log("helloRetry"),this._retries===this.config.helloRetryCount?(c.log("retries exhasted"),clearTimeout(this._retryTimer),this._retries=0,h.fallback()?this._hello():(c.debug("retries exhasted, fallbacks exhausted, aspen is disabled"),this.config.throttled=!0,this.batchService.setPostThrottled(!0),this.batchService.disableTimer())):(this._retries+=1,this._retryTime=this._retries*this.config.helloRetryTime,this._savedSession.retries=this._retries,this._savedSession.retryTime=this._retryTime,this._hello())},isMessageExcluded:function(e){return-1!==r.indexOf(this.config.messageExcludes,e)},send:function(e,t){if(this.disabled)return void c.debug("send - Aspen is disabled, message was not sent");var n=e,i=t;if(r.isString(t)&&(n=t,i=e,c.debug("Signature change: Aspen.send(type, message)",n,i)),r.isNull(i))i={};else if(!r.isSimpleObject(i))return void c.warn("send - message param must be a simple object");var o,s,a={};for(o in i)r.hasOwn(i,o)&&(s=o.toLowerCase(),-1!==v.indexOf(s)?delete i[o]:s in a?c.warn("JS is case-sensitive, but Aspen is not: the property '"+o+"' is duplicated!"):a[s]=1);return i.timestamp=(i.timestamp||r.now())+this.config.timeDifference,this.ready?this.config.throttled?void c.debug("Add message to batch is throttled! Message not added."):this.isMessageExcluded(n)?void c.debug("message excluded by config, not added to batch",n):void this._send(n,i):(c.debug("send - Aspen's not ready, queuing message"),void this._messageQueue.push({message:i,type:n}))},_send:function(e,t){switch(e){case"appConfig":t=r.extend({},n,t),t.aspenConfigUrl=this.configSourceUrl}"applicationName"in n&&!("applicationName"in t)&&(t.applicationName=n.applicationName);var i={};i.eventType=e,i.eventData=t,c.log("add to batch json message: "+l.stringify(i)),this.batchService.add(i)},_initSuccess:function(){c.log("Successful init"),this.ready=!0;for(var e=0,t=this._messageQueue.length;t>e;++e)this.send(this._messageQueue[e].type,this._messageQueue[e].message);this._messageQueue.length=0,this.send("systemInfo",{screenWidth:screen.width,screenHeight:screen.height,browserName:navigator.appName,userAgent:navigator.userAgent,platform:navigator.platform}),this.eInitSuccess.dispatch();
},_initFailure:function(){c.log("Failed init"),this.disabled=!0,this.eInitFailure.dispatch()}}};t.exports=y},{"../core/app":10,"../cvp/browser":14,"../cvp/customevent":18,"../cvp/events":28,"../cvp/utils":52,"../vendor/json3":98,"./batchservice":3,"./configfile":4,"./log":6,"./sessionid":7,"./sessiontoken":8,"./transportmanager":9}],6:[function(e,t,n){var i=e("../cvp/log"),r=i.getLogger("Aspen");t.exports=r},{"../cvp/log":29}],7:[function(e,t,n){var i,r=e("./log");t.exports={set:function(e){return i?void r.debug("sessionId is already '"+i+"'; will NOT set to '"+e+"'"):(r.debug("setting sessionId to '"+e+"'"),void(i=e))},get:function(){return r.debug("retreiving ID '"+i+"'"),i}}},{"./log":6}],8:[function(e,t,n){function i(){return o.randomString(25)}function r(){return a||(s.debug("sessionToken does not exist; creating anew"),a=this.create()),s.debug("retreiving sessionToken '"+a+"'"),a}var o=e("../cvp/utils"),s=e("./log"),a=o.getQueryParam("sessionToken");t.exports={create:i,read:r}},{"../cvp/utils":52,"./log":6}],9:[function(e,t,n){var i=e("./aspencomm"),r=e("../cvp/utils"),o=e("../cvp/request"),s=e("./log"),a={Format:{JSON:"json",JSONP:"jsonp"},getDefaultFormats:function(){return[a.Format.JSONP]},init:function(e){this._config=e,this._transportFormat=this._config.transportFormats.shift(),this._bootstrapped=!1},bootstrapTM:function(){if(s.log("TransportManager::bootstrapTM","_bootstrapped:",this._bootstrapped),this._transportFormat===a.Format.JSON&&!this._bootstrapped){var e=this._config.servicesUrl;i.init(e),this._bootstrapped=!0,s.log("TransportManager::bootstrapTM","transportFormat:",this._transportFormat)}},createRequest:function(e,t,n,l,c){s.log("TransportManager::createRequest");var u=this._config.servicesUrl+e+"."+this._transportFormat,d=r.bind(n,c),h=r.bind(l,c);switch(this._transportFormat){case a.Format.JSON:i.request({url:u,method:"POST",data:{aspenJson:t}},d,h);break;case a.Format.JSONP:o.getJSONP({jsonpCallback:"parseCVPServicesInitialization",url:u,data:{aspenJson:t},success:d,failure:h})}},fallback:function(){return s.debug("TransportManager::fallback","current transport format failed",this._transportFormat),this._transportFormat=this._config.transportFormats.shift(),this._transportFormat?(s.debug("TransportManager::fallback","trying next transport format",this._transportFormat),!0):!1}};t.exports=a},{"../cvp/request":37,"../cvp/utils":52,"./aspencomm":2,"./log":6}],10:[function(e,t,n){var i=/\bdmtdebug=(\w+)/,r=i.exec(window.location.href);if(!r&&window!==window.top)try{r=i.exec(window.top.location.href)}catch(o){}var s=!!r,a="https:"===window.location.protocol,l=a?"https://s.cdn.turner.com":"http://z.cdn.turner.com",c={VERSION:"2.8.8.0",BUILD_DATE:"2016-03-21T20:12:43-0400",FLASH_VERSION:"10.1.0.0",HTML5:"html5",FLASH:"flash",CDN_ORIGIN:l,DEBUG:s,DEBUG_LEVEL:s?r[1]:null,MAPPING_PATH:l+"/xslo/cvp/config/{site}/",MAPPING_FILE:"mapping.xml",OMNITURE_JS_URL:"",AD_MANAGER_URL:l+"/xslo/cvp/ads/freewheel/js/0/AdManager.js",AD_DFP_URL:"//www.google.com/uds/api/ima/1.7/9fd415db3bb953707e811e4827fe957b/default.IN.js",EXPRESS_INSTALL_URL:l+"/xslo/cvp/assets/flash/expressInstall.swf",FLASHXHR_SWF_URL:l+"/xslo/cvp/plugins/cvp/xhr/1.0/cvp_flashXhr.swf",LOG4JAVASCRIPT_URL:l+"/xslo/cvp/js/logging/log4javascript.js",EASYXDM_JS_URL:l+"/xslo/cvp/easyxdm/js/easyXDM.ugly.js",EASYXDM_SWF_URL:l+"/xslo/cvp/easyxdm/swf/easyxdm.swf",BLANK_MP4_URL:l+"/xslo/cvp/assets/video/blank.mp4",BLANK_IMG_URL:l+"/xslo/cvp/assets/video/blank.png",EXPIRED_MP4_URL:l+"/xslo/cvp/assets/video/video_not_available.mp4",EXPIRED_IMG_URL:l+"/xslo/cvp/assets/video/video_not_available.png",ERROR_CMS_PARSE:"CVP0201",ERROR_CMS_IO:"CVP0202",ERROR_CMS_LOADER:"CVP0206",ERROR_CONTENT_EXPIRED:"CVP2052"};t.exports=c},{}],11:[function(e,t,n){var i=e("./cvp/main");window.CVP=i},{"./cvp/main":30}],12:[function(e,t,n){var i=e("../vendor/when"),r=e("./utils"),o=e("../vendor/json3"),s=e("./log"),a=s.getLogger(),l={get:function(e){return e.method="GET",this._request(e)},getXml:function(e){return e.type="xml",this.get(e)},getJSON:function(e){var t=i.defer(),n=e.success;return e.type="json",e.success=function(e){try{var n=o.parse(e);t.resolve(n)}catch(i){t.reject(i)}},this.get(e),i(t.promise,n,e.error),t.promise},getJSONP:function(e){return this.JSONP._request(e)},post:function(e){return e.method="POST",this._request(e)},_request:function(e){var t=new XMLHttpRequest,n=i.defer();return t.onreadystatechange=function(){4===t.readyState&&(200<=t.status&&t.status<300||304===t.status?n.resolve(t.responseText):n.reject(t),t.onreadystatechange=Function.prototype,t.abort(),t=null)},i(n.promise,e.success,e.error),t.open(e.method,e.url,!0),t.send("POST"===e.method?e.data:null),n.promise}};l.JSONP={requestTimeout:5e3,maxRetries:0,_externalRoutes:{},requestMap:{},_counter:0,_request:function(e){return e=r.extend({timeout:this.requestTimeout,maxRetries:this.maxRetries},e),e.tries=0,e.deferred=i.defer(),a.debug("JSONP - creating request with timeout ",e.timeout," and maxRetries ",e.maxRetries),this._sendRequest(e),i(e.deferred.promise,e.success,e.error),e.deferred.promise},_sendRequest:function(e){var t=this,n=this._createCallback(e),i=this._createScript(n,e.url);if(!i){var r="JSONP - unable to create script for request "+e.url;throw a.error(r),e.deferred.reject(e.url),new Error(r)}e.timeout&&setTimeout(function(){t._onError(n,e)},e.timeout)},_onSuccess:function(e,t,n){if(this.requestMap[e]){if(this._destroyRequest(e,t),r.isString(n))try{n=o.parse(n)}catch(i){a.error("JSON failed to parse",i)}a.info("JSONP","success",t.url),t.deferred.resolve(n)}},_onError:function(e,t){if(this.requestMap[e]){if(this._destroyRequest(e,t),++t.tries,t.maxRetries&&t.tries<t.maxRetries)return a.warn("Request failed - resending"),void this._sendRequest(t);a.error("JSONP","error",t.url),t.deferred.reject(t.url)}},_destroyRequest:function(e,t){this._deregisterExternalCallback(t.jsonpCallback,e),delete this.requestMap[e],this._counter--;var n=document.getElementById(this._getScriptName(e));n&&(n.parentNode.removeChild(n),n=null)},_createScript:function(e,t){var n="script",i=document.getElementsByTagName(n)[0],r=document.createElement(n);return r.type="text/javascript",e&&(r.id=this._getScriptName(e)),r.src=t,r.async=!0,i.parentNode.insertBefore(r,i),r},_getScriptName:function(e){return"cvp_jsonp_"+e},_createCallback:function(e){var t=this;if(r.empty(e.jsonpCallback))return null;++this._counter;var n="request_"+this._counter+"_"+r.now();this.requestMap[n]=function(i){t._onSuccess(n,e,i)};var i=function(e){a.debug("JSONP","Internal CB received for request:",n),t.requestMap[n]?t.requestMap[n](e):a.debug("Request response came in after allotted time: ",n)};return this._registerExternalCallback(e.jsonpCallback,n,i),n},_registerExternalCallback:function(e,t,n){window[e]||this._createExternalCallback(e,this._routeExternalCallback(e)),this._externalRoutes[e]||(this._externalRoutes[e]=[]),this._externalRoutes[e].push({id:t,cb:n})},_routeExternalCallback:function(e){var t=this;return function(n){if(a.info("JSONP","routing:",e),!t._externalRoutes)return void a.error("JSONP","routes haven't been initialized");if(!t._externalRoutes[e])return void a.error("JSONP","routing hasn't been initialized for:",e);if(!t._externalRoutes[e].length)return void a.error("JSONP","no waiting requests for route:",e);var i=t._externalRoutes[e].shift();a.info("JSONP","request retrieved - id: ",i.id,"cb:",typeof i.cb),r.isFunc(i.cb)&&i.cb(n)}},_createExternalCallback:function(e,t){window[e]=t},_deregisterExternalCallback:function(e,t){for(var n=0,i=this._externalRoutes[e].length;i>n;n++){var r=this._externalRoutes[e][n];if(r.id===t)return a.info("JSONP","removing request from route:",e,"with id:",t),void this._externalRoutes[e].splice(n,1)}}},t.exports=l},{"../vendor/json3":98,"../vendor/when":100,"./log":29,"./utils":52}],13:[function(e,t,n){var i=e("./utils"),r=e("./static"),o=e("./shared"),s=e("../vendor/swfobject"),a=e("./events"),l=e("./cdn"),c=e("../vendor/json3"),u={getDOMPlayer:-1!==navigator.appName.indexOf("Microsoft")?function(){return window[this.getId()]}:function(){return document[this.getId()]},sendMessage:function(e,t){return this.getDOMPlayer().sendMessage(e,t),this},getPlayer:function(e){return this._playerType===r.FLASH?(this.getDOMPlayer().getPlayerJS(e),this):this.getDOMPlayer()},setDefaultPlayer:function(e){return this.getDOMPlayer().setDefaultPlayer(e),this},embedSWF:function(){return this.embed.apply(this,arguments)},embed:function(e){if(this._playerType===r.FLASH){var t=this.getId(),n=this.getFlashVars();n.domId=r.sanitizeId(t);var u=this.getEmbed(),d=l.replace(u.containerSwf,n),h=u.options,p=u.expressInstallSwf,f=o.validateFlashVersion(u.flashVersion),g={id:t,name:t};s.hasFlashPlayerVersion("1.0.0")||r.onCallback(t,["onNoFlashDetected"]);var m="overwrite",_=n[m];i.isEmpty(_)||(n[m]=c.stringify(_)),s.embedSWF(d,e,this.getWidth(),this.getHeight(),f,p,n,h,g)}else{var v=this.getPlayer();i.isFunc(v.embed)&&a.onReady(function(){v.embed(e)})}return this},removeSWF:function(){return this.remove.apply(this,arguments)},remove:function(){if(this.stop(),this._playerType===r.FLASH)s.removeSWF(this.getId());else{var e=this.getPlayer();i.isFunc(e.remove)&&e.remove()}return this},destroy:function(){var e=this.getId();if(r.findInstance(e)){if(this.remove(),this._playerType===r.FLASH);else{var t=this.getPlayer();i.isFunc(t.dispose)&&t.dispose()}r.unregisterInstance(e)}},play:function(e,t){return this.getDOMPlayer().playContent(e,t||{}),this},playFromObject:function(e,t){return this.getDOMPlayer().playFromObject(e,t||{}),this},reportAnalytics:function(e,t){return this.getDOMPlayer().reportAnalytics(e,t),this},replay:function(){return this.getDOMPlayer().replayContent(),this},playNextInQueue:function(){return this.getDOMPlayer().playNextInQueue(),this},pause:function(){return this.getDOMPlayer().pause(),this},resume:function(){return this.getDOMPlayer().resume(),this},stop:function(){return this.getDOMPlayer().stopContent(),this},queue:function(e,t,n){return"undefined"==typeof n&&(n=-1),this.getDOMPlayer().queue(e,t||{},n),this},queueFromObject:function(e,t,n){return"undefined"==typeof n&&(n=-1),this.getDOMPlayer().queueFromObject(e,t||{},n),this},dequeue:function(e){return this.getDOMPlayer().dequeue(e),this},emptyQueue:function(){return this.getDOMPlayer().emptyQueue(),this},setQueueAutoplay:function(e){return this.getDOMPlayer().setQueueAutoplay(e),this},getQueue:function(){return this.getDOMPlayer().getQueue()},seek:function(e){return this.getDOMPlayer().seek(e),this},mute:function(){return this.getDOMPlayer().mute(),this},unmute:function(){return this.getDOMPlayer().unmute(),this},setVolume:function(e){return this.getDOMPlayer().setVolume(e),this},getVolume:function(){return this.getDOMPlayer().getVolume()},isMuted:function(){return this.getDOMPlayer().isMuted()},getContentEntry:function(e){return this.getDOMPlayer().getContentEntry(e)},goFullscreen:function(){return this.getDOMPlayer().goFullscreen(),this},resize:function(e,t,n){return this.getDOMPlayer().resize(e,t,n),this},setMaxBitrate:function(e){return this.getDOMPlayer().setMaxBitrate(e),this},switchBitrateId:function(e){return this.getDOMPlayer().switchBitrateId(e),this},setAutoBitrateSwitch:function(e){return this.getDOMPlayer().setAutoBitrateSwitch(e),this},getAvailableBitrates:function(e){return this.getDOMPlayer().getAvailableBitrates(e)},getBitrateId:function(){return this.getDOMPlayer().getBitrateId()},setGroupOrder:function(e){return this.getDOMPlayer().setGroupOrder(e),this},getShareOptions:function(){return this.getDOMPlayer().getShareOptions()},setClosedCaptions:function(e,t){return this.getDOMPlayer().setClosedCaptions(e,t),this},setAdSection:function(e){return this.getDOMPlayer().setAdSection(e),this},setAdKeyValue:function(e,t){return this.getDOMPlayer().setAdKeyValue(e,t),this},getAdKeyValues:function(){return this.getDOMPlayer().getAdKeyValues()},clearAdKeyValues:function(){return this.getDOMPlayer().clearAdKeyValues(),this},setAdExchangeValue:function(e,t){return this.getDOMPlayer().setAdExchangeValue(e,t),this},setAdVisibility:function(e){return this.getDOMPlayer().setAdVisibility(e),this},switchAdContext:function(e){return this.getDOMPlayer().switchAdContext(e),this},switchTrackingContext:function(e){return this.getDOMPlayer().switchTrackingContext(e),this},setTrackingInterval:function(e){return this.getDOMPlayer().setTrackingInterval(e),this},setDataSrc:function(e){return this.getDOMPlayer().setDataSrc(e),this},setFileKey:function(e){return this.getDOMPlayer().setFileKey(e),this},sendUIMessage:function(e,t){return this.getDOMPlayer().sendUIMessage(e,t),this},sendUserReportedIssue:function(e){return this.getDOMPlayer().sendUserReportedIssue(e),this}};t.exports=u},{"../vendor/json3":98,"../vendor/swfobject":99,"./cdn":15,"./events":28,"./shared":38,"./static":39,"./utils":52}],14:[function(e,t,n){function i(e){var t={};for(var n in d)t[n]=d[n].exec(e);return t}var r=e("./version"),o=window.navigator.userAgent,s="object"==typeof console&&"function"==typeof console.log?function(){console.log.apply(console,arguments)}:function(){},a={IOS:"iOS",OSX:"OSX",ANDROID:"Android",SAFARI:"Safari",SILK:"Silk",CHROME:"Chrome",FIREFOX:"Firefox",OPERA:"Opera",IE:"Internet Explorer",IPAD:"iPad",IPOD:"iPod",IPHONE:"iPhone",KINDLE:"Kindle",DESKTOP:"desktop",MOBILE:"mobile",TABLET:"tablet"},l=document.createElement("video"),c=/^(maybe|probably)$/,u=function(e){try{return c.test(l.canPlayType(e))}catch(t){return!1}};a.supports={},a.supports.video="function"==typeof l.canPlayType,a.supports.mp4=a.supports.video&&u("video/mp4"),a.supports.m3u8=a.supports.video&&(u("application/x-mpegURL")||u("application/vnd.apple.mpegURL"));var d={Safari:/ Safari\/\d+(?:\.\d+){0,2}/,Version:/ Version\/(\d+(?:\.\d+){0,2})/,Opera:/^Opera\/\d+(?:\.\d+){0,2}/,Silk:/ Silk\/(\d+(?:\.\d+){0,2})/,InternetExplorer:/; MSIE (\d+(?:\D\d+){0,2})/,InternetExplorer11:/; Trident\/[^)]*; rv:(\d+(?:\D\d+){0,2})/,Firefox:/ Firefox\/(\d+(?:\D\d+){0,2})/,Chrome:/ Chrome\/(\d+(?:\D\d+){0,2})/,RenderingEngine:/ (AppleWebKit|Trident|Gecko|Presto)\/(\d+(?:\D\d+){0,2})/,AppleDevice:/ \((iP(?:[ao]d|hone));/,Android:/; Android(?: (\d+(?:\D\d+){0,2}))?[;)]/,iOS:/ OS (\d+(?:\D\d+){0,2}) like(?: Mac)? OS X/,OSX:/ OS X (\d+(?:\D\d+){0,2})/,MobileSafari:/ Mobile(?:\/\S+)? Safari\//,MobileFirefox:/; Mobile; .+ Firefox\/| Fennec\//,TabletFirefox:/; Tablet; .+ Firefox\//,IEMobile:/; IEMobile\/(\d+(?:\.\d+){0,2})/,OperaMobile:/; Opera (Mini|Mobi)\//,OperaTablet:/; Opera Tablet\//,SilkAccelerated:/ Silk-Accelerated=(true|false)/};!function(e){function t(e,t){var n=t||window,i=[].slice.call(arguments,2);return function(){return e.apply(n,i.concat([].slice.call(arguments)))}}e.Firefox?(a.name=a.FIREFOX,a.version=new r(e.Firefox[1])):e.InternetExplorer?(a.name=a.IE,a.version=new r(e.InternetExplorer[1])):e.InternetExplorer11?(a.name=a.IE,a.version=new r(e.InternetExplorer11[1])):e.Opera&&e.Version?(a.name=a.OPERA,a.version=new r(e.Version[1])):e.Silk?(a.name=a.SILK,a.version=new r(e.Silk[1])):e.Chrome?(a.name=a.CHROME,a.version=new r(e.Chrome[1])):e.Safari&&e.Version&&(a.name=a.SAFARI,a.version=new r(e.Version[1])),a.engine={},e.RenderingEngine&&(a.engine.name=e.RenderingEngine[1],a.engine.version=new r(e.RenderingEngine[2])),a.os={},e.Android?(a.os.name=a.ANDROID,"undefined"!=typeof e.Android[1]&&(a.os.version=new r(e.Android[1]))):e.iOS?(a.os.name=a.IOS,a.os.version=new r(e.iOS[1])):e.OSX&&(a.os.name=a.OSX,a.os.version=new r(e.OSX[1])),a.device={},e.AppleDevice?a.device.name=e.AppleDevice[1]:e.Silk&&(a.device.name=a.KINDLE),a.device.type=a.DESKTOP,(e.MobileSafari||e.MobileFirefox||e.IEMobile||e.OperaMobile)&&(a.device.type=a.MOBILE),(e.TabletFirefox||e.OperaTablet||e.Android&&a.device.type!==a.MOBILE)&&(a.device.type=a.TABLET);var n=function(e,t,n){var i,r=/^(!?~|[!=><]=?)?(\d.*)$/,o=function(e,t){var n,i=r.exec(t),o=e.is;if(!i)throw new Error("checkVersion: The pattern -- "+t+" -- was not considered valid.");switch(i[1]){case"~":o=e.is;break;case"!~":o=e.isnt;break;case"=":case"==":o=e.eq;break;case"!":case"!=":o=e.ne;break;case">":o=e.gt;break;case">=":o=e.gte;break;case"<":o=e.lt;break;case"<=":o=e.lte}return n=o.call(e,i[2])};switch(e){case"browser":i=t===a.name,n&&(i=i&&o(a.version,n));break;case"engine":i=t===a.engine.name,n&&(i=i&&o(a.engine.version,n));break;case"os":i=t===a.os.name,n&&(i=i&&o(a.os.version,n));break;case"device":i=t===a.device.name;break;case"platform":i=t===a.device.type;break;default:s('Browser.is() did not understand property "'+e+'"')}return i};a.isBrowser=t(n,this,"browser"),a.isEngine=t(n,this,"engine"),a.isOS=t(n,this,"os"),a.isDevice=t(n,this,"device"),a.isPlatform=t(n,this,"platform"),a.isOS(a.ANDROID,"<4")&&(a.supports.m3u8=!1),a.device.name===a.KINDLE&&(a.device.type=a.MOBILE),a.device.name===a.IPAD&&(a.device.type=a.TABLET)}(i(o)),t.exports=a},{"./version":53}],15:[function(e,t,n){function i(e){var t=null,n=null,i=null,r=null;return t=e.hasOwnProperty("secure"),n=(t?"https":"http")+"://",i=e.hasOwnProperty("cdnSubdomain")?e.cdnSubdomain:s,r=l,t&&(i=a),{secure:t,protocol:n,subdomain:i,host:r}}function r(e,t){var n=t.host.replace(/\$\{cdnSubdomain\}/,t.subdomain),i=e.replace(/\$\{protocol\}/,t.protocol).replace(/\$\{cdnHost\}/,n);return i}function o(e,t){var n=i(t),o=r(c,n);return e.replace(/\$\{cdn\}/,o)}var s="cvp1",a="s",l="${cdnSubdomain}.cdn.turner.com",c="${protocol}${cdnHost}";t.exports={replace:o}},{}],16:[function(require,module,exports){function jsonTextToJsObject(jsontext){if(logger.log("Convert::jsonTextToJsObject"),Utils.isNull(jsontext))return null;if(jsontext=Utils.trim(jsontext),""===jsontext)return null;var jsobject=null;try{jsobject=JSON3.parse(jsontext)}catch(e){if(logger.warn("Provided text was not valid JSON.  Attempting to eval()..."),isValidJSON(jsontext))try{jsobject=eval("("+jsontext+")")}catch(e2){logger.error("Unable to eval text into JS object.")}}return jsobject}function xmlTextToXmlDoc(e){logger.log("Convert::xmlTextToXmlDoc");var t;return e?(t=XML.stringToDoc(e),t||(logger.warn("Provided text was not valid XML.  Attempting to clean and parse again..."),e=XML.cleanString(e),t=XML.stringToDoc(e)),t):null}function xmlDocToXmlText(e){return logger.log("Convert::xmlDocToXmlText"),XML.docToString(e)}function xmlDocToJsonText(e){return logger.log("Convert::xmlDocToJsonText"),JsonConverter.xmlToJson(e)}function xmlDocToJsObject(e){return logger.log("Convert::xmlDocToJsObject"),JsonConverter.xmlToObject(e)}function xmlTextToJsonText(e){return logger.log("Convert::xmlTextToJsonText"),xmlDocToJsonText(xmlTextToXmlDoc(e))}function xmlTextToJsObject(e){return logger.log("Convert::xmlTextToJsObject"),jsonTextToJsObject(xmlTextToJsonText(e))}var JSON3=require("../vendor/json3"),Utils=require("./utils"),JsonConverter=require("./util/jsonconverter"),XML=require("./util/xml"),Log=require("./log"),logger=Log.getLogger(),allBackslashPairsRegex=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,allSimpleValueTokensRegex=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,allOpenBracketsRegex=/(?:^|:|,)(?:\s*\[)+/g,onlyValidLeftoverCharsRegex=/^[\],:{}\s]*$/,isValidJSON=function(e){return onlyValidLeftoverCharsRegex.test(e.replace(allBackslashPairsRegex,"@").replace(allSimpleValueTokensRegex,"]").replace(allOpenBracketsRegex,""))};module.exports={jsonTextToJsObject:jsonTextToJsObject,xmlTextToXmlDoc:xmlTextToXmlDoc,xmlDocToXmlText:xmlDocToXmlText,xmlDocToJsonText:xmlDocToJsonText,xmlDocToJsObject:xmlDocToJsObject,xmlTextToJsonText:xmlTextToJsonText,xmlTextToJsObject:xmlTextToJsObject}},{"../vendor/json3":98,"./log":29,"./util/jsonconverter":48,"./util/xml":51,"./utils":52}],17:[function(e,t,n){var i=e("./static"),r=e("./api"),o=e("./shared"),s=e("./utils"),a=e("../core/app"),l=e("./browser"),c=e("../vendor/swfobject"),u=e("./players/html5"),d=e("./players/null"),h=e("./log"),p=e("./util/log4js"),f=e("./performance"),g=e("../flash/global"),m=function(e){var t=this;this.options=s.extend({id:"cvp_player",width:"320",height:"240",flashVars:{},initialize:function(){}},e);var n=h.getLogger(this.options.id);if(this.options.embed=s.extend({containerSwf:"",expressInstallSwf:a.EXPRESS_INSTALL_URL,flashVersion:a.FLASH_VERSION},this.options.embed),this.options.embed.options=s.extend({quality:"high",bgcolor:"#000000",allowFullScreen:"true",allowScriptAccess:"always"},this.options.embed.options),!this.options.embed.containerSwf)throw n.error("Invalid containerSwf...exiting"),new Error("Invalid containerSwf");this.options.initialize();var r=this.options.id,m=this.options.width,_=this.options.height,v=this.options.flashVars,y=this.options.embed;this._playerType=this.options.playerType;var C=[a.FLASH,a.HTML5];this._playerType&&-1!==s.indexOf(C,this._playerType)||(this._playerType=a.FLASH,l.supports.video&&!c.hasFlashPlayerVersion("1.0.0")&&(this._playerType=a.HTML5));var w=null;if(s.extend(window,g),this._playerType===a.HTML5?(v.site&&v.profile?(n.info("instantiating the HTML5 player"),w=new u(this.options)):(n.error("invalid HTML5 params...instantiating null player"),this._playerType=!1,w=new d(this.options)),this.getDOMPlayer=function(){return w}):(n.info("instantiating the Flash player"),p.install()),i.findInstance(r)||s.byId(r))throw n.error(r+" is already in use...exiting"),new Error(r+" is already in use");if(this.getId=function(){return r},this.getWidth=function(){return m},this.getHeight=function(){return _},this.getFlashVars=function(){return v},this.getEmbed=function(){return y},this.getPlayerType=function(){return this._playerType},!o.createCallbackHandler(r))throw n.error('callback handler for id "'+r+'" could not be created...exiting'),new Error('callback handler for id "'+r+'" could not be created...exiting');this.callbacks={},delete this.options.initialize;var b,E;for(b in this.options)s.hasOwn(this.options,b)&&(E=this.options[b],s.isFunc(E)&&(this.callbacks[b]=E));var A={handleCallBack:function(e){var i,r;if(arguments.length){var o=s.slice(arguments,1);if(r=t[e],s.isFunc(r))try{i=r.apply(t,o)}catch(a){n.warn("exception on internal CB "+e,a.message)}if(r=t.callbacks[e],s.isFunc(r))try{i=r.apply(t,o)}catch(l){n.error("exception on user CB "+e,l.message)}}return i},onPageOrientationChange:function(e){t.isCVPReady()&&e!==t.getPageOrientation()&&(this._sendPageStateChange({orientation:e}),this.handleCallBack("onPageOrientationChange",r,e))},onPageVisibilityChange:function(e){t.isCVPReady()&&e!==t.isPageVisible()&&(this.handleCallBack("onPageVisibilityChange",r,e),this._fireCVPVisibilityChange())},onViewportVisibilityChange:function(e){t.isCVPReady()&&e!==t.isViewportVisible()&&(this.handleCallBack("onViewportVisibilityChange",r,e),this._fireCVPVisibilityChange())},_fireCVPVisibilityChange:function(){this.handleCallBack("onCVPVisibilityChange",r,t.isCVPVisible())},_sendPageStateChange:function(e){this._invokeAPI("sendMessage","pageStateChange",e)},_invokeAPI:function(e){var i=s.slice(arguments,1);if(e in t)try{t[e].apply(t,i)}catch(r){n.warn("[_invokeAPI] Error calling: "+e)}}},T=function(e){if(s.hasOwn(A,e))try{return A[e].apply(A,s.slice(arguments,1))}catch(t){n.warn("exception on message "+e,t.message)}},S=-1,k=-1,P=null,x=null;this.embed=i.Utils.before(this,this.embed,function(){S=i.Utils.now(),f.mark(r,"embedRequest")});var I=function(){if(!R)return void n.warn("[perfMetrics] Called before CVPReady!");var e=f.getCVPLoadMetrics(r,S,k);e.cvp=s.extend(e.cvp,{cvpjsVersion:a.VERSION,isPageVisible:Q,isViewportVisible:H}),P=e,t.reportAnalytics("playerLoadMetrics",P),x=JSON.stringify(e,null,4),n.info(x)},R=!1,L=v.contentId||"",D=v.context||"",O=D,F=0,M=0,N=0,j=0,B=-1,U=!1,q=!1,V=!1,z=window.orientation||"unknown",Q=!0,H=!0;return this.isCVPReady=function(){return R},this.getDOMPlayerInstance=function(){return O},this.getContentId=function(){return L},this.getContext=function(){return D},this.getContentWidth=function(){return F},this.getContentHeight=function(){return M},this.getDuration=function(){return N},this.getPlayhead=function(){return j},this.getAbsolutePlayhead=function(){return B},this.isBuffering=function(){return U},this.isPaused=function(){return q},this.isFullscreen=function(){return V},this.getPageOrientation=function(){return z},this.isPageVisible=function(){return Q},this.isViewportVisible=function(){return H},this.isCVPVisible=function(){return Q&&H},this._getLoadMetrics=function(){return P},this._getLoadMetricsReport=function(){return x},this.onCVPReady=function(){k=i.Utils.now(),R=!0,f.mark(r,"cvpReady"),I()},this.onPlayerReady=function(){O=this.getDOMPlayerInstance()},this.onPageVisibilityChange=function(e,t){Q=t},this.onViewportVisibilityChange=function(e,t){H=t},this.onContentMetadata=function(e,t,n,i,r){L=t,j=0,N=n,F=i,M=r},this.onContentBegin=function(e,t){q=!0,L=t},this.onAdPlay=function(){q=!1},this.onContentPlay=function(){q=!1},this.onContentBuffering=function(e,t,n){U=n},this.onContentPlayhead=function(e,t,n,i,r){j=n,B=r||-1},this.onContentPause=function(e,t,n){q=n},this.onContentResize=function(e,t,n,i){V=i},i.registerInstance(r,this,T),this};m.prototype=r,t.exports=m},{"../core/app":10,"../flash/global":54,"../vendor/swfobject":99,"./api":13,"./browser":14,"./log":29,"./performance":31,"./players/html5":32,"./players/null":33,"./shared":38,"./static":39,"./util/log4js":49,"./utils":52}],18:[function(e,t,n){var i=e("../vendor/Class"),r=e("./utils"),o=e("./log"),s=o.getLogger(),a=i.extend({init:function(e){this._type=e,this._listeners=[]},addListener:function(e,t){return r.isFunc(e)?void this._listeners.push({fn:e,ctxt:t}):void s.warn("CustomEvent.addListener: The provided param was not a function.")},removeListener:function(e,t){for(var n,i=0,r=this._listeners;i<r.length;)n=r[i],n.fn===e&&n.ctxt===t?r.splice(i,1):++i},dispatch:function(){for(var e,t=0,n=this._listeners.slice(),i=n.length;i>t;++t)e=n[t],e.fn.apply(e.ctxt,arguments)}});t.exports=a},{"../vendor/Class":96,"./log":29,"./utils":52}],19:[function(e,t,n){var i=e("../../vendor/Class"),r=i.extend({getType:function(){throw new Error("'getType' must be implemented by child class.")},canUse:function(){throw new Error("'canUse' must be implemented by child class.")},isComposable:function(){return!0},start:function(){throw new Error("'start' must be implemented by child class.")},stop:function(){throw new Error("'stop' must be implemented by child class.")}});t.exports=r},{"../../vendor/Class":96}],20:[function(e,t,n){var i=e("../../vendor/Class"),r=e("../utils"),o=e("../log"),s=e("./pagevisibilitystrategy"),a=e("./pagefocusstrategy"),l=e("./pagefocusinstrategy"),c=o.getLogger(),u=i.extend({init:function(e){e=r.extend({callback:null,strategies:null,mode:u.AGGRESSIVE},e),this._mode=e.mode,this._callback=e.callback,this._visible=null,this._onChangeBind=r.bind(this._onChange,this),this._availableStrategies=e.strategies||[new s({callback:this._onChangeBind}),new a({callback:this._onChangeBind}),new l({callback:this._onChangeBind})],this._strategies=[];for(var t=0;t<this._availableStrategies.length;++t)if(this._availableStrategies[t].canUse()){if(this._strategies.length>0&&!this._availableStrategies[t].isComposable())continue;if(this._strategies.push(this._availableStrategies[t]),c.log("[PageFocusDetector] Using detection strategy: "+this._availableStrategies[t].getType()),this._mode!==u.AGGRESSIVE){c.log("[PageFocusDetector] Conservative mode - sticking with one strategy");break}}this._strategies.length||c.log("[PageFocusDetector] Warning - no valid detection strategies found.")},_onChange:function(e){null!=this._visible&&this._visible===e||(this._visible=e,this._callback&&this._callback(e))},start:function(){r.each(this._strategies,function(e){e.start()})},stop:function(){r.each(this._strategies,function(e){e.stop()})}});u.CONSERVATIVE="conservative",u.AGGRESSIVE="aggressive",t.exports=u},{"../../vendor/Class":96,"../log":29,"../utils":52,"./pagefocusinstrategy":21,"./pagefocusstrategy":22,"./pagevisibilitystrategy":24}],21:[function(e,t,n){var i=e("./basestrategy"),r=e("../utils"),o=e("../browser"),s=e("../events"),a=i.extend({init:function(e){e=r.extend({callback:null},e),this._delayFireBlur=!1,this._timerId=null,this._callback=e.callback,this._onFocusFiredBind=r.bind(this._onFocusFired,this),this._onBlurFiredBind=r.bind(this._onBlurFired,this),this._fireBlurBind=r.bind(this._fireBlur,this)},getType:function(){return"PageFocusInStrategy"},canUse:function(){return o.isBrowser(o.IE)===!0},_onFocusFired:function(){return this._delayFireBlur?(this._timerId&&window.clearTimeout(this._timerId),void(this._delayFireBlur=!1)):void this._onChange(!0)},_onBlurFired:function(){this._delayFireBlur=!0,this._timerId=window.setTimeout(this._fireBlurBind,500)},_fireBlur:function(){this._delayFireBlur&&this._callback&&this._onChange(!1),this._delayFireBlur=!1},_onChange:function(e){this._callback&&this._callback(e)},start:function(){s.addListener(document,"focusin",this._onFocusFiredBind),s.addListener(document,"focusout",this._onBlurFiredBind)},stop:function(){s.removeListener(document,"focusin",this._onFocusFiredBind),s.removeListener(document,"focusout",this._onBlurFiredBind)}});t.exports=a},{"../browser":14,"../events":28,"../utils":52,"./basestrategy":19}],22:[function(e,t,n){var i=e("./basestrategy"),r=e("../utils"),o=e("../browser"),s=e("../events"),a=i.extend({init:function(e){e=r.extend({callback:null},e),this._delayFireBlur=!1,this._timerId=null,this._callback=e.callback,this._onFocusFiredBind=r.bind(this._onFocusFired,this),this._onBlurFiredBind=r.bind(this._onBlurFired,this),this._fireBlurBind=r.bind(this._fireBlur,this)},getType:function(){return"PageFocusStrategy"},canUse:function(){return o.isBrowser(o.IE)===!1},_onFocusFired:function(){return this._delayFireBlur?(this._timerId&&window.clearTimeout(this._timerId),void(this._delayFireBlur=!1)):void this._onChange(!0)},_onBlurFired:function(){this._delayFireBlur=!0,this._timerId=window.setTimeout(this._fireBlurBind,500)},_fireBlur:function(){this._delayFireBlur&&this._callback&&this._onChange(!1),this._delayFireBlur=!1},_onChange:function(e){this._callback&&this._callback(e)},start:function(){s.addListener(window,"focus",this._onFocusFiredBind),s.addListener(window,"blur",this._onBlurFiredBind)},stop:function(){s.removeListener(window,"focus",this._onFocusFiredBind),s.removeListener(window,"blur",this._onBlurFiredBind)}});t.exports=a},{"../browser":14,"../events":28,"../utils":52,"./basestrategy":19}],23:[function(e,t,n){var i=e("../../vendor/Class"),r=e("../utils"),o=e("../events"),s=i.extend({init:function(e){e=r.extend({callback:function(){}},e),this._callback=e.callback,this.handleOrientationBind=r.bind(this._handleScroll,this)},_handleScroll:function(){var e;switch(window.orientation){case-90:case 90:e="landscape";break;default:e="portrait"}this._callback&&this._callback(e)},start:function(){o.addListener(window,"orientationchange",this.handleOrientationBind)},stop:function(){o.removeListener(window,"orientationchange",this.handleOrientationBind)}});t.exports=s},{"../../vendor/Class":96,"../events":28,"../utils":52}],24:[function(e,t,n){var i=e("./basestrategy"),r=e("../utils"),o=e("../events"),s=i.extend({init:function(e){e=r.extend({callback:null},e),this._callback=e.callback,this._eventName=null,this._propName=null;for(var t=[{event:"msvisibilitychange",prop:"msHidden"},{event:"webkitvisibilitychange",prop:"webkitHidden"},{event:"mozvisibilitychange",prop:"mozHidden"},{event:"visibilitychange",prop:"hidden"}],n=0;n<t.length;++n)t[n].prop in document&&(this._propName=t[n].prop,this._eventName=t[n].event);this._onChangeBind=r.bind(this._onChange,this)},getType:function(){return"PageVisibilityStrategy"},canUse:function(){return null!=this._propName},_onChange:function(){var e=this._getHiddenValue();this._callback&&this._callback(!e)},_getHiddenValue:function(){return document[this._propName]},start:function(){o.addListener(document,this._eventName,this._onChangeBind)},stop:function(){o.removeListener(document,this._eventName,this._onChangeBind);
}});t.exports=s},{"../events":28,"../utils":52,"./basestrategy":19}],25:[function(e,t,n){var i=e("../../vendor/Class"),r=e("../utils"),o=e("../events"),s=e("../log"),a=s.getLogger(),l=i.extend({init:function(e){e=r.extend({callback:function(){},delay:500},e),this._callback=e.callback,this._interval=e.interval,a.log("[ScrollDetector] debouncing with a delay of: "+e.delay),this.handleScrollBind=r.debounce(r.bind(this._handleScroll,this),e.delay)},_handleScroll:function(){var e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,t=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;this._callback&&this._callback({scrollTop:e,scrollLeft:t,windowWidth:n,windowHeight:i})},start:function(){o.addListener(window,"scroll",this.handleScrollBind),o.addListener(window,"resize",this.handleScrollBind)},stop:function(){o.removeListener(window,"scroll",this.handleScrollBind),o.removeListener(window,"resize",this.handleScrollBind)}});t.exports=l},{"../../vendor/Class":96,"../events":28,"../log":29,"../utils":52}],26:[function(e,t,n){var i=e("../../vendor/Class"),r=e("../utils"),o=e("./scrolldetector"),s=i.extend({init:function(e){e=r.extend({delay:500},this._validateTargetOptions(e)),this._targets=[],this.addTarget(e),this._scrollDetector=new o({callback:r.bind(this._onScroll,this),delay:e.delay})},_validateTargetOptions:function(e){return r.extend({elementId:null,callback:function(){}},e)},addTarget:function(e){if(e=this._validateTargetOptions(e),null!=e.elementId){var t=e.elementId,n=e.callback;this._targets.push({elementId:t,callback:n,clipped:!1})}},_onScroll:function(e){function t(e){var t,n,r={top:0,left:0};return(t=e&&e.ownerDocument)?(n=t.documentElement,"undefined"!=typeof e.getBoundingClientRect&&(r=e.getBoundingClientRect()),{top:r.top+i-(n.clientTop||0),left:r.left+o-(n.clientLeft||0),width:e.offsetWidth,height:e.offsetHeight}):null}function n(e,t,n){return e!=t&&n&&n(!e),e}var i=e.scrollTop,o=e.scrollLeft,s=e.windowWidth,a=e.windowHeight;r.each(this._targets,function(e){var l=e.elementId;if(r.isString(l)&&(l=r.byId(l)),l){var c=t(l);c&&(i>=c.top+c.height||o>=c.left+c.width||c.top>=i+a||c.left>=o+s?e.clipped=n(!0,e.clipped,e.callback):c.top>i&&c.top+c.height<i+a&&(e.clipped=n(!1,e.clipped,e.callback)))}})},start:function(){this._scrollDetector.start()},stop:function(){this._scrollDetector.stop()}});t.exports=s},{"../../vendor/Class":96,"../utils":52,"./scrolldetector":25}],27:[function(e,t,n){function i(e){var t=""+r.AD_ERROR+s.AD_RUNTIME_ERROR+a.LOW;switch(e){case l.AD_TYPE_NOT_TRAFFICKED:return""+r.AD_ERROR+s.AD_RUNTIME_ERROR+a.HIGH+"4000";case l.NO_AD_PLAYED_AT_AD_SPOT:return""+r.AD_ERROR+s.AD_RUNTIME_ERROR+a.HIGH+"4001";case l.AD_RULE_FAILED:return t+"4006";case l.AD_SKIPPED_DUE_TO_SENSITIVITY:return t+"4005";case l.AD_SKIPPED_BY_JAVASCRIPT:return t+"4004";case l.PLAY_CALL_2ND_PARAM_DISABLED_AD:return t+"4003";case l.AD_SERVER_NOT_CONFIGURED:return""+r.AD_ERROR+s.AD_RUNTIME_ERROR+a.HIGH+"4002";case l.AD_EXISTS_BUT_FAILED:return""+r.AD_ERROR+s.AD_RUNTIME_ERROR+a.HIGH+"4007";default:return""+r.AD_ERROR+s.AD_RUNTIME_ERROR+a.HIGH+"4009"}}var r={ASPEN_REPORTING:"AS",CONTENT_ERROR:"CT",AD_ERROR:"AD",PLAYER_ERROR:"PL",CONTAINER_ERROR:"CR",EXTERNAL_ERROR:"EX"},o={PLAYER_CONFIG_ERROR:"PC",PLAYER_INIT_ERROR:"PI",VIDEO_ASSET_ERROR:"VA",NOT_AVAILABLE_:"NA",CONTENT_TOKEN_SERVICE_ERROR:"CA",TOKEN_SERVICE_ERROR:"TS",CLOSED_CAPTION_ERROR:"CC"},s={AD_LOAD_ERROR:"LD",AD_INIT_ERROR:"IN",AD_RUNTIME_ERROR:"RT",FW_NOTIFICATION:"FN"},a={HIGH:"hi",MEDIUM:"md",LOW:"lo"},l={AD_TYPE_NOT_TRAFFICKED:"ad type not trafficked",NO_AD_PLAYED_AT_AD_SPOT:"slot finished but no ad to play in slot",AD_SKIPPED_DUE_TO_SENSITIVITY:"ad skipped due to ad sensitivity setting",AD_SERVER_NOT_CONFIGURED:"no ad server is configured",PLAY_CALL_2ND_PARAM_DISABLED_AD:"ad was disabled via optional second param on play call",AD_SKIPPED_BY_JAVASCRIPT:"skipped as directed by the javascript callback",AD_RULE_FAILED:"skipped because did not pass ad rules",AD_PLAYBACK_ERROR:"unknown ad playback error",AD_EXISTS_BUT_FAILED:"ad exists but failed to play in slot",AD_INTERRUPTED:"slot was interrupted"};t.exports={ErrorType:r,PlayerErrorSubType:o,AdErrorSubType:s,ErrorLevel:a,ErrorMessage:l,determineAdErrorCode:i}},{}],28:[function(e,t,n){function i(e){l.addDomLoadEvent(e)}function r(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else{n.$$guid||(n.$$guid=d++),e._cvpStoredEvents||(e._cvpStoredEvents={});var i=e._cvpStoredEvents[t];i||(i=e._cvpStoredEvents[t]={},e["on"+t]&&(i[0]=e["on"+t]),e["on"+t]=s),i[n.$$guid]=n}}function o(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e._cvpStoredEvents&&e._cvpStoredEvents[t]&&n.$$guid&&delete e._cvpStoredEvents[t][n.$$guid]}function s(e){e=e||a(window.event);var t,n=!0,i=this._cvpStoredEvents[e.type];for(t in i)c.hasOwn(i,t)&&(this.$$handler=i[t],this.$$handler(e)===!1&&(n=!1));return this.$$handler&&(this.$$handler=null),n}function a(e){return e.preventDefault=a._preventDefault,e.stopPropagation=a._stopPropagation,e}var l=e("../vendor/swfobject"),c=e("./utils"),u=e("./customevent"),d=1;a._preventDefault=function(){this.returnValue=!1},a._stopPropagation=function(){this.cancelBubble=!0},n.onReady=i,n.addListener=r,n.removeListener=o,n.CustomEvent=u},{"../vendor/swfobject":99,"./customevent":18,"./utils":52}],29:[function(e,t,n){function i(e){if(p){var t=typeof console[e];R[e]=t===a||t===s&&f?h.call(console[e],console):g}}function r(e){var t=this;this.id=e||"",this.setLevel(k),this._logger={};for(var n in R)(function(e,n){t._logger[e]=function(){var i,r;return r=e.toUpperCase(),t.getLevel()>=E[r]?(i=u.call(arguments),i.unshift("["+v+"|"+y+"|"+t.id+"|"+(m()-_)+"]",r),n.apply(t,i)):void 0},t[e]=function(){return t._logger[e].apply(t._logger,arguments)}})(n,R[n])}for(var o=e("../core/app"),s="object",a="function",l="string",c="number",u=Array.prototype.slice,d=Function.prototype,h=d.bind,p=typeof console===s,f=typeof h===a,g=function(){if(p){var e=typeof console.log;if(e===a||e===s&&f)return h.call(console.log,console)}return d}(),m=typeof Date.now===a?Date.now:function(){return(new Date).getTime()},_=m(),v="CVP",y=window.self===window.top?"_top":window.name||"",C=["error","warn","info","debug","log"],w=[].concat("fatal",C,"trace"),b=[].concat("none",w,"all"),E={},A=null,T=0,S=b.length;S>T;++T)A=b[T],E[A.toUpperCase()]=T;var k=E.WARN,P=/NO|NONE|OFF|SILENT|QUIET/,x=function(e){return e=e.toUpperCase(),E[e]||(P.test(e)?E.NONE:E.ALL)},I=function(e){switch(typeof e){case l:return x(e);case c:return e;default:return k}};o.DEBUG_LEVEL&&(k=I(o.DEBUG_LEVEL));for(var R={},L=0,D=w.length;D>L;++L)i(w[L]);r.prototype.setLevel=function(e){return this.loggerLevel=I(e),this.loggerLevel},r.prototype.getLevel=function(){return this.loggerLevel};var O=[],F=function(e){return null==e&&(e=""),O[e]=O[e]||new r(e),O[e]};t.exports={Level:E,getDefaultLevel:function(){return k},setDefaultLevel:function(e){return k=I(e)},getLogger:F}},{"../core/app":10}],30:[function(e,t,n){var i=e("../core/app"),r=e("./static"),o=e("./core"),s=e("./shared"),a=e("./utils");r.Class=e("../vendor/Class"),r.swfobject=e("../vendor/swfobject"),r.Utils=a,r.Utils.CommandQueue=e("./util/commandqueue"),r.Utils.Asset=e("./util/asset"),r.Utils.Dependency=e("./util/dependency"),r.Utils.DependencyManager=e("./util/dependencymanager"),r.Utils.JsonConverter=e("./util/jsonconverter"),r.Utils.XML=e("./util/xml"),r.Utils.Timing=e("./util/timing"),r.Utils.ViewportDetector=e("./detectors/viewportdetector"),r.Utils.PageFocusDetector=e("./detectors/pagefocusdetector"),r.Ajax=e("./ajax"),r.Events=e("./events"),r.JSON=e("../vendor/json3"),r.Log=e("./log"),r.Version=e("./version"),r.Browser=e("./browser"),r.Request=e("./request"),r.Store=e("./store"),r.PluginManager=e("./pluginmanager"),r.Plugins=e("./plugins"),r.Performance=e("./performance"),r.init=function(e){var t,n;if(!a.isSimpleObject(e))throw new Error("CVP.init() requires one param: a simple object");for(t in e)a.hasOwn(e,t)&&(n=e[t],a.isSimpleObject(n)?i._cvpsetup[t]=a.extend(i._cvpsetup[t],n):i._cvpsetup[t]=n)},r.createPlayer=function(e){return new o(e)},r.getSessionToken=function(){return"Aspen"in window?window.Aspen.getSessionToken():void 0};var l=function(e){return r.createPlayer(e)};s.addBeforeUnLoadEvent(r.cleanup),t.exports=a.extend(l,r)},{"../core/app":10,"../vendor/Class":96,"../vendor/json3":98,"../vendor/swfobject":99,"./ajax":12,"./browser":14,"./core":17,"./detectors/pagefocusdetector":20,"./detectors/viewportdetector":26,"./events":28,"./log":29,"./performance":31,"./pluginmanager":34,"./plugins":35,"./request":37,"./shared":38,"./static":39,"./store":40,"./util/asset":42,"./util/commandqueue":43,"./util/dependency":46,"./util/dependencymanager":47,"./util/jsonconverter":48,"./util/timing":50,"./util/xml":51,"./utils":52,"./version":53}],31:[function(e,t,n){var i=e("./utils"),r=!1,o=!1,s=!1,a=!1,l=!1,c=!1;"performance"in window&&(r=!0,"timing"in window.performance&&(o=!0),"getEntries"in window.performance&&(s=!0),"mark"in window.performance&&(a=!0),"measure"in window.performance&&(l=!0),"now"in window.performance&&(c=!0));var u=r?window.performance:null,d={has:function(e){switch(e){case"perf":return r;case"timing":return o;case"entries":return s;case"mark":return a;case"measure":return l;case"now":return c;default:return!1}},getTiming:function(){return o?u.timing:{}},getEntries:function(){return s?u.getEntries():[]},getEntriesByType:function(e){return s?u.getEntriesByType(e):[]},getEntriesByName:function(e){return s?u.getEntriesByName(e):[]},mark:function(e,t){if(!a)return null;var n=e+"::"+t;return u.mark(n),n},measure:function(e,t,n,i){if(!l)return null;var r=e+"::"+t;return u.measure(r,n,i),r},getMarks:function(e){return a?this.getEntriesByType("mark"):[]},getMeasurements:function(e){return l?this.getEntriesByType("measure"):[]},getCVPLoadMetrics:function(e,t,n){var r={cvp:{embedRequestTime:t,cvpReadyTime:n,navStartToEmbedRequest:null,embedRequestToReady:n-t,flash:{embedRequestToContainerRequest:null,containerRequestToCoreComplete:null,coreCompleteToReady:null}},timing:null,totalEntries:null,cvpEntries:null};if(o&&(r.timing=this.getTiming()),s){var a=this.getEntriesByType("resource");r.cvp.navStartToEmbedRequest=r.cvp.embedRequestTime-r.timing.navigationStart;var l=function(e,t){return i.map(e,t)},c=function(e,t){return i.filter(e,t)},u=function(e){return function(t){return e.test(t.name)}},d=function(){var e="cdn\\.turner\\.com\\/xslo\\/cvp",t="\\.(xml|json)",n=["cvp\\_(\\w)+\\_container\\.swf","mapping{ext}","appConfig{ext}","bundle\\_[\\d\\.]{ext}","container{ext}","config{ext}","ad_policy{ext}","tracking_policy{ext}","ui_policy{ext}","restriction_policy{ext}"],i=function(e){return e.replace(/\{ext\}/g,t)},r=[e].concat(l(n,i)).join("|");return new RegExp(r,"i")},h=u(d()),p=function(e,t,n){return{name:e.name,startTime:e.startTime,duration:e.duration,requestIndex:t}},f=function(e){return e=c(e,h),l(e,p)},g=function(e,t){return e.startTime<t.startTime?-1:e.startTime>t.startTime?1:0},m=function(e,t){return t=c(t,u(e)),t.length?t[0].startTime:-1},_=function(e,t){return t=c(t,u(e)),t.length?t[0].startTime+t[0].duration:-1};r.totalEntries=a.length,r.cvpEntries=f(a).sort(g);var v=m(/cvp\_(\w)+\_container\.swf/,r.cvpEntries);-1!==v&&(r.cvp.flash.embedRequestToContainerRequest=v-r.cvp.navStartToEmbedRequest);var y=_(/CVP\_[\d\.\_]+(\_RC\d)?\.swf/,r.cvpEntries);if(-1!==v&&-1!==y&&(r.cvp.flash.containerRequestToCoreComplete=y-r.cvp.flash.embedRequestToContainerRequest),-1!==v&&-1!==y){var C=r.cvp.embedRequestToReady-r.cvp.flash.embedRequestToContainerRequest;r.cvp.flash.coreCompleteToReady=C-y}}return r}};t.exports=d},{"./utils":52}],32:[function(e,t,n){var i=e("../static"),r=e("./null"),o=e("../util/commandqueue"),s=e("../utils"),a=e("../log"),l=e("../../html5/api"),c=s.bind,u=a.getLogger(),d=function(e){this._instance=new e(this._options),this._instance.ePlayerLoaded.addListener(this._onPlayerLoaded,this),this._instance.ePlayerLoadError.addListener(this._onPlayerLoadError,this),this._instance.ePlayerReady.addListener(this._onPlayerReady,this),this._instance.ePlayerReady.addListener(this._onCVPReady,this),this._instance.ePlayerReady.addListener(c(this._onCallBack,this,"onPlayerReady")),this._instance.ePlayerReady.addListener(c(this._onCallBack,this,"onCVPReady")),this._instance.eContentBegin.addListener(c(this._onCallBack,this,"onContentBegin")),this._instance.eContentPlay.addListener(c(this._onCallBack,this,"onContentPlay")),this._instance.eContentPause.addListener(c(this._onCallBack,this,"onContentPause")),this._instance.eContentEnd.addListener(c(this._onCallBack,this,"onContentEnd")),this._instance.eContentComplete.addListener(c(this._onCallBack,this,"onContentComplete")),this._instance.eContentEntryLoad.addListener(c(this._onCallBack,this,"onContentEntryLoad")),this._instance.eContentEntryLoadError.addListener(c(this._onCallBack,this,"onContentEntryLoadError")),this._instance.eContentMetadata.addListener(c(this._onCallBack,this,"onContentMetadata")),this._instance.eContentPlayhead.addListener(c(this._onCallBack,this,"onContentPlayhead")),this._instance.eContentBuffering.addListener(c(this._onCallBack,this,"onContentBuffering")),this._instance.eContentResize.addListener(c(this._onCallBack,this,"onContentResize")),this._instance.eContentQueue.addListener(c(this._onCallBack,this,"onContentQueue")),this._instance.eContentQueueAutoplay.addListener(c(this._onCallBack,this,"onContentQueueAutoplay")),this._instance.eContentVolume.addListener(c(this._onCallBack,this,"onContentVolume")),this._instance.eContentError.addListener(c(this._onCallBack,this,"onContentError")),this._instance.eAdPlayhead.addListener(c(this._onCallBack,this,"onAdPlayhead")),this._instance.eAdPlay.addListener(c(this._onCallBack,this,"onAdPlay")),this._instance.eAdEnd.addListener(c(this._onCallBack,this,"onAdEnd")),this._instance.eAdError.addListener(c(this._onCallBack,this,"onAdError")),this._instance.eAdSensitive.addListener(c(this._onCallBack,this,"onAdSensitive")),this._instance.eTrackingAdStart.addListener(c(this._onCallBack,this,"onTrackingAdStart")),this._instance.eTrackingAdComplete.addListener(c(this._onCallBack,this,"onTrackingAdComplete")),this._instance.eTrackingAdProgress.addListener(c(this._onCallBack,this,"onTrackingAdProgress")),this._instance.eTrackingAdCountdown.addListener(c(this._onCallBack,this,"onTrackingAdCountdown")),this._instance.eTrackingAdClick.addListener(c(this._onCallBack,this,"onTrackingAdClick")),this._instance.eTrackingContentPlay.addListener(c(this._onCallBack,this,"onTrackingContentPlay")),this._instance.eTrackingContentBegin.addListener(c(this._onCallBack,this,"onTrackingContentBegin")),this._instance.eTrackingContentProgress.addListener(c(this._onCallBack,this,"onTrackingContentProgress")),this._instance.eTrackingContentComplete.addListener(c(this._onCallBack,this,"onTrackingContentComplete")),this._instance.eTrackingContentReplay.addListener(c(this._onCallBack,this,"onTrackingContentReplay")),this._instance.eTrackingContentSeek.addListener(c(this._onCallBack,this,"onTrackingContentSeek")),this._instance.eTrackingContentSeekEnd.addListener(c(this._onCallBack,this,"onTrackingContentSeekEnd")),this._instance.eTrackingFullscreen.addListener(c(this._onCallBack,this,"onTrackingFullscreen")),this._instance.eTrackingMuted.addListener(c(this._onCallBack,this,"onTrackingMuted")),this._instance.eTrackingPaused.addListener(c(this._onCallBack,this,"onTrackingPaused"))},h=r.extend({init:function(e){this._super(),this._options=e,this._loadQ=new o,this._loaded=!1,d.call(this,l)},_onPlayerLoaded:function(){u.debug("_onPlayerLoaded"),this._loaded=!0,this._loadQ.execute()},_onPlayerLoadError:function(){u.debug("_onPlayerLoadError"),this._onCallBack("onPlayerLoadError")},_onPlayerReady:function(){u.debug("_onPlayerReady")},_onCVPReady:function(){u.debug("_onCVPReady")},embed:function(e){return this._loaded?(u.info("executing embed"),void this._instance.render(e)):(u.info("queuing embed"),void this._loadQ.push(this.embed,this,arguments))},remove:function(){this._instance.remove()},dispose:function(){this._instance.dispose(),this._instance=null},playContent:function(e,t){this._instance.play(e,t)},playFromObject:function(e,t){this._instance.playFromObject(e,t)},replayContent:function(){this._instance.replay()},playNextInQueue:function(){this._instance.playNextInQueue()},pause:function(){this._instance.pause()},resume:function(){this._instance.resume()},stopContent:function(){this._instance.stop()},queue:function(e,t,n){this._instance.queue(e,t,n)},queueFromObject:function(e,t,n){this._instance.queueFromObject(e,t,n)},dequeue:function(e){this._instance.dequeue(e)},emptyQueue:function(){this._instance.emptyQueue()},setQueueAutoplay:function(e){this._instance.setQueueAutoplay(e)},getQueue:function(){return this._instance.getQueue()},seek:function(e){this._instance.seek(e)},resize:function(e,t){this._instance.resize(e,t)},goFullscreen:function(){this._instance.goFullscreen()},mute:function(){this._instance.mute()},unmute:function(){this._instance.unmute()},setVolume:function(e){this._instance.setVolume(e)},getVolume:function(){return this._instance.getVolume()},isMuted:function(){return this._instance.isMuted()},getContentEntry:function(e){return this._instance.getContentEntry(e)},setAdSection:function(e){this._instance.setAdSection(e)},setAdKeyValue:function(e,t){this._instance.setAdKeyValue(e,t)},getAdKeyValues:function(){return this._instance.getAdKeyValues()},clearAdKeyValues:function(){this._instance.clearAdKeyValues()},setTrackingInterval:function(e){this._instance.setTrackingInterval(e)},setDataSrc:function(e){this._instance.setDataSrc(e)},reportAnalytics:function(e,t){this._instance.reportAnalytics(e,t)},_onCallBack:function(){i.onCallback(this._options.id,arguments)},instance:function(){return this._instance}});t.exports=h},{"../../html5/api":61,"../log":29,"../static":39,"../util/commandqueue":43,"../utils":52,"./null":33}],33:[function(e,t,n){var i=e("../../vendor/Class"),r=i.extend({init:function(){for(var e,t="sendMessage setDefaultPlayer play playFromObject replay playNextInQueue pause resume stop queue queueFromObject dequeue emptyQueue setQueueAutoplay getQueue seek mute unmute setVolume getVolume isMuted getContentEntry goFullscreen resize setMaxBitrate switchBitrateId setAutoBitrateSwitch getAvailableBitrates getBitrateId setGroupOrder getShareOptions setClosedCaptions setAdSection setAdKeyValue getAdKeyValues clearAdKeyValues setAdExchangeValue setAdVisibility switchAdContext switchTrackingContext setTrackingInterval setDataSrc setFileKey sendUIMessage sendUserReportedIssue".split(" "),n=function(){},i=0,r=t.length;r>i;++i)e=t[i],this[e]||(this[e]=n)}});t.exports=r},{"../../vendor/Class":96}],34:[function(e,t,n){var i=e("./static"),r=e("./utils"),o=e("./log"),s=r.extend,a=r.slice,l=r.isFunc,c=r.now,u=o.getLogger("PluginManager"),d={LMDB:"lmdb"},h={},p=function(e,t){return e=(e||"").toUpperCase(),d[e]?void(h[e]=t):void u.warn("[registerPlugin] Invalid plugin type. Unable to register: "+e)},f={};f.create=function(e,t){return e=(e||"").toUpperCase(),h[e]?new h[e](t):(u.warn("[create] Invalid plugin type. Unable to create: "+e),null)},f.createLMDB=function(e){return f.create(d.LMDB,e)};var g={},m=function(e,t){g[e]=t},_=function(e,t,n){var i=this;if(this.id=e,!t||!n)return u.error("[PluginHostAdapter] Invalid host or plugin. Aborting"),null;var r=function(e){return function(){return n[e].apply(n,arguments)}};for(var o in n)l(n[o])&&(this[o]=r(o));var s=function(e){var n=t();return function(){n._sendToPluginHost(i.id,e,a(arguments))}};for(var c in n.getEvents())n.on(c,s(c))};_.create=function(e,t,n,r){var o=[e,t,n,c()].join("_"),s=function(){var t=i.findInstance(e);return t.instance.getDOMPlayer()},a=f.create(n,r);return new _(o,s,a)};var v=function(e,t){var n=t.shift(),i=t.shift(),r=null;if(u.debug("[onPluginHostAPIRequest] request received: "+n+", "+i),!n)return"create"!==i?(u.error("[onPluginHostAPIRequest] Invalid create method passed"),null):(r=_[i].apply(_,[e].concat(t)),m(r.id,r),r.id);r=g[n];try{return r[i].apply(r,t)}catch(o){u.warn("[onPluginHostAPIRequest] Unable to call method: "+i+" on plugin: "+n)}},y={register:p};y=s(y,d),y=s(y,f),y.onPluginHostRequest=v,t.exports=y},{"./log":29,"./static":39,"./utils":52}],35:[function(e,t,n){var i=e("./pluginmanager"),r=e("./plugins/lmdb"),o={};i.register(i.LMDB,r),o.LMDB=i.createLMDB({lazy:!0}),t.exports=o},{"./pluginmanager":34,"./plugins/lmdb":36}],36:[function(e,t,n){var i=e("../../vendor/Class"),r=e("../customevent"),o=e("../utils"),s=e("../request"),a=e("../util/timing"),l=e("../convert"),c=e("../log"),u=c.getLogger("LMDB"),d=function(e,t){return a.periodically(e,t)},h=function(e){return e&&0===e.indexOf("<")&&e.lastIndexOf(">")===e.length-1},p=i.extend({init:function(e){var t=this;this.setOptions(e),this.events={dataReceived:new r("dataReceived"),dataReceivedError:new r("dataReceivedError")},this._onDataReceived=function(e,n){u.debug("[LMDB.onDataReceived] url: "+e),h(n)&&t.options.convertXML&&(u.debug("[LMDB.onDataReceived] Detected XML - converting"),n=l.xmlTextToJsonText(n)),t.events.dataReceived.dispatch(e,l.jsonTextToJsObject(n))},this._onDataReceivedError=function(e,n){u.debug("[LMDB.onDataReceivedError] url: "+e),t.events.dataReceivedError.dispatch(e,n)}},setOptions:function(e){var t={convertXML:!0};if(this.options=o.extend(this.options||t,e||{}),u.debug("[LMDB.setOptions] url: "+this.options.url+", interval: "+this.options.interval),this.options.interval&&this.options.url){if(o.toInt(this.options.interval)<=0)return;u.debug("[LMDB.setOptions] creating timer with interval: "+this.options.interval),this.periodical&&this.periodical.stop(),this.periodical=d(o.bind(this.request,this,this.options.url),this.options.interval)}},getEvents:function(){return this.events},request:function(e){u.info("[LMDB.request] url: "+e),this._transport=s.get({url:e,lazy:this.options.lazy,success:o.bind(this._onDataReceived,this,e),failure:o.bind(this._onDataReceivedError,this,e)})},on:function(e,t){o.hasOwn(this.events,e)&&this.events[e].addListener(o.bind(t,this))},start:function(e){u.debug("[LMDB.start]"),o.undef(e)&&(e=!0),this.periodical&&(this.periodical.start(),e&&this.request(this.options.url))},stop:function(){this.periodical&&this.periodical.stop()},getScheduleItems:function(e){var t=[];return e&&e.hasOwnProperty("LiveFeed")&&e.LiveFeed.hasOwnProperty("tveLiveSched")&&e.LiveFeed.tveLiveSched.hasOwnProperty("SchedItem")?t.concat(e.LiveFeed.tveLiveSched.SchedItem):t},getScheduleItem:function(e,t){for(var n=this.getScheduleItems(e),i=o.undef(t),r=o.isFunc(t),s=0;s<n.length;++s){if(i)return n[s];if(r){if(t(n[s]))return n[s]}else if(n[s].AiringID==t)return n[s]}return null}});t.exports=p},{"../../vendor/Class":96,"../convert":16,"../customevent":18,"../log":29,"../request":37,"../util/timing":50,"../utils":52}],37:[function(e,t,n){function i(){return F.apply(this,arguments)}var r=e("../core/app"),o=e("./utils"),s=e("./log"),a=e("./transports/flashxhr"),l=e("../vendor/easyXDM"),c=e("../vendor/json3"),u=e("../vendor/swfobject"),d=e("./convert"),h=e("../vendor/when"),p=s.getLogger(),f="GET",g="POST",m="withCredentials",_=function(e,t,n){return function(){if(e&&4===e.readyState)try{200<=e.status&&e.status<300||304===e.status?n.resolve(e.responseText):n.reject(e.status+" "+e.statusText)}catch(t){p.error("Exception with XHR: ",t),n.reject(t.message)}finally{e.onreadystatechange=Function.prototype,e.abort(),e=null}}},v=function(e,t){for(var n in t)o.hasOwn(t,n)&&e.setRequestHeader(n,t[n])},y=function(e){return o.isNull(e)?e:o.isObject(e)?o.encodeParams(e):window.encodeURIComponent(e).replace(/%20/g,"+")},C=function(e){if(o.isNull(e))return e;if(o.isObject(e)){var t={};return o.each(e,function(e,n){t[e]=o.isSimpleObject(n)?c.stringify(n):n}),t}return e},w={accepts:function(e){return!o.isCrossDomain(e.url)},request:function(e){p.log("Request::AjaxTransport.request",e.url),e.method===f&&e.data&&(e.url=o.augmentQueryString(e.url,e.data),e.data=null);var t=h.defer(),n=new window.XMLHttpRequest;n.onreadystatechange=_(n,e,t.resolver),n.open(e.method,e.url,!0),v(n,e.headers);var i=y(e.data);return n.send(e.method===g?i:null),t.promise}},b={_uniqId:0,_paramRE:/([^?&]+)=\?(?=&|$)/,createCallbackName:function(e){return"cvp_jsonp_"+e+"_"+o.now()},determineCallbackParam:function(e){var t=this._paramRE.exec(e);return t?t[1]:void 0},accepts:function(e){return"jsonp"===e.type||e.jsonpCallback},request:function(e){p.log("Request::JSONPTransport.request",e.url);var t=++this._uniqId;e.data=e.data||{},e.timeout=e.timeout||5e3;var n,i=h.defer(),r=function(e){n=e,i.resolve(e)},s="script",a=document.getElementsByTagName(s)[0],l=document.createElement(s),c=/^(complete|loaded)$/,u=!1,d=e.jsonpParam||this.determineCallbackParam(e.url),f=e.jsonpCallback||this.createCallbackName(t),g=window[f];window[f]=r,d&&(e.data[d]=f),e.cache===!1&&(e.data._=o.now()),e.url=o.augmentQueryString(e.url,e.data);var m=function(){u||"readyState"in l&&!c.test(l.readyState.toString())||(u=!0,p.info("installed "+this.src))},_=function(){var e="failed to install "+this.src;u=!0,p.error(e),i.reject(e)},v=function(){if(!u){var t="timeout while attempting to load "+e.url;u=!0,p.warn(t),i.reject(t)}},y="number"==typeof e.timeout?window.setTimeout(v,e.timeout):null,C=function(){window[f]=g,window.clearTimeout(y),l.onload=l.onreadystatechange=l.onerror=null,l.parentElement.removeChild(l),n&&o.isFunction(g)&&g(n),a=l=g=n=void 0,void 0===window[f]&&delete window[f]};return i.promise.ensure(C),l.onload=l.onreadystatechange=m,l.onerror=_,l.id=e.id||this.createCallbackName(t),l.src=e.url,a.parentNode.insertBefore(l,a),i.promise}},E={accepts:function(){return u.hasFlashPlayerVersion("8.0.0")},request:function(e){p.log("Request::FlashXHRTransport.request",e.url);var t=h.defer(),n=new a(e.lazy),i=function(e,n){t.resolve(n)},r=function(e,n){t.reject(n)};n.on("dataReceived",i),n.on("dataReceivedError",r);var o=C(e.data);return n.request(e.url,{type:e.method,data:o}),t.promise}},A={accepts:function(){return window.XMLHttpRequest&&m in new window.XMLHttpRequest||!o.isUndefined(window.XDomainRequest)},request:function(e){p.log("Request::CORSTransport.request",e.url);var t=new window.XMLHttpRequest,n=h.defer();if(e.method===f&&e.data&&(e.url=o.augmentQueryString(e.url,e.data),e.data=null),t.onreadystatechange=_(t,e,n.resolver),o.isBoolean(e.withCredentials)&&m in t&&(t.withCredentials=e.withCredentials),m in t)t.open(e.method,e.url,!0),e.method===g&&v(t,{"Content-Type":"application/x-www-form-urlencoded"});else{if(o.isUndefined(window.XDomainRequest))throw t=null,new Error("Did not find CORS-compatible interface.");t=new window.XDomainRequest,t.open(e.method,e.url)}var i=y(e.data);return t.send(e.method===g?i:null),n.promise}},T=[],S=function(e){if(p.log("Request::registerXDM"),o.isArray(e))p.debug("Request::registerXDM - merging provided array with xdmRegistry"),T.push.apply(T,e);else if(o.isSimpleObject(e)){p.debug("Request::registerXDM - adding each property to xdmRegistry");for(var t in e)o.hasOwn(e,t)&&T.push({match:t,path:e[t]})}else{if(2!==arguments.length)throw new Error("Invalid parameters to `registerXDM` -- use either registerXDM(list/map) or registerXDM(string/regex, path-to-iframe)");p.debug("Request::registerXDM - adding xdmRegistry for '"+arguments[0]+"' with path '"+arguments[1]+"'"),T.push({match:arguments[0],path:arguments[1]})}},k=function(e){p.log("Request::unregisterXDM");for(var t,n=e.toString(),i=T.length-1;i>=0;i--)if(t=T[i],n===t.match.toString())return T.splice(i,1)},P=function(e,t){p.log("Request::testPattern");var n="[object RegExp]"===Object.prototype.toString.call(t)?String.prototype.search:String.prototype.indexOf;return-1!==n.call(e,t)},x=function(e){p.log("Request::lookupIframe");for(var t,n=T.length-1;n>=0;n--){if(t=T[n],P(e,t.match))return p.debug("Request::lookupIframe - origin '"+e+"' matched '"+t.match+"'"),e+t.path;p.debug("Request::lookupIframe - origin '"+e+"' did not match '"+t.match+"'")}},I={getIframe:function(e){var t=o.parseUrl(e),n=t.origin;return x(n)},hasIframe:function(e){return!!this.getIframe(e)},accepts:function(e){return o.isCrossDomain(e.url)&&this.hasIframe(e.url)},request:function(e){p.log("Request::XDMTransport.request",e.url);var t=this.getIframe(e.url);if(!t){var n=o.parseUrl(e.url),i=n.origin;throw new Error("Did not find a registered XDM iframe for origin '"+i+"'.")}p.log("Found a registered XDM iframe at '"+t+"'.");var s=h.defer(),a=new l.Rpc({swf:r.EASYXDM_SWF_URL,remote:t},{serializer:c,remote:{request:{}}}),u={url:e.url,method:e.method,headers:e.header||void 0,timeout:e.timeout||void 0,data:C(e.data)},d=function(e){p.log("XDMTransport request success: ",e);try{s.resolve(e.data)}catch(t){s.reject(o.extend(e,{responseText:e.data}))}},f=function(e){p.log("XDMTransport request failure: ",e),"data"in e&&(e=o.extend({responseText:e.data.data,statusText:e.message},e.data)),s.reject(e)};return a.request(u,d,f),s.promise}},R=[{name:"jsonp",impl:b,exclusive:!0},{name:"ajax",impl:w,exclusive:!0},{name:"flxhr",impl:E},{name:"cors",impl:A},{name:"xdm",impl:I}],L=/\.(js(?:onp?)?|(?:ht|x)ml)$/i,D=function(e){if(e.type)return e.type.toLowerCase();var t=o.parseUrl(e.url),n=L.exec(t.pathname);return n?n[1].toLowerCase():""},O=function(e){for(var t,n=[],i=[].concat(e.transports||e.transport||[]),r=o.isEmpty(i),s=0,a=R.length;a>s&&(t=R[s],!r&&-1===o.indexOf(i,t.name)||!t.impl.accepts(e)||(n.push(t.impl),!t.exclusive));++s);return n},F=function(e){if(!o.isSimpleObject(e))throw new Error("Request.createRequest requires an object parameter.");var t=h.defer();e.method=(e.method||f).toUpperCase(),e.type=D(e),e.data=e.data||null,e.headers=e.headers||{},e.success=e.callback||e.success,e.failure=e.error||e.failure,t.promise.then(e.success,e.failure);var n=O(e),i=null,r=function(e){t.resolve(e)},s=function(e){i=e,a()},a=function(){if(0===n.length)t.reject(i);else{var o=n.shift();try{var a=o.request(e);a.then(r,s)}catch(l){s(l)}}};return a(),t.promise};i.registerXDM=S,i.unregisterXDM=k,i.get=function(e){return e.method=f,F(e)},i.getXML=function(e){return e.type="xml",F(e).then(d.xmlTextToXmlDoc)},i.getJSON=function(e){return e.type="json",F(e).then(d.jsonTextToJsObject)},i.getJSONP=function(e){return e.type="jsonp",F(e)},i.post=function(e){return e.method=g,F(e)},i.registerXDM(/^(http:\/\/([iz]|cvp\d+)|https:\/\/s)\.cdn\.turner\.com(:\d+)?$/,"/xslo/xslo/test/xdm_iframe"),i.registerXDM(/^https?:\/\/aspen\.turner\.com(:\d+)?$/,"/static/xdm_iframe.html"),i.registerXDM(/^https?:\/\/refwebapp\.aspen\.vgtf\.net(:\d+)?$/,"/static/xdm_iframe.html"),t.exports=i},{"../core/app":10,"../vendor/easyXDM":97,"../vendor/json3":98,"../vendor/swfobject":99,"../vendor/when":100,"./convert":16,"./log":29,"./transports/flashxhr":41,"./utils":52}],38:[function(e,t,n){function i(e){var t=s.createCallbackHandlerName(e);return c.isFunc(window[t])?!1:(window[t]=function(){return arguments.length&&"_pluginRequest"===arguments[0]?s.PluginManager.onPluginHostRequest(e,c.slice(arguments,1)):s.onCallback(e,arguments)},!0)}function r(e){if(e===l.FLASH_VERSION)return e;try{var t=new a(e);if(t.gt(l.FLASH_VERSION))return t.toString()}catch(n){d.warn("Failure to compare Flash versions",l.FLASH_VERSION,e)}return l.FLASH_VERSION}function o(e){var t=window.onbeforeunload;"function"!=typeof window.onbeforeunload?window.onbeforeunload=e:window.onbeforeunload=function(){t&&t(),e()}}var s=e("./static"),a=e("./version"),l=e("../core/app"),c=e("./utils"),u=e("./log"),d=u.getLogger();n.createCallbackHandler=i,n.validateFlashVersion=r,n.addBeforeUnLoadEvent=o},{"../core/app":10,"./log":29,"./static":39,"./utils":52,"./version":53}],39:[function(e,t,n){var i=e("../core/app"),r=e("./detectors/pageorientationdetector"),o=e("./detectors/pagefocusdetector"),s=e("./detectors/viewportdetector"),a=e("./utils"),l=e("./log"),c=l.getLogger(),u={},d={
initialized:!1,init:function(){var e=this;this.initialized||(this._pageOrientationDetector=new r({callback:function(t){e._sendToAllInstances("onPageOrientationChange",t)}}),this._pageFocusDetector=new o({callback:function(t){e._sendToAllInstances("onPageVisibilityChange",t)}}),this._viewportDetector=new s,this._pageOrientationDetector.start(),this._pageFocusDetector.start(),this._viewportDetector.start(),this.initialized=!0)},registerInstance:function(e){var t=u.findInstance(e);t&&this._addViewportTarget(e)},unregisterInstance:function(e){},_addViewportTarget:function(e){var t=this;this._viewportDetector.addTarget({elementId:e,callback:function(n){t._sendToInstance(e,"onViewportVisibilityChange",n)}})},_sendToAllInstances:function(){var e=a.slice(arguments);a.each(u.instances,function(t,n){n.send.apply(n,e)})},_sendToInstance:function(e){var t=a.slice(arguments,1),n=u.instances[e];n&&n.send.apply(n,t)}};u.HTML5=i.HTML5,u.FLASH=i.FLASH,u.version=i.VERSION,u.buildDate=i.BUILD_DATE,u.VIDEO_NOT_FOUND_ERROR="video not found",u.VIDEO_XML_NOT_FOUND_ERROR="cms error",u.MEDIA_ERR_UNKNOWN="Unknown error.",u.MEDIA_ERR_ABORTED="The fetching process for the media resource was aborted by the user agent at the user's request.",u.MEDIA_ERR_NETWORK="A network error of some description caused the user agent to stop fetching the media resource, after the resource was established to be usable.",u.MEDIA_ERR_DECODE="An error of some description occurred while decoding the media resource, after the resource was established to be usable.",u.MEDIA_ERR_SRC_NOT_SUPPORTED="The media resource indicated by the src attribute was not suitable.",u.instances={};var h=/[-+*\\\/]/g,p={},f={};u.sanitizeId=function(e){if(e in p)return p[e];if(!h.test(e))return e;var t=e.replace(h,"_");return p[e]=t,f[t]=e,c.warn("The provided ID '"+e+"' contains characters that interfere with Flash ExternalInterface; sanitizing to '"+t+"'."),t},u.unsanitizeId=function(e){return e in f?f[e]:e},u.createCallbackHandlerName=function(e){return u.sanitizeId(e)+"_callback_handler"},u.registerInstance=function(e,t,n){u.instances[e]={instance:t,send:n},d.initialized||d.init(),d.registerInstance(e)},u.unregisterInstance=function(e){if(e in u.instances){var t=u.createCallbackHandlerName(e);t in window&&(window[t]=null),u.instances[e]=null,delete u.instances[e]}},u.findInstance=function(e){var t=u.instances[e];return t&&t.instance||t},u.onCallback=function(e,t){var n=u.instances[e];if(!n)throw c.error("onCallback - unable to find instance "+e),new Error("onCallback - unable to find instance "+e);return n.send.apply(n.instance,["handleCallBack"].concat(a.slice(t)))},u.cleanup=function(){a.each(u.instances,function(e,t){try{t.instance.destroy(),u.unregisterInstance(e)}catch(n){}})},t.exports=u},{"../core/app":10,"./detectors/pagefocusdetector":20,"./detectors/pageorientationdetector":23,"./detectors/viewportdetector":26,"./log":29,"./utils":52}],40:[function(e,t,n){var i=e("./utils"),r={};t.exports={get:function(e,t){var n=r[e];return t&&delete r[e],n},keys:function(){var e=[];for(var t in r)i.hasOwn(r,t)&&e.push(t);return e},set:function(e,t){r[e]=t}}},{"./utils":52}],41:[function(e,t,n){var i=e("../../core/app"),r=e("../utils"),o=e("../store"),s=e("../customevent"),a=e("../util/commandqueue"),l=e("../log"),c=e("../../vendor/Class"),u=e("../../vendor/swfobject"),d=l.getLogger(),h=c.extend({init:function(e){d.debug("[Transport.init]"),this.ready=!1,this.queue=new a,this.events={dataReceived:new s("dataReceived"),dataReceivedError:new s("dataReceivedError")},this.channelId=h.nextChannel(),h.registerInstance(this),e=r.undef(e)?!1:e,e||h.loadDependencies()},onReady:function(){d.debug("[Transport.onReady] channel: "+this.channelId),this.createListeners(),this.ready=!0,this.queue.executeAsync()},createListeners:function(){var e=this;o.set(h.getResponseCallback(this.channelId),function(t,n){setTimeout(function(){e.fireDataReceived(t,n)},0)}),o.set(h.getResponseErrorCallback(this.channelId),function(t,n){setTimeout(function(){e.fireDataReceivedError(t,n)},0)})},request:function(e,t){return h.dependenciesLoaded||h.loadDependencies(),this.ready?(d.debug("[Transport.request] channel: "+this.channelId),void h.getSwf().request(this.channelId,e,t)):void this.queue.push(this.request,this,arguments)},on:function(e,t){this.events.hasOwnProperty(e)&&this.events[e].addListener(t)},fireDataReceived:function(e,t){this.events.dataReceived.dispatch(e,t)},fireDataReceivedError:function(e,t){this.events.dataReceivedError.dispatch(e,t)}});h.instances=[],h.registerInstance=function(e){var t={instance:e,ready:!1};h.dependenciesLoaded&&(e.onReady(),t.ready=!0),h.instances.push(t)},h.callPrefix="cvp_flash_xhr",h.readySuffix="ready",h.responseSuffix="response",h.responseErrorSuffix="response_error",h.getReadyCallback=function(){return[h.callPrefix,h.readySuffix].join("_")},h.getResponseCallback=function(e){return[h.callPrefix,e,h.responseSuffix].join("_")},h.getResponseErrorCallback=function(e){return[h.callPrefix,e,h.responseErrorSuffix].join("_")},h.channelIndex=0,h.nextChannel=function(){return"flaxhr."+ ++h.channelIndex},h.dependenciesLoading=!1,h.dependenciesLoaded=!1,h.loadDependencies=function(){h.dependenciesLoading||h.dependenciesLoaded||(h.dependenciesLoading=!0,h.embed(r.bind(h.onDependenciesLoaded,h)))},h.onDependenciesLoaded=function(){h.dependenciesLoading=!1,h.dependenciesLoaded=!0;for(var e=h.instances,t=0;t<e.length;++t)e[t].ready||(e[t].instance.onReady(),e[t].ready=!0)},h.swfId="cvpXhrFlash",h.swfUrl=i.FLASHXHR_SWF_URL,h.getSwf=function(){return document.getElementById(h.swfId)},h.embed=function(e){function t(t){return t&&t.success&&t.ref?void o.set(h.getReadyCallback(),function(){d.debug("[Transport.ready] Callback received"),r.isFunc(e)&&e()}):d.warn("[Transport.embed] failed to embed!")}d.debug("[Transport.embed] Checking if xhr is required on the page");var n=h.swfUrl,s=h.swfId;if(h.getSwf())return d.debug("[Transport.embed] cvpXhrFlash already present on the page. Proceeding."),void(r.isFunc(e)&&e());var a=s+"_placeholder",l=document.createElement("div");l.id=a,document.body.appendChild(l);var c={callPrefix:this.callPrefix,log:"true"},p={menu:"false",scale:"noScale",allowScriptAccess:"always",wmode:"transparent"},f={style:"position: fixed !important; top: 0 !important; left: 97px !important; z-index: 9999 !important; visibility: visible !important;",id:s};d.debug("[Transport.embed] Embedding xhr swf"),u.embedSWF(n,a,"1","1","8.0.0",i.EXPRESS_INSTALL_URL,c,p,f,t)},t.exports=h},{"../../core/app":10,"../../vendor/Class":96,"../../vendor/swfobject":99,"../customevent":18,"../log":29,"../store":40,"../util/commandqueue":43,"../utils":52}],42:[function(e,t,n){var i=e("../../vendor/Class"),r=e("../utils"),o=e("../customevent"),s=e("../log"),a=s.getLogger(),l=i.extend({init:function(e,t){this._firedSuccess=!1,this._url=e,this._type=r.empty(t)?this._determineType():t,this.id="cvp_asset_"+r.getRandomInt(1,1e3),this.eSuccess=new o,this.eFailure=new o},_determineType:function(){return r.empty(this._url)?"":this._url.substring(this._url.lastIndexOf(".")+1)},load:function(){switch(a.info("Asset","loading type",this._type),this._type){case"js":this._loadJs();break;case"css":this._loadCss();break;default:this._failure()}},_success:function(){a.info("Asset","successfully loaded asset",this._url),this.eSuccess.dispatch(),this._firedSuccess=!0},_failure:function(){a.error("Asset","failed to load asset",this._url),this.eFailure.dispatch()},_loadJs:function(){var e=document.getElementsByTagName("head")[0];if(!e)return void this._failure();var t=document.createElement("script");t.id=this.id,t.type="text/javascript";var n=r.bind(function(){this._firedSuccess||(this._success(),t.onload=t.onreadystatechange=null,e.removeChild(t))},this);t.onload=n,t.onerror=r.bind(this._failure,this),t.onreadystatechange=function(){"loaded"!==this.readyState&&"complete"!==this.readyState||n()},t.src=this._url,e.appendChild(t)},_loadCss:function(){var e,t=document.getElementsByTagName("head")[0];return t?(e=document.createElement("link"),e.type="text/css",e.rel="stylesheet",e.href=this._url,e.media="screen",t.appendChild(e),void this._success()):void this._failure()}});t.exports=l},{"../../vendor/Class":96,"../customevent":18,"../log":29,"../utils":52}],43:[function(e,t,n){var i=e("../../vendor/Class"),r=e("../utils"),o=i.extend({init:function(){this._queue=[]},clear:function(){this._queue.length=0},push:function(e,t,n){var i=this._queue.length;return this._queue.push({fn:e,scope:t,args:n}),i},remove:function(e){e="number"!=typeof e?this._queue.length-1:e,this._queue.splice(e,1)},execute:function(){for(var e,t=0,n=this._queue.length;n>t;++t)e=this._queue[t],e.fn.apply(e.scope,e.args)},executeAsync:function(e){e=r.undef(e)?10:e;var t,n=this._queue.length;n&&(t=this._queue.shift(),t.fn.apply(t.scope,t.args),setTimeout(r.bind(this.executeAsync,this,e),e))}});t.exports=o},{"../../vendor/Class":96,"../utils":52}],44:[function(e,t,n){var i=e("../utils"),r=e("../log"),o=r.getLogger(),s=function(e,t,n){this._interval=i.isNull(n)?10:n,this._maxTries=500,this._condition=e,this._success=t,this._tries=0,this.conditionWrapper=i.bind(function(){var e=this._condition();e?(window.clearInterval(this._timer),this._success()):this._tries>this._maxTries&&(o.warn("condition never met!"),window.clearInterval(this._timer)),++this._tries},this),this.start=function(){this._timer=window.setInterval(this.conditionWrapper,this._interval)}};t.exports=s},{"../log":29,"../utils":52}],45:[function(e,t,n){function i(e,t,n){var i,r=this.getReplacementPatterns(e),o=0,a=0,l="";if(!s.empty(r))for(a=r.length;a>o;++o){if(i=r[o],l="",l=this.getReplacementText(i,t),!s.isString(l))return l;s.empty(l)?l="":n&&(l=encodeURI(l)),e=e.replace(i,l)}return e}function r(e){return e&&e.match(/[$][{][^}]*[}]/g)}function o(e,t){var n="",i="",r=[],o="";switch(e){case"${page.domain}":n=document.domain;break;case"${page.url}":n=location.href;break;case"${videoId}":case"${video.id}":t&&(n=t.getId());break;default:if(i=e.substr(2,e.length-3),r=i.split("."),o=r[0],r.length>1)switch(i=i.substr(o.length+1),o){case"video":t&&(n=a.getNodeValue(t._xmlEntry,i));break;case"javascript":window.cvpSearchTheClient&&(n=window.cvpSearchTheClient(null,i));break;default:n=e}else n=e}return n}var s=e("../utils"),a=e("./xml");n.stringReplace=i,n.getReplacementPatterns=r,n.getReplacementText=o},{"../utils":52,"./xml":51}],46:[function(e,t,n){var i=e("../../vendor/Class"),r=e("../customevent"),o=e("./asset"),s=e("../log"),a=s.getLogger(),l=i.extend({init:function(e,t){this._assetUrl=e,this.required=t,this._manager=null,this.eSuccess=new r,this.eFailure=new r},load:function(){a.info("Dependency","loading asset",this._assetUrl),this._assetLoader=new o(this._assetUrl),this._assetLoader.eSuccess.addListener(this._success,this),this._assetLoader.eFailure.addListener(this._failure,this),this._assetLoader.load()},_success:function(){a.info("Dependency","successfully loaded dependency",this._assetUrl),this.eSuccess.dispatch.apply(this.eSuccess,arguments),this._complete()},_failure:function(){a.error("Dependency","failed to load dependency",this._assetUrl),this.eFailure.dispatch.apply(this.eFailure,arguments),this._complete()},_complete:function(){this._assetLoader&&(this._assetLoader.eSuccess.removeListener(this._success,this),this._assetLoader.eFailure.removeListener(this._failure,this),this._assetLoader=null)},setManager:function(e){this._manager=e},getDesc:function(){return this._assetUrl}});t.exports=l},{"../../vendor/Class":96,"../customevent":18,"../log":29,"./asset":42}],47:[function(e,t,n){var i=e("../../vendor/Class"),r=e("../customevent"),o=i.extend({init:function(){this._dependencies=[],this._currentDependency=null,this.eSuccess=new r,this.eFailure=new r,this.eDependencySuccess=new r,this.eDependencyFailure=new r},addDependency:function(e){e.setManager(this),this._dependencies.push(e)},load:function(){this._currentDependency=this._dependencies.shift(),this._currentDependency.eSuccess.addListener(this._onDependencySuccess,this),this._currentDependency.eFailure.addListener(this._onDependencyFailure,this);var e=this;window.setTimeout(function(){e._currentDependency.load()},10)},_onDependencySuccess:function(e){this.eDependencySuccess.dispatch(this._currentDependency,e),this._next()},_onDependencyFailure:function(e){return this.eDependencyFailure.dispatch(this._currentDependency,e),this._currentDependency.required?void this._onFailure(this._currentDependency.getDesc()):void this._next()},_next:function(){this._currentDependency.eSuccess.removeListener(this._onDependencySuccess,this),this._currentDependency.eFailure.removeListener(this._onDependencyFailure,this),this._currentDependency=null,this._dependencies.length?this.load():this._onSuccess()},_onSuccess:function(){this.eSuccess.dispatch()},_onFailure:function(e){this.eFailure.dispatch(e)}});t.exports=o},{"../../vendor/Class":96,"../customevent":18}],48:[function(e,t,n){function i(e){return C.test(e.nodeName)}function r(e){return e.nodeName}function o(e){var t=m.map(e,r),n=m.uniq(t);return t.length!==n.length}function s(e){return!i(e)}function a(e){return m.filter(m.slice(e.attributes),s)}function l(e,t){return t=t||{},e.length?(m.each(e,function(e){t[e.nodeName]=e.nodeValue}),t):t}function c(e){if(!e.hasChildNodes())return null;var t=e.textContent||e.innerText||"";return m.trim(t).replace(y," ")}function u(e,t){t=m.isSimpleObject(t)?t:{};var n,i=e.nodeName,r=e.nodeType,s={};switch(r){case Node.DOCUMENT_NODE:n=g.getChildElements(e),t=n.length?u(n[0]):null;break;case Node.ELEMENT_NODE:n=g.getChildElements(e);var d=a(e);if(n.length)o(n)?s=m.map(n,function(e){return u(e)}):(d.length&&l(d,s),m.each(n,function(e){return u(e,s)}));else{var h=c(e);d.length?(l(d,s),null!==h&&(s.text=h)):s=h||""}t[i]=s;break;default:v.debug("Ignoring type "+r+' node with name "'+i+'"')}return t}function d(e){if(!e||!e.nodeType||!e.nodeName||e.nodeType!==Node.ELEMENT_NODE||"video"!==e.nodeName)return v.debug('Not a "video" node; passing through.'),u(e);v.debug('Processing "video" children...');var t={},n=g.getChildElements(e),i=a(e);if(n.length)i.length&&l(i,t),m.each(n,function(e){return u(e,t)});else{var r=c(e);i.length?(l(i,t),null!==r&&(t.text=r)):t=r||""}return{video:t}}function h(e){try{e.normalize()}catch(t){if(9===e.nodeType)try{var n=g.getChildElements(e);n.length&&n[0].normalize()}catch(i){}}var r=d(e);if(r)for(var o in r)return r[o];return null}function p(e){return f.stringify(h(e),null,"	")}var f=e("../../vendor/json3"),g=e("./xml"),m=e("../utils"),_=e("../log"),v=_.getLogger("JSONConverter"),y=/[\t\n\r\xA0]+/g,C=/^xmlns($|:)/;n.encodeXmlObject=p,n.xmlToJson=p,n.xmlToObject=h},{"../../vendor/json3":98,"../log":29,"../utils":52,"./xml":51}],49:[function(e,t,n){function i(){!l||u||c||window.log4javascript||(a.info("installing log4javascript"),c=!0,function(e,t,n){var i=e.createElement(t),r=e.getElementsByTagName(t)[0],s=/^(complete|loaded)$/,l=!1;i.onload=i.onreadystatechange=function(){l||n in i&&s.test(i[n])||(i.onload=i.onreadystatechange=null,l=!0,a.info("installed log4javascript"),u=!0)},i.src=o.LOG4JAVASCRIPT_URL,r.parentNode.insertBefore(i,r)}(document,"script","readyState"))}function r(){return u}var o=e("../../core/app"),s=e("../log"),a=s.getLogger(),l=o.DEBUG,c=!1,u=!1;n.install=i,n.isInstalled=r},{"../../core/app":10,"../log":29}],50:[function(e,t,n){function i(e,t){function n(){r&&(window.clearTimeout(r),r=null)}function i(){n(),r=window.setTimeout(e,t)}var r;if(!isFinite(t)||"function"!=typeof e)throw new Error("usage: eventually(cb, ms)");return{start:i,stop:n}}function r(e,t){var n,i=0,r=function(){e(++i,t)},o=function(){window.clearInterval(n)},s=function(){n&&o(),n=window.setInterval(r,t||1e3)};return{start:s,stop:o}}t.exports={eventually:i,periodically:r}},{}],51:[function(e,t,n){function i(e){return 1===e.nodeType}function r(e){var t=c.slice(e.children||e.childNodes||[]);return t.length?c.filter(t,i):t}function o(e,t){if(!e)return null;if(!t)return c.isNull(e.firstChild)?null:e.firstChild.nodeValue;var n=e.getElementsByTagName(t);return n.length>0&&n[0].firstChild?n[0].firstChild.nodeValue:void 0}function s(e,t){if(e&&e.attributes&&t){var n=e.attributes.getNamedItem(t);return n?n.nodeValue:null}}function a(e,t){if(!e||!t)return null;for(var n,i=e.getElementsByTagName("param"),r=0,o=i.length;o>r;++r)if(n=i[r],s(n,"name")===t)return s(n,"value")}function l(e,t){for(var n,i=0,r=t&&t.length||0;r>i;++i)n=t[i],e[n.nodeName]=n.nodeValue}var c=e("../utils.js"),u="DOMParser",d="XMLSerializer",h="ActiveXObject",p=function(){var e,t;return u in window?(e=new window[u],t=function(e){var t=e.getElementsByTagName("parsererror");return t&&0!==t.length},function(n){var i;return n?(i=e.parseFromString(c.trim(n),"text/xml"),t(i)?null:i):null}):h in window?(t=function(e){var t=e.parseError;return t&&0!==t.errorCode},function(e){var n;return e?(n=new window[h]("Microsoft.XMLDOM"),n.async="false",n.loadXML(e),t(n)?null:n):null}):void 0}(),f=function(){if(d in window){var e=new window[d];return function(t){return e.serializeToString(t)}}return h in window?function(e){return e.xml}:void 0}(),g=function(){var e=/>\s+</g,t=/\t+/g,n=/[\r\n]+/g,i=/<!--(.*?)-->/g,r=/&(?!amp;)/g,o=/xmlns(?::[^\s=]+)?=['"][^'"]*['"]/g;return function(s){return s=s.replace(e,"><"),s=s.replace(t," "),s=s.replace(n," "),s=s.replace(i,""),s=s.replace(r,"&amp;"),s=s.replace(o,"")}}();n.stringToDoc=p,n.docToString=f,n.cleanString=g,n.getChildElements=r,n.getNodeValue=o,n.getParamValue=a,n.getAttribute=s,n.assignAttributes=l},{"../utils.js":52}],52:[function(e,t,n){"use strict";function i(e){if(!e)return document.cookie;for(var t,n=encodeURIComponent(e)+"=",i=document.cookie.split("; "),r=0,o=i.length;o>r;++r)if(t=i[r],0===t.indexOf(n))return decodeURIComponent(t.substring(n.length,t.length));return null}function r(e,t,n){if(e){var i=null;n&&(i=isNaN(Number(n))?n:new Date(n).toUTCString()),document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+(i?"; expires="+n:"")+"; path=/"}}function o(e){e&&r(e,"",-1)}function s(e){return document.getElementById(e)}function a(e,t){return Array.prototype.slice.call(e,t||0)}function l(e,t){var n=a(arguments,2);return function(){var i=n.concat(a(arguments));return e.apply(t,i)}}function c(e){return"undefined"==typeof e}function u(e){return c(e)||null===e}function d(e){return"function"==typeof e}function h(e){return"object"==typeof e}function p(e){return"[object Object]"===Object.prototype.toString.call(e)}function f(e){return"string"==typeof e}function g(e){return"boolean"==typeof e}function m(e){if(u(e))return!0;if(f(e)||pe(e))return 0===e.length;for(var t in e)if(he(e,t))return!1;return!0}function _(e,t){if(g(e))return e;if(m(e))return t;switch(e.toLowerCase()){case"yes":case"true":case"on":return!0;default:return!1}}function v(e,t){var n,i,r,o,s=arguments.length>2?a(arguments,1):t?[t]:[];for(e=e||{},n=0,i=s.length;i>n;++n)if(r=s[n],r&&h(r))for(o in r)e[o]=r[o];return e}function y(e,t){var n,i,r,o,s,l=arguments.length>2?a(arguments,1):t?[t]:[];for(e=p(e)?e:{},n=0,i=l.length;i>n;++n)if(r=l[n],r&&p(r)&&e!==r)for(o in r)s=r[o],p(s)&&s!==e?e[o]=y(e[o],s):e[o]=s;return e}function C(e,t,n){var i,r,o;if(pe(e))for(r=0,o=e.length;o>r&&(i=t.call(n||e[r],e[r],r,e),i!==!1);++r);else for(r in e)if(he(e,r)&&(i=t.call(n||e[r],r,e[r],e),i===!1))break}function w(e){var t=[];for(var n in e)he(e,n)&&t.push(n);return t}function b(e,t,n){var i=[];return null==e?i:(C(e,function(e,r,o){i.push(t.call(n,e,r,o))}),i)}function E(e){var t=[];return C(e,function(e){-1===fe(t,e)&&t.push(e)}),t}function A(e){return e}function T(e,t,n){t=t||A;var i=!0;return null==e?i:(C(e,function(e,r,o){return(i=i&&t.call(n,e,r,o))?void 0:!1}),!!i)}function S(e,t,n){t=t||A;var i=!1;return null==e?i:(C(e,function(e,r,o){return i||(i=t.call(n,e,r,o))?!1:void 0}),!!i)}function k(e,t,n){t=t||A;var i=[];return null==e?i:(C(e,function(e,r,o){t.call(n,e,r,o)&&i.push(e)}),i)}function P(e,t,n){return t=t||A,k(e,function(e,i,r){return!t.call(n,e,i,r)},n)}function x(e,t,n){t=t||A;var i;return S(e,function(e,r,o){return t.call(n,e,r,o)?(i=e,!0):void 0}),i}function I(e,t,n){t=t||A;var i=-1;return S(e,function(e,r,o){return t.call(n,e,r,o)?(i=r,!0):void 0}),i}function R(e,t,n){var i,r,o,s=null,a=0;n=n||{},t=t||250;var l=function(){a=n.leading===!1?0:de(),s=null,o=e.apply(i,r)};return function(){var c=de();a||n.leading!==!1||(a=c);var u=t-(c-a);return i=this,r=arguments,0>=u?(window.clearTimeout(s),s=null,a=c,o=e.apply(i,r)):s||n.trailing===!1||(s=window.setTimeout(l,u)),o}}function L(e,t,n){var i,r,o,s,a;return t=t||250,function(){o=this,r=arguments,s=de();var l=function(){var c=de()-s;t>c?i=window.setTimeout(l,t-c):(i=null,n||(a=e.apply(o,r)))},c=n&&!i;return i||(i=window.setTimeout(l,t)),c&&(a=e.apply(o,r)),a}}function D(e){var t=e.match(/\{[^{}]*\}/g),n=0,i=0,r=a(arguments,1),o=r.length;if(t)for(n=0,i=t.length;i>n&&o>n;++n)e=e.replace(t[n],r[n]);else ce.info("No {placeholders} present in template: ",e);return e}function O(e,t){var n,i=[];u(t)&&(t=",");for(n in e)he(e,n)&&i.push(n+"="+e[n]);return i.join(t)}function F(e){return 0===e.indexOf("//")||-1!==e.indexOf("://")}function M(e){return!F(e)}function N(e){var t=document.createElement("a");t.href=e;var n=t.href;t=null;var i=ge.exec(n);return i?{href:i[0]||"",origin:i[1]||"",protocol:i[2]||"",scheme:i[3]||"",host:i[4]||"",hostname:i[5]||"",port:i[6]||"",pathname:i[7]||"",dir:i[8]||"",file:i[9]||"",search:i[10]||"",query:i[11]||"",hash:i[12]||"",anchor:i[13]||""}:void 0}function j(e){var t={};return u(e)?t:(e.replace(me,function(e,n,i){return t[n]=i?window.decodeURIComponent(i):"",e}),t)}function B(e){var t={},n=e||window.location.href,i=N(n);return i.query&&(t=j(i.query)),t}function U(e){return B()[e]}function q(e){var t,n,i=[],r=window.encodeURIComponent;for(t in e)he(e,t)&&(n=e[t],i.push(r(t)+(""!==n?"="+r(h(n)?ae.stringify(n):n):"")));return i.join("&").replace(/%20/g,"+")}function V(e){var t=q(e);return t?"?"+t:""}function z(e,t){var n=N(e),i=j(n.query);i=v(i,t);var r=V(i);return n.origin+n.pathname+r+n.hash}function Q(e){var t={"http:":"80","https:":"443"};return e=N(e),e.hostname.toLowerCase()!==location.hostname.toLowerCase()||(e.port||t[e.protocol])!==(location.port||t[location.protocol])||e.protocol.toLowerCase()!==location.protocol.toLowerCase()}function H(){window.console&&window.console.log&&oe.DEBUG&&window.console.log(a(arguments).join(" | "))}function W(e,t){var n;"nested"!==t&&ce.info("Print all values for ",t);for(n in e)if(he(e,n)){if(!n)continue;h(e[n])?(ce.info("Printing nested object value",n),W(e[n],"nested")):ce.info("nested"===t?"	":"","key:",n,"value:",e[n])}"nested"!==t&&ce.info("End Print all values for ",t)}function K(e){var t=se.defer();return setTimeout(t.resolve,e),t.promise}function $(e,t){var n=se.defer();return e.then(n.resolve,n.reject),setTimeout(function(){n.reject(new Error("timed out"))},t),n.promise}function J(e,t){return 1===arguments.length?Math.floor(Math.random()*e):Math.floor(Math.random()*(t-e+1))+e}function G(e){return+e}function X(e){return parseInt(e,10)}function Y(e){return Number(e).toFixed(3)}function Z(e){var t,n="",i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".split("");for(e||(e=J(i.length)),t=0;e>t;t++)n+=i[J(i.length)];return n}function ee(e){return String(e).replace(_e,"\\$&")}function te(e,t,n){if(m(e))return e;var i=ee(t);return e.replace(new RegExp(i+"$","i"),n)}function ne(e,t,n){return function(){n.apply(e,arguments);var i=t.apply(e,arguments);return i}}function ie(e,t,n){return function(){var i=a(arguments),r=t.apply(e,i);return n.apply(e,[i,r]),r}}function re(e,t,n){return function(){return n.apply(e,[t,a(arguments)])}}var oe=e("../core/app"),se=e("../vendor/when"),ae=e("../vendor/json3"),le=e("./log"),ce=le.getLogger(),ue=function(){function e(e,t,n){return n.toUpperCase()}if("getComputedStyle"in window)return function(e,t){return window.getComputedStyle(e,null).getPropertyValue(t)};var t=/(-([a-z]))/g;return function(n,i){return"currentStyle"in n?("float"===i&&(i="styleFloat"),i=i.replace(t,e),n.currentStyle[i]||null):null}}(),de="function"==typeof Date.now?Date.now:function(){return(new Date).getTime()},he="function"==typeof Object.prototype.hasOwnProperty?function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}:function(e,t){return e[t]!==Object.prototype[t]},pe="function"==typeof Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},fe=function(){var e=Array.prototype.indexOf,t=d(e)?e:function(e,t){if(this){var n=this.length;for(t=t?0>t?Math.max(0,n+t):t:0;n>t;++t)if(t in this&&this[t]===e)return t}return-1};return function(e,n,i){return f(e)?e.indexOf(n,i):pe(e)?t.call(e,n,i):void 0}}(),ge=/^((([^:\/?#]+):)?(?:\/\/(([^\/?#]*)(?::(\d+))?))?)(([^?#]*\/)([^\/?#]*)?)(\?([^#]*))?(#(.*))?$/,me=/[?&]?([^&=]+)(?:=([^&=]+))?/g,_e=/[.*+?^${}()|[\]\\]/g,ve=function(){var e=/^[\s\xA0]+|[\s\xA0]+$/g,t=String.prototype.trim;return d(t)?function(e){return u(e)?"":t.call(e)}:function(t){return u(t)?"":String(t).replace(e,"")}}();n.trim=ve,n.getStyle=ue,n.now=de,n.getCookie=i,n.setCookie=r,n.deleteCookie=o,n.undef=c,n.isUndefined=c,n.nil=u,n.isNull=u,n.empty=m,n.isEmpty=m,n.isFunc=d,n.isFunction=d,n.isObject=h,n.isSimpleObject=p,n.isString=f,n.isBoolean=g,n.isArray=pe,n.indexOf=fe,n.isFlagActive=_,n.extend=v,n.merge=y,n.each=C,n.keys=w,n.map=b,n.uniq=E,n.identity=A,n.every=T,n.some=S,n.filter=k,n.reject=P,n.find=x,n.findIndex=I,n.throttle=R,n.debounce=L,n.byId=s,n.slice=a,n.hasOwn=he,n.bind=l,n.template=D,n.joinKeys=O,n.isAbsolute=F,n.isRelative=M,n.isRelativePath=M,n.parseUrl=N,n.parseQueryString=j,n.getQueryParams=B,n.getQueryParam=U,n.encodeParams=q,n.toQueryString=V,n.augmentQueryString=z,n.isCrossDomain=Q,n.log=H,n.print=W,n.delay=K,n.timeout=$,n.getRandomInt=J,n.toNum=G,n.toInt=X,n.toFixed=Y,n.randomString=Z,n.escapeRegExp=ee,n.replaceExtension=te,n.before=ne,n.after=ie,n.around=re},{"../core/app":10,"../vendor/json3":98,"../vendor/when":100,"./log":29}],53:[function(e,t,n){function i(e){if("string"!=typeof e)throw new TypeError("Version() only accepts a string");this.raw=e,this.major=NaN,this.minor=NaN,this.revision=NaN;var t=r.exec(e);if(!t)throw new SyntaxError('Version string "'+this.raw+'" failed to parse as a valid version number');var n=t[1],i=t[3],s=t[5];this.major=n,i&&!o.test(t[2])&&(this.minor=i,s&&!o.test(t[4])&&(this.revision=s))}var r=/(\d+)(?:(\D)(\d+))?(?:(\D)(\d+))?/,o=/^[abd]$/;i.prototype.toString=function(){return this.toArray().join(".")},i.prototype.toArray=function(e){for(var t,n=[this.major,this.minor,this.revision],i=[],r=0,o=n.length;o>r&&(t=+n[r],e||!isNaN(t));++r)i.push(t);return i},i.prototype.compare=function(e,t){if(!(e instanceof i))return this.compare(new i(e),t);var n,r,o,s=0,a=0,l=this.toArray(!0);for(n=t?e.toArray():e.toArray(!0),a=n.length;a>s;++s){if(r=+l[s]||0,o=+n[s]||0,r>o)return 1;if(o>r)return-1}return 0},i.prototype.is=function(e){return 0===this.compare(e,!0)},i.prototype.eq=function(e){return 0===this.compare(e)},i.prototype.gt=function(e){return this.compare(e)>0},i.prototype.lt=function(e){return this.compare(e)<0},i.prototype.isnt=function(e){return!this.is(e)},i.prototype.ne=function(e){return!this.eq(e)},i.prototype.lte=function(e){return!this.gt(e)},i.prototype.gte=function(e){return!this.lt(e)},t.exports=i},{}],54:[function(require,module,exports){function cvpSearchTheClient(theObj,thePath){var index=thePath.indexOf("."),objName="",subPath="",childObj;return null===theObj&&(theObj=window),-1===index?-1!==thePath.indexOf("(")&&-1!==thePath.indexOf(")")?eval("theObj."+thePath):theObj[thePath]:(objName=thePath.substring(0,index),subPath=thePath.substring(index+1),childObj=theObj[objName],-1!==objName.indexOf("(")&&-1!==objName.indexOf(")")&&(childObj=eval("theObj."+objName)),null===childObj?"":subPath.length<1?childObj.toString():cvpSearchTheClient(childObj,subPath))}exports.cvpSearchTheClient=cvpSearchTheClient},{}],55:[function(e,t,n){var i=e("../../vendor/Class"),r=e("../../cvp/customevent"),o=e("../../cvp/log"),s=e("./adtypes"),a=e("./videostates"),l=e("./freewheelimpl"),c=e("./dfpimpl"),u=e("../../cvp/errors"),d=u.ErrorMessage,h=o.getLogger("AdServerProxy"),p=i.extend({init:function(e){return this._adPolicy=e,this.eAdPlay=new r,this.eAdPlayhead=new r,this.eAdEnd=new r,this.eAdError=new r,this.eAdClick=new r,this.eAdReady=new r,this.eAdStopped=new r,this._adServerType=this._adPolicy.ads.attr.type.toLowerCase(),this._adServer=this._createImpl(),this._adServer?void this._listen(!0):(h.warn("Unable to create ad server impl."),void this._onAdError(d.AD_SERVER_NOT_CONFIGURED))},_listen:function(e){if(this._isListening!==e){this._isListening=e;var t=e?"addListener":"removeListener";this._adServer.eAdPlay[t](this._onAdPlay,this),this._adServer.eAdPlayhead[t](this._onAdPlayhead,this),this._adServer.eAdEnd[t](this._onAdEnd,this),this._adServer.eAdError[t](this._onAdError,this),this._adServer.eAdClick[t](this._onAdClick,this),this._adServer.eAdReady[t](this._onAdReady,this),this._adServer.eAdStopped[t](this._onAdStopped,this)}},_createImpl:function(){var e=this._adServerType;switch(e){case"freewheel":return new l(this._adPolicy);case"dfp":return new c(this._adPolicy);default:return null}},setAdSection:function(e){this._adServer&&this._adServer.setAdSection(e)},getAdSection:function(){return this._adServer?this._adServer.getAdSection():void 0},setAdKeyValue:function(e,t){this._adServer&&this._adServer.setAdKeyValue(e,t)},getAdKeyValue:function(e){return this._adServer?this._adServer.getAdKeyValue(e):void 0},getAdKeyValues:function(){return this._adServer?this._adServer.getAdKeyValues():void 0},clearAdKeyValues:function(){this._adServer&&this._adServer.clearAdKeyValues()},setVideoState:function(e){this._adServer&&this._adServer.setVideoState(e)},setVideoStatePlaying:function(){this.setVideoState(a.PLAYING)},setVideoStatePaused:function(){this.setVideoState(a.PAUSED)},setVideoStateStopped:function(){this.setVideoState(a.STOPPED)},setVideoStateCompleted:function(){this.setVideoState(a.COMPLETED)},getVideoState:function(){return this._adServer?this._adServer.getVideoState():void 0},setVideoDisplayBase:function(e){this._adServer&&this._adServer.setVideoDisplayBase(e)},isEnabled:function(){return this._adServer?this._adServer.enabled:!1},playPreroll:function(){this._adServer&&this._adServer.playPreroll()},getMidrolls:function(){return this._adServer?this._adServer.getMidrolls():void 0},playMidroll:function(e){this._adServer&&this._adServer.playMidroll(e)},playPostroll:function(){this._adServer&&this._adServer.playPostroll()},loadAds:function(e){this._adServer&&this._adServer.loadAds(e)},stop:function(){this._adServer&&this._adServer.stop()},dispose:function(){this._adServer&&(this._listen(!1),this._adServer.dispose(),this._adServer=null)},getCurrentAdId:function(){return this._adServer?this._adServer.getCurrentAdId():""},getCurrentAdDuration:function(){return this._adServer?this._adServer.getCurrentAdDuration():0},getCurrentAdType:function(){return this._adServer?this._adServer.getCurrentAdType():void 0},getAdAnalyticsData:function(){return this._adServer?this._adServer.getAdAnalyticsData():void 0},getAdAnalyticsDataForCurrentSlot:function(){return this._adServer?this._adServer.getAdAnalyticsDataForCurrentSlot():void 0},_onAdPlay:function(e){h.debug("_onAdPlay",e.adType),this.eAdPlay.dispatch(e)},_onAdPlayhead:function(e,t){this.eAdPlayhead.dispatch(e,t)},_onAdEnd:function(e){h.debug("_onAdEnd",e.adType),this.eAdEnd.dispatch(e)},_onAdError:function(e){h.debug("_onAdError",e.adType),this.eAdError.dispatch(e)},_onAdClick:function(e){h.debug("_onAdClick",e.adType,e.url),this.eAdClick.dispatch(e.url)},_onAdReady:function(){h.log("_onAdReady"),this.eAdReady.dispatch()},_onAdStopped:function(){h.log("_onAdStopped"),this.eAdStopped.dispatch()}});p.PREROLL=s.PREROLL,p.MIDROLL=s.MIDROLL,p.POSTROLL=s.POSTROLL,t.exports=p},{"../../cvp/customevent":18,"../../cvp/errors":27,"../../cvp/log":29,
"../../vendor/Class":96,"./adtypes":56,"./dfpimpl":58,"./freewheelimpl":59,"./videostates":60}],56:[function(e,t,n){t.exports={PREROLL:"preroll",MIDROLL:"midroll",POSTROLL:"postroll"}},{}],57:[function(e,t,n){var i=e("../../vendor/Class"),r=e("../../cvp/utils"),o=e("../../cvp/customevent"),s=e("../../cvp/log"),a=s.getLogger(),l=i.extend({init:function(e){this._adPolicy=e,this._keyValues={},this._adServerInfo=this._adPolicy.ads,this._adSection=this.getConfigProperty("adSection"),this.currentAdType="",this.currentAdId="",this.currentAdDuration=0,this.eAdPlayhead=new o,this.eAdPlay=new o,this.eAdEnd=new o,this.eAdError=new o,this.eAdClick=new o,this.eAdReady=new o,this.eAdStopped=new o},stop:function(){},dispose:function(){},setAdSection:function(e){this._adSection=e},getAdSection:function(){return this._adSection},setAdKeyValue:function(e,t){e&&(null===t?delete this._keyValues[e]:this._keyValues[e]=t)},getAdKeyValue:function(e){return this._keyValues[e]||void 0},getAdKeyValues:function(){return this._keyValues},clearAdKeyValues:function(){this._keyValues={}},setVideoState:function(e){this._videoState=e},getVideoState:function(){return this._videoState},getAdAnalyticsData:function(){},getAdAnalyticsDataForCurrentSlot:function(){},getMidrolls:function(){return{}},getConfigProperty:function(e){var t=null,n=!1;switch(e){case"adApi":t=this._adServerInfo.apiUrl,n=!0;break;case"adServerRootUrl":t=this._adServerInfo.adServerRootUrl,n=!0;break;case"adNetworkId":t=this._adServerInfo.adNetworkId,n=!0;break;case"adVideoNetworkId":t=this._adServerInfo.adVideoNetworkId,n=!0;break;case"adVideoAssetId":t=this._adServerInfo.adVideoAssetId,n=!0;break;case"adSection":t=this._adServerInfo.adSection,n=!0;break;case"adPlayerProfile":t=this._adServerInfo.adPlayerProfile,n=!0;break;case"renderersUrl":t=this._adServerInfo.renderersUrl,n=!1;break;case"sensitiveFallbackId":t=this._adServerInfo.sensitiveFallbackId,n=!1;break;case"adLiveContentDuration":t=this._adServerInfo.liveDuration,n=!1;break;case"keyValues":t=this._adServerInfo.keyValues,n=!1}return r.empty(t)&&(n?a.error("the following required ad server config value is missing:",e):a.warn("the following optional ad server config value is missing:",e)),t},getCurrentAdType:function(){return this.currentAdType},getCurrentAdId:function(){return this.currentAdId},getCurrentAdDuration:function(){return this.currentAdDuration},_emitAdPlay:function(e){var t=r.extend({ads:[],token:null,mode:"standard",id:this.getCurrentAdId(),duration:this.getCurrentAdDuration(),adType:this.getCurrentAdType(),adAnalyticsData:this.getAdAnalyticsDataForCurrentSlot()},e);this.eAdPlay.dispatch(t)},_emitAdEnd:function(e){var t=r.extend({token:null,mode:"standard",id:this.getCurrentAdId(),adType:this.getCurrentAdType()},e);this.eAdEnd.dispatch(t)},_emitAdError:function(e){var t=r.extend({id:this.getCurrentAdId(),adType:this.getCurrentAdType(),errors:[]},e);this.eAdError.dispatch(t)},_emitAdClick:function(e){var t=r.extend({id:this.getCurrentAdId(),adType:this.getCurrentAdType(),url:""},e);this.eAdClick.dispatch(t)}});t.exports=l},{"../../cvp/customevent":18,"../../cvp/log":29,"../../cvp/utils":52,"../../vendor/Class":96}],58:[function(e,t,n){var i=e("./baseimpl"),r=e("../../cvp/utils"),o=e("../../cvp/util/configutils"),s=e("../../cvp/errors"),a=e("../../cvp/log"),l=e("./adtypes"),c=s.ErrorMessage,u=a.getLogger("DFPImpl"),d=i.extend({init:function(){u.debug("Instantiating"),this._super.apply(this,arguments),this.enabled=!1,this._loader=new window.google.ima.AdsLoader,this._loader.addEventListener(window.google.ima.AdsLoadedEvent.Type.ADS_LOADED,r.bind(this._onAdsLoaded,this)),this._loader.addEventListener(window.google.ima.AdErrorEvent.Type.AD_ERROR,r.bind(this._onAdLoadError,this))},setVideoDisplayBase:function(e){u.debug("setVideoDisplayBase",e),r.undef(window.google)||r.undef(window.google.ima.AdsLoader)||(this.displayBase=e,this.enabled=!0,u.debug("setVideoDisplayBase","videoDisplayBase","enabling"))},loadAds:function(e){this._catalogEntry=e,this.playPreroll()},playPreroll:function(){var e=this._catalogEntry.getAdUrl("preroll"),t=this._constructAdUrl(e,this._catalogEntry);this.currentAdType=d.PREROLL,this.loadAds(t)},playPostroll:function(){var e=this._catalogEntry.getAdUrl("postroll"),t=this._constructAdUrl(e,this._catalogEntry);this.currentAdType=d.POSTROLL,this.loadAds(t)},_convertAdTypeFromImpl:function(e){switch(e){case d.PREROLL:return l.PREROLL;case d.POSTROLL:return l.POSTROLL}},getCurrentAdType:function(){return this._convertAdTypeFromImpl(this.currentAdType)},_loadAdUrl:function(e){u.debug("_loadAdUrl - adTag",e);var t={adTagUrl:e,adType:"video"};this._loader.requestAds(t)},_constructAdUrl:function(e,t){var n="",i=this.getConfigProperty("adServerRootUrl");n=r.empty(e)?i:r.isRelative(e)?this._addToTag(i,e):e;var s=this.getAdKeyValues();for(var a in s)if(r.hasOwn(s,a)){var l=a+"="+s[a];n=this._addToTag(n,l)}return n=o.stringReplace(n,t)},_addToTag:function(e,t){if(!e)return t;var n=";";return";"===e.charAt(e.length-1)&&(n=""),e+n+t},_onAdsLoaded:function(e){u.debug("_onAdsLoaded");var t=e.getAdsManager();t.addEventListener(window.google.ima.AdErrorEvent.Type.AD_ERROR,r.bind(this._onAdError,this)),t.addEventListener(window.google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,r.bind(this._onPauseRequested,this)),t.addEventListener(window.google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,r.bind(this._onResumeRequested,this));try{var n={restoreContentState:!1},i=document.getElementById(this.displayBase).getElementsByTagName("video")[0];t.play(i,n),this._emitAdPlay()}catch(o){u.error("ad play error",o.toString()),this._emitAdError({errorMessage:c.AD_EXISTS_BUT_FAILED,errors:[o.toString()]})}},_onAdLoadError:function(){u.debug("_onAdLoadError"),this._emitAdError({errorMessage:c.AD_EXISTS_BUT_FAILED,errors:event.errors})},_onPauseRequested:function(){u.debug("_onPauseRequested")},_onResumeRequested:function(){u.debug("_onResumeRequested"),this._emitAdEnd()},_onAdError:function(e){u.debug("_onAdError",e.toString()),this._emitAdError({errorMessage:c.AD_EXISTS_BUT_FAILED,errors:[e.toString()]})}});d.PREROLL="dfpPreroll",d.POSTROLL="dfpPostroll",t.exports=d},{"../../cvp/errors":27,"../../cvp/log":29,"../../cvp/util/configutils":45,"../../cvp/utils":52,"./adtypes":56,"./baseimpl":57}],59:[function(e,t,n){var i=e("./baseimpl"),r=e("../../cvp/utils"),o=e("../../cvp/util/configutils"),s=e("../../cvp/util/timing"),a=e("../../cvp/errors"),l=e("../../cvp/log"),c=e("./adtypes"),u=e("./videostates"),d=e("../extensions/ad-kvps"),h=a.ErrorMessage,p=l.getLogger("FreeWheelImpl"),f={READY:0,CREATING_NEW_CONTEXT:1,STOPPING_ADS:2},g=i.extend({init:function(){if(p.log("Instantiating"),this._super.apply(this,arguments),this._state=f.READY,this._freewheel=null,this.enabled=!1,r.isObject(window.tv)&&r.isObject(window.tv.freewheel)&&r.isObject(window.tv.freewheel.SDK)){g.initialized||(g.SDK=window.tv.freewheel.SDK,g.PREROLL=g.SDK.TIME_POSITION_CLASS_PREROLL,g.MIDROLL=g.SDK.TIME_POSITION_CLASS_MIDROLL,g.POSTROLL=g.SDK.TIME_POSITION_CLASS_POSTROLL,g.VIDEO_PLAYING=g.SDK.VIDEO_STATE_PLAYING,g.VIDEO_PAUSED=g.SDK.VIDEO_STATE_PAUSED,g.VIDEO_STOPPED=g.SDK.VIDEO_STATE_STOPPED,g.VIDEO_COMPLETED=g.SDK.VIDEO_STATE_COMPLETED,g.initialized=!0);var e=this.getConfigProperty("adNetworkId"),t=this.getConfigProperty("adServerRootUrl")+"/ad/g/1";this._freewheel=new g.SDK.AdManager,this._freewheel.setNetwork(e),this._freewheel.setServer(t)}this._keyValueConfigEvaluator=new d.AdKeyValueEvaluator(this.getConfigProperty("keyValues")),this._isListening=!1,this._adProgress=0,this._adTimer=null,this._adTimerDelay=1e3,this._ads={},this._ads[g.PREROLL]=[],this._ads[g.MIDROLL]=[],this._ads[g.POSTROLL]=[],this._onRequestComplete=r.bind(this._onRequestComplete,this),this._onSlotStarted=r.bind(this._onSlotStarted,this),this._onSlotEnded=r.bind(this._onSlotEnded,this),this._onPauseRequested=r.bind(this._onPauseRequested,this),this._onResumeRequested=r.bind(this._onResumeRequested,this),this._onAdStart=r.bind(this._onAdStart,this),this._onAdEnd=r.bind(this._onAdEnd,this),this._onAdClick=r.bind(this._onAdClick,this),this.setAdKeyValue("_fw_cvp_player","html5")},_createAdIncrementor:function(e){return r.bind(function(e){var t=e.getPlayheadTime();t!==this._adProgress&&(t>this.currentAdDuration||(this._adProgress=t,this.onAdPlayhead(this._adProgress,this.currentAdDuration)))},this,e)},_updateAdTimer:function(e){this._disposeAdTimer(),this._adTimer=s.periodically(this._createAdIncrementor(e),this._adTimerDelay),this._adTimer.start()},_disposeAdTimer:function(){null!==this._adTimer&&(this._adTimer.stop(),this._adTimer=null)},setVideoDisplayBase:function(e){g.initialized&&(this.displayBase=e,this.enabled=!0)},_purgeLoadedAds:function(){this._ads[g.PREROLL].length=0,this._ads[g.MIDROLL].length=0,this._ads[g.POSTROLL].length=0},_fireAdStopped:function(){p.log("_fireAdStopped"),this.eAdStopped.dispatch()},_handleAdReset:function(){switch(this._state){case f.CREATING_NEW_CONTEXT:this._createNewContext();break;case f.STOPPING_ADS:this._fireAdStopped();break;default:p.debug("_handleAdReset","unknown or unexpected state '"+this._state+"'!")}this._state=f.READY},_disposeCurrentContext:function(){p.log("_disposeCurrentContext"),this._listen(!1),this._fwContext.dispose(),this._fwContext=null,this._handleAdReset()},_reset:function(){p.log("_reset"),this._disposeAdTimer(),this._purgeLoadedAds(),this.currentAdType=g.PREROLL,this._fwContext?this._currentSlot?this._currentSlot.stop():this._disposeCurrentContext():this._handleAdReset()},_createNewContext:function(){p.log("_createNewContext");var e=this._catalogEntry;if(e.isAdSensitive())return p.log("catalogEntry specified 'isAdSensitive'; skipping ad context creation."),void this._adError(h.AD_SKIPPED_DUE_TO_SENSITIVITY);var t=this.getConfigProperty("adNetworkId"),n=e.getTrt(),i=r.empty(this._adServerInfo.adVideoAssetId)?e.getId():o.stringReplace(this._adServerInfo.adVideoAssetId,e,!1);this._fwContext=this._freewheel.newContext(),this._fwContext.setProfile(t+":turner_html5"),this._fwContext.setVideoAsset(i,n),this._fwContext.setSiteSection(this._adSection),this._fwContext.registerVideoDisplayBase(this.displayBase);var s,a=this._keyValueConfigEvaluator.evaluate(e),l=this.getAdKeyValues(),c=r.extend({},a,l);for(var u in c)r.hasOwn(c,u)&&(s=c[u],r.isNull(s)?p.debug("Ignoring key '"+u+"' because value was null (ad blocker?)"):(p.log("Setting key/value pair: "+u+" | "+s),this._fwContext.addKeyValue(u,String(s))));this._listen(!0),this._fwContext.submitRequest()},_listen:function(e){var t=this._fwContext;if(t&&this._isListening!==e){this._isListening=e;var n=e?t.addEventListener:t.removeEventListener;n.call(t,g.SDK.EVENT_REQUEST_COMPLETE,this._onRequestComplete),n.call(t,g.SDK.EVENT_SLOT_STARTED,this._onSlotStarted),n.call(t,g.SDK.EVENT_SLOT_ENDED,this._onSlotEnded),n.call(t,g.SDK.EVENT_CONTENT_VIDEO_PAUSE_REQUESTED,this._onContentPauseRequested),n.call(t,g.SDK.EVENT_CONTENT_VIDEO_RESUME_REQUESTED,this._onContentResumeRequested),n.call(t,g.SDK.EVENT_AD_IMPRESSION,this._onAdStart),n.call(t,g.SDK.EVENT_AD_IMPRESSION_END,this._onAdEnd),n.call(t,g.SDK.EVENT_AD_CLICK,this._onAdClick),n.call(t,g.SDK.EVENT_ERROR,this._onAdError)}},loadAds:function(e){p.log("loadAds"),this._catalogEntry=e,this._state=f.CREATING_NEW_CONTEXT,this._reset()},stop:function(){p.log("stop"),this._state=f.STOPPING_ADS,this._reset()},dispose:function(){p.log("dispose"),this.stop(),this._freewheel=null},_onRequestComplete:function(e){if(p.log("_onRequestComplete",e),e&&e.success)for(var t=e.target.getTemporalSlots(),n=0,i=t.length;i>n;++n){var r=t[n],o=r.getTimePositionClass();switch(o){case g.PREROLL:case g.MIDROLL:case g.POSTROLL:this._ads[o].push(r)}}else p.debug("_onRequestComplete","No ad event or ad request was unsuccessful.");this._createMidrollsData(),this.eAdReady.dispatch(),this.playPreroll()},_createMidrollsData:function(){var e={},t=this._ads[g.MIDROLL];r.each(t,function(t,n){var i=t.getTimePosition();i>=0&&(e[i]=n)}),this._midrolls=e},getMidrolls:function(){return r.extend({},this._midrolls)},_onSlotStarted:function(e){p.log("_onSlotStarted",e.type,e.target,e.slot)},_playSlot:function(e){this._currentSlot=e,this._currentSlot.play()},_continuePlayingSlots:function(e){var t=this._ads[e];return t&&t.length&&(t.shift(),t.length)?(this._playSlot(t[0]),!0):!1},_onSlotEnded:function(e){if(p.log("_onSlotEnded",e.type,e.target,e.slot),this._currentSlot=null,this._state!==f.READY)return p.log("_onSlotEnded","short-circuit because state is "+this._state),void this._disposeCurrentContext();var t=e.slot.getTimePositionClass();switch(t){case g.PREROLL:this._continuePlayingSlots(t)||this.onPrerollCompleted();break;case g.MIDROLL:this.onMidrollCompleted();break;case g.POSTROLL:this._continuePlayingSlots(t)||this.onPostrollCompleted()}},_onContentPauseRequested:function(e){p.log("_onContentPauseRequested",e.type,e.target,e.success)},_onContentResumeRequested:function(e){p.log("_onContentResumeRequested",e.type,e.target,e.slot)},_onAdStart:function(e){p.log("_onAdStart",e.type,e.target,e.adInstance)},_onAdEnd:function(e){p.log("_onAdEnd",e.type,e.target,e.adInstance)},_onAdClick:function(e){p.log("_onAdClick",e);var t=e.adInstance;if(t){var n=t.getEventCallbackUrls(g.SDK.EVENT_AD_CLICK,g.SDK.EVENT_TYPE_CLICK);p.log("_onAdClick","callbackUrls:",n),n&&n.length&&this._emitAdClick({url:n[0]})}},_onAdError:function(e){return p.debug("_onAdError",e),r.isObject(e)?void this._emitAdError({errorMessage:h.AD_EXISTS_BUT_FAILED,errors:e.errors}):void p.warn("_onAdError did not receive an object; cannot report an error")},playPreroll:function(){p.log("playPreroll"),this.currentAdType=g.PREROLL,this._adPlay(g.PREROLL)},onPrerollCompleted:function(){p.log("onPrerollCompleted"),this._adEnd()},playMidroll:function(e){p.log("playMidroll"),this.currentAdType=g.MIDROLL,this._adPlay(g.MIDROLL,e)},onMidrollCompleted:function(){p.log("onMidrollCompleted"),this._adEnd()},playPostroll:function(){p.log("playPostroll"),this.currentAdType=g.POSTROLL,this._adPlay(g.POSTROLL)},onPostrollCompleted:function(){p.log("onPostrollCompleted"),this._adEnd()},_adPlay:function(e,t){t=t||0,p.log("_adPlay",e);var n=this._catalogEntry;if(n.isAdSensitive())return p.debug("catalogEntry specified 'isAdSensitive'; skipping ad play."),void this._adError(h.AD_SKIPPED_DUE_TO_SENSITIVITY);var i=this._ads[e];if(!i.length)return p.debug("no slots provided for the ad type: "+e),void this._adError(h.AD_TYPE_NOT_TRAFFICKED);if(0>t||i.length<=t)return p.debug("no slot at index '"+t+"' provided for the ad type: "+e),void this._adError(h.NO_AD_PLAYED_AT_AD_SPOT);var r=i[t];return r&&0!==r.getAdCount()&&0!==r.getTotalDuration()?(this._currentSlot=r,this.currentAdId=r.getCustomId(),this.currentAdDuration=Number(r.getTotalDuration()),this._adProgress=0,this._updateAdTimer(r),this._emitAdPlay(),void this._playSlot(r)):(p.debug("no ad provided for the slot for ad type: "+e),void this._adError(h.NO_AD_PLAYED_AT_AD_SPOT))},_adEnd:function(){p.log("_adEnd"),this._emitAdEnd(),this._cleanup()},_adError:function(e){p.debug("_adError",e),this._emitAdError({errorMessage:e}),this._cleanup()},_cleanup:function(){this._disposeAdTimer(),this.currentAdId=""},onAdPlayhead:function(e,t){this.eAdPlayhead.dispatch(e,t)},_convertAdTypeFromImpl:function(e){switch(e){case g.PREROLL:return c.PREROLL;case g.MIDROLL:return c.MIDROLL;case g.POSTROLL:return c.POSTROLL}},getCurrentAdType:function(){return this._convertAdTypeFromImpl(this.currentAdType)},_convertVideoStateToImpl:function(e){switch(e){case u.PLAYING:return g.VIDEO_PLAYING;case u.PAUSED:return g.VIDEO_PAUSED;case u.STOPPED:return g.VIDEO_STOPPED;case u.COMPLETED:return g.VIDEO_COMPLETED}},setVideoState:function(e){if(this._super(e),this._fwContext){var t=this._convertVideoStateToImpl(e);t&&this._fwContext.setVideoState(t)}},getAdAnalyticsData:function(){var e={};if(!this._fwContext)return e;var t=this._fwContext.getTemporalSlots();return r.each(t,function(t,n){var i="temporal_"+n;e[i]=this._getDataForSlot(t)},this),e},_getDataForSlot:function(e){return{slotId:e.getCustomId(),adType:this._convertAdTypeFromImpl(e.getTimePositionClass()),position:e.getTimePosition(),category:e.getType(),duration:e.getTotalDuration(),adCount:e.getAdCount(),adInstances:this._getAdAnalyticsForSlot(e)}},getAdAnalyticsDataForCurrentSlot:function(){return this._currentSlot?{adInstances:this._getAdAnalyticsForSlot(this._currentSlot)}:void 0},_getAdAnalyticsForSlot:function(e){var t=e.getAdInstances();return r.map(t,this._getDataForAdInstance,this)},_getDataForAdInstance:function(e){var t={adId:e.getAdId()},n=e.getEventCallbackUrls(g.SDK.EVENT_AD_CLICK,g.SDK.EVENT_TYPE_CLICK);t.clickUrl=n.length?n[0]:"";var i=e.getActiveCreativeRendition();if(i&&r.isFunc(i.getPrimaryCreativeRenditionAsset)){var o=i.getPrimaryCreativeRenditionAsset();o&&(t.assetUrl=o.getUrl(),t.contentType=o.getContentType())}return t}});g.PREROLL=null,g.MIDROLL=null,g.POSTROLL=null,t.exports=g},{"../../cvp/errors":27,"../../cvp/log":29,"../../cvp/util/configutils":45,"../../cvp/util/timing":50,"../../cvp/utils":52,"../extensions/ad-kvps":73,"./adtypes":56,"./baseimpl":57,"./videostates":60}],60:[function(e,t,n){t.exports={PLAYING:"PLAYING",PAUSED:"PAUSED",STOPPED:"STOPPED",COMPLETED:"COMPLETED"}},{}],61:[function(e,t,n){var i=e("../vendor/Class"),r=e("../cvp/customevent"),o=e("./manager"),s=e("../cvp/utils"),a=i.extend({init:function(e){this._manager=new o,this.ePlayerLoaded=new r,this.ePlayerLoadError=new r,this.ePlayerReady=new r,this.eContentMetadata=new r,this.eContentBegin=new r,this.eContentPlay=new r,this.eContentPause=new r,this.eContentEnd=new r,this.eContentComplete=new r,this.eContentPlayhead=new r,this.eContentBuffering=new r,this.eContentQueue=new r,this.eContentQueueAutoplay=new r,this.eContentVolume=new r,this.eContentError=new r,this.eContentResize=new r,this.eContentEntryLoad=new r,this.eContentEntryLoadError=new r,this.eAdPlayhead=new r,this.eAdPlay=new r,this.eAdEnd=new r,this.eAdError=new r,this.eAdSensitive=new r,this.eTrackingAdStart=new r,this.eTrackingAdComplete=new r,this.eTrackingAdProgress=new r,this.eTrackingAdCountdown=new r,this.eTrackingAdClick=new r,this.eTrackingContentPlay=new r,this.eTrackingContentBegin=new r,this.eTrackingContentProgress=new r,this.eTrackingContentComplete=new r,this.eTrackingContentReplay=new r,this.eTrackingContentSeek=new r,this.eTrackingContentSeekEnd=new r,this.eTrackingFullscreen=new r,this.eTrackingMuted=new r,this.eTrackingPaused=new r,this._isListening=!1,this.listen(!0),this._manager.load(e)},listen:function(e){if(this._isListening!==e){this._isListening=e;var t=e?"addListener":"removeListener";this._manager.ePlayerLoaded[t](this._onPlayerLoaded,this),this._manager.ePlayerLoadError[t](this._onPlayerLoadError,this),this._manager.ePlayerRendered[t](this._onPlayerRendered,this),this._manager.eContentMetadata[t](this._onContentMetadata,this),this._manager.eContentBegin[t](this._onContentBegin,this),this._manager.eContentPlay[t](this._onContentPlay,this),this._manager.eContentPause[t](this._onContentPause,this),this._manager.eContentEnd[t](this._onContentEnd,this),this._manager.eContentComplete[t](this._onContentComplete,this),this._manager.eContentPlayhead[t](this._onContentPlayhead,this),this._manager.eContentBuffering[t](this._onContentBuffering,this),this._manager.eContentQueue[t](this._onContentQueue,this),this._manager.eContentQueueAutoplay[t](this._onContentQueueAutoplay,this),this._manager.eContentVolume[t](this._onContentVolume,this),this._manager.eContentError[t](this._onContentError,this),this._manager.eContentResize[t](this._onContentResize,this),this._manager.eContentEntryLoad[t](this._onContentEntryLoad,this),this._manager.eContentEntryLoadError[t](this._onContentEntryLoadError,this),this._manager.eAdPlayhead[t](this._onAdPlayhead,this),this._manager.eAdPlay[t](this._onAdPlay,this),this._manager.eAdEnd[t](this._onAdEnd,this),this._manager.eAdError[t](this._onAdError,this),this._manager.eAdSensitive[t](this._onAdSensitive,this),this._manager.eTrackingAdStart[t](this._onTrackingAdStart,this),this._manager.eTrackingAdComplete[t](this._onTrackingAdComplete,this),this._manager.eTrackingAdProgress[t](this._onTrackingAdProgress,this),this._manager.eTrackingAdCountdown[t](this._onTrackingAdCountdown,this),this._manager.eTrackingAdClick[t](this._onTrackingAdClick,this),this._manager.eTrackingContentPlay[t](this._onTrackingContentPlay,this),this._manager.eTrackingContentBegin[t](this._onTrackingContentBegin,this),this._manager.eTrackingContentProgress[t](this._onTrackingContentProgress,this),this._manager.eTrackingContentComplete[t](this._onTrackingContentComplete,this),this._manager.eTrackingContentReplay[t](this._onTrackingContentReplay,this),this._manager.eTrackingContentSeek[t](this._onTrackingContentSeek,this),this._manager.eTrackingContentSeekEnd[t](this._onTrackingContentSeekEnd,this),this._manager.eTrackingFullscreen[t](this._onTrackingFullscreen,this),this._manager.eTrackingMuted[t](this._onTrackingMuted,this),this._manager.eTrackingPaused[t](this._onTrackingPaused,this)}},render:function(e){this._manager.render(e)},remove:function(){this._manager.remove()},dispose:function(){this.listen(!1),this._manager.dispose(),this._manager=null},getDefaultPlayer:function(){return this._manager.getCurrentPlayer()},play:function(e,t){this._manager.playContentWithId(e,t)},playFromObject:function(e,t){this._manager.playFromObject(e,t)},replay:function(){this._manager.replay()},playNextInQueue:function(){this._manager.playNextInQueue()},pause:function(){this._manager.pause()},resume:function(){this._manager.resume()},stop:function(){this._manager.stop()},queue:function(e,t,n){this._manager.queueContentWithId(e,t,n)},queueFromObject:function(e,t,n){this._manager.queueFromObject(e,t,n)},dequeue:function(e){this._manager.dequeueContentWithId(e)},emptyQueue:function(){this._manager.emptyQueue()},setQueueAutoplay:function(e){this._manager.setQueueAutoplay(e)},getQueue:function(){return this._manager.getQueue()},seek:function(e){this._manager.seek(e)},resize:function(e,t){this._manager.resize(e,t)},goFullscreen:function(){this._manager.goFullscreen()},setVolume:function(e){this._manager.setVolume(e)},getVolume:function(){return this._manager.getVolume()},mute:function(){this._manager.mute()},unmute:function(){this._manager.unmute()},isMuted:function(){return this._manager.isMuted()},getContentEntry:function(e){return this._manager.getContentEntry(e)},setAdSection:function(e){this._manager.setAdSection(e)},setAdKeyValue:function(e,t){this._manager.setAdKeyValue(e,t)},getAdKeyValues:function(){return this._manager.getAdKeyValues()},clearAdKeyValues:function(){this._manager.clearAdKeyValues()},setTrackingInterval:function(e){this._manager.setTrackingInterval(e)},setDataSrc:function(e){this._manager.setDataSrc(e)},switchAdContext:function(e,t){this._manager.switchAdContext(e,t)},switchTrackingContext:function(e,t){this._manager.switchTrackingContext(e,t)},reportAnalytics:function(e,t){this._manager.reportAnalytics(e,t)},_mungeArgs:function(e){var t=s.slice(e);return t.unshift(this.getDefaultPlayer()),t},_onPlayerLoaded:function(){this.ePlayerLoaded.dispatch()},_onPlayerLoadError:function(){this.ePlayerLoadError.dispatch()},_onPlayerRendered:function(){this.ePlayerReady.dispatch.apply(this.ePlayerReady,this._mungeArgs(arguments))},_onContentMetadata:function(){this.eContentMetadata.dispatch.apply(this.eContentMetadata,this._mungeArgs(arguments))},_onContentBegin:function(){this.eContentBegin.dispatch.apply(this.eContentBegin,this._mungeArgs(arguments))},_onContentPlay:function(){this.eContentPlay.dispatch.apply(this.eContentPlay,this._mungeArgs(arguments))},_onContentPause:function(){this.eContentPause.dispatch.apply(this.eContentPause,this._mungeArgs(arguments))},_onContentEnd:function(){this.eContentEnd.dispatch.apply(this.eContentEnd,this._mungeArgs(arguments))},_onContentComplete:function(){this.eContentComplete.dispatch.apply(this.eContentComplete,this._mungeArgs(arguments))},_onContentPlayhead:function(){this.eContentPlayhead.dispatch.apply(this.eContentPlayhead,this._mungeArgs(arguments))},_onContentBuffering:function(){this.eContentBuffering.dispatch.apply(this.eContentBuffering,this._mungeArgs(arguments))},_onContentQueue:function(){this.eContentQueue.dispatch.apply(this.eContentQueue,this._mungeArgs(arguments))},_onContentQueueAutoplay:function(){this.eContentQueueAutoplay.dispatch.apply(this.eContentQueueAutoplay,this._mungeArgs(arguments))},_onContentVolume:function(){this.eContentVolume.dispatch.apply(this.eContentVolume,this._mungeArgs(arguments))},_onContentError:function(){this.eContentError.dispatch.apply(this.eContentError,this._mungeArgs(arguments))},_onContentResize:function(){this.eContentResize.dispatch.apply(this.eContentResize,this._mungeArgs(arguments))},_onContentEntryLoad:function(){this.eContentEntryLoad.dispatch.apply(this.eContentEntryLoad,this._mungeArgs(arguments))},_onContentEntryLoadError:function(){this.eContentEntryLoadError.dispatch.apply(this.eContentEntryLoadError,this._mungeArgs(arguments))},_onAdPlayhead:function(){this.eAdPlayhead.dispatch.apply(this.eAdPlayhead,this._mungeArgs(arguments))},_onAdPlay:function(){this.eAdPlay.dispatch.apply(this.eAdPlay,this._mungeArgs(arguments))},_onAdEnd:function(){this.eAdEnd.dispatch.apply(this.eAdEnd,this._mungeArgs(arguments))},_onAdError:function(){this.eAdError.dispatch.apply(this.eAdError,this._mungeArgs(arguments))},_onAdSensitive:function(){this.eAdSensitive.dispatch.apply(this.eAdSensitive,this._mungeArgs(arguments))},_onTrackingAdStart:function(){this.eTrackingAdStart.dispatch.apply(this.eTrackingAdStart,this._mungeArgs(arguments))},_onTrackingAdComplete:function(){this.eTrackingAdComplete.dispatch.apply(this.eTrackingAdComplete,this._mungeArgs(arguments))},_onTrackingAdProgress:function(){this.eTrackingAdProgress.dispatch.apply(this.eTrackingAdProgress,this._mungeArgs(arguments))},_onTrackingAdCountdown:function(){this.eTrackingAdCountdown.dispatch.apply(this.eTrackingAdCountdown,this._mungeArgs(arguments))},_onTrackingAdClick:function(){this.eTrackingAdClick.dispatch.apply(this.eTrackingAdClick,this._mungeArgs(arguments))},_onTrackingContentPlay:function(){this.eTrackingContentPlay.dispatch.apply(this.eTrackingContentPlay,this._mungeArgs(arguments))},_onTrackingContentBegin:function(){this.eTrackingContentBegin.dispatch.apply(this.eTrackingContentBegin,this._mungeArgs(arguments))},_onTrackingContentProgress:function(){this.eTrackingContentProgress.dispatch.apply(this.eTrackingContentProgress,this._mungeArgs(arguments))},_onTrackingContentComplete:function(){this.eTrackingContentComplete.dispatch.apply(this.eTrackingContentComplete,this._mungeArgs(arguments))},_onTrackingContentReplay:function(){this.eTrackingContentReplay.dispatch.apply(this.eTrackingContentReplay,this._mungeArgs(arguments))},_onTrackingContentSeek:function(){this.eTrackingContentSeek.dispatch.apply(this.eTrackingContentSeek,this._mungeArgs(arguments))},_onTrackingContentSeekEnd:function(){this.eTrackingContentSeekEnd.dispatch.apply(this.eTrackingContentSeekEnd,this._mungeArgs(arguments))},_onTrackingFullscreen:function(){this.eTrackingFullscreen.dispatch.apply(this.eTrackingFullscreen,this._mungeArgs(arguments))},_onTrackingMuted:function(){this.eTrackingMuted.dispatch.apply(this.eTrackingMuted,this._mungeArgs(arguments))},_onTrackingPaused:function(){this.eTrackingPaused.dispatch.apply(this.eTrackingPaused,this._mungeArgs(arguments))}});t.exports=a},{"../cvp/customevent":18,"../cvp/utils":52,"../vendor/Class":96,"./manager":75}],62:[function(e,t,n){function i(e,t){p("AspenController - send",arguments),l.send(e,t)}function r(){p("AspenController - setup"),l.eInitSuccess.removeListener(r,this),h=!0,p("AspenController - setup","dispatching init success event"),this.eInitSuccess.dispatch()}function o(e){p("AspenController - init",arguments),d||(d=!0,l.eInitSuccess.addListener(r,this),l.init(e))}function s(){return h}function a(e){if(!d)throw new Error("AspenController - getConfig cannot be called until after AspenController has successfully inited!");if(!h)throw new Error("AspenController - getConfig cannot be called until after Aspen has successfully inited!");return p("AspenController - getConfig",e),l.getConfig(e)}var l=e("../aspen/aspen"),c=e("../cvp/customevent"),u=e("../cvp/log"),d=!1,h=!1,p=u.getLogger().log;t.exports={videoCount:0,eInitSuccess:new c,isReady:s,getConfig:a,send:i,init:o}},{"../aspen/aspen":1,"../cvp/customevent":18,"../cvp/log":29}],63:[function(e,t,n){var i=e("../vendor/Class"),r=e("../cvp/customevent"),o=e("../cvp/util/dependencymanager"),s=e("./dependencies/mapping"),a=e("./dependencies/appconfig"),l=e("./dependencies/container"),c=e("./dependencies/config"),u=e("./dependencies/adpolicy"),d=e("./dependencies/trackingpolicy"),h=e("../cvp/utils"),p=e("./shared/playerconfig"),f=e("./overwritemanager"),g=e("../cvp/log"),m=g.getLogger("BootStrapper"),_=o.extend({setBootstrapper:function(e){this._bootstrap=e},clearBootstrapper:function(){this._bootstrap=null},setParams:function(e){this._params=e},getParams:function(){return this._params}}),v=i.extend({init:function(e,t){this._mappingUrl=e,this._params=t||{},this.eSuccess=new r,this.eFailure=new r},load:function(){this._bootManager=new _,this._bootManager.setBootstrapper(this),this._bootManager.setParams(this._params);var e=new s(this._mappingUrl,!0);e.setContext(this._params.profile),this._bootManager.addDependency(e),this._bootManager.eDependencySuccess.addListener(this._onDependencySuccess,this),this._bootManager.eSuccess.addListener(this._success,this),this._bootManager.eFailure.addListener(this._failure,this),this._bootManager.load()},_onDependencySuccess:function(e,t){e instanceof s?this._mapping=t:e instanceof a?this._appConfig=t:e instanceof l?this._containerInfo=t:e instanceof c?this._configInfo=t:e instanceof u?this._adPolicy=t:e instanceof d&&(this._trackingPolicy=t)},_success:function(){var e={};e.mapping=h.extend({},p.mapping,this._mapping),e.appConfig=h.extend({},p.appConfig,this._appConfig),e.containerInfo=h.extend({},p.containerInfo,this._containerInfo),e.configInfo=h.extend({},p.configInfo,this._configInfo),e.adPolicy=h.extend({},p.adPolicy,this._adPolicy),e.trackingPolicy=h.extend({},p.trackingPolicy,this._trackingPolicy),new f(this._params.flashVars).overwrite(e),m.debug("overwritten data: ",e);var t={data:e};this.eSuccess.dispatch(t),this._complete()},_failure:function(){this.eFailure.dispatch(),this._complete()},_complete:function(){this._bootManager&&(this._bootManager.eDependencySuccess.removeListener(this._onDependencySuccess,this),this._bootManager.eSuccess.removeListener(this._success,this),this._bootManager.eFailure.removeListener(this._failure,this),this._bootManager.clearBootstrapper(),this._bootManager=null)}});t.exports=v},{"../cvp/customevent":18,"../cvp/log":29,"../cvp/util/dependencymanager":47,"../cvp/utils":52,"../vendor/Class":96,"./dependencies/adpolicy":66,"./dependencies/appconfig":67,"./dependencies/config":68,"./dependencies/container":69,"./dependencies/mapping":70,"./dependencies/trackingpolicy":71,"./overwritemanager":76,"./shared/playerconfig":93}],64:[function(e,t,n){var i=e("../core/app"),r=e("../vendor/Class"),o=e("../cvp/customevent"),s=e("./contententry"),a=e("./fakecontententry"),l=e("./expiredcontententry"),c=e("../cvp/request"),u=e("../cvp/utils"),d=r.extend({init:function(){this._catalogDataURL="",this._mediaUrl="",this._requestPendingQueue=[],this._requestInProgress=!1,this._videoCatalog=[],this._objectMap={},this._onContentIdRequestComplete=u.bind(this._onContentIdRequestComplete,this),this._onContentIdRequestIOError=u.bind(this._onContentIdRequestIOError,this),this._requestCleanup=u.bind(this._requestCleanup,this),this.eRequestCompleted=new o("CmsRequestCompletedEvent")},addContentId:function(e){var t=this.getContentId(e);if(u.isNull(t))this._requestPendingQueue.push(e);else{var n=e.split("|")[1];e=e.split("|")[0],this._notifyListeners(e,e,n,"","");
}this._processNextRequest()},addContentObject:function(e,t){var n=e.split("|"),r=n[0],o=new a(t),s=this._videoCatalog.length;o&&o.hasFiles()?(this._objectMap[e]=o,this._requestPendingQueue.push(e)):this._notifyListeners(r,r,s,"Invalid data",i.ERROR_CMS_PARSE),this._processNextRequest()},getContentId:function(e){e=e.split("|")[0];for(var t,n=0,i=this._videoCatalog.length;i>n;++n)if(t=this._videoCatalog[n],t.getId()===e)return t;return null},setDataUrl:function(e){this._catalogDataURL=e},setMediaUrl:function(e){this._mediaUrl=e},_getRequestUrl:function(e){var t,n=this._catalogDataURL.substr(0).search(/\$\{/);if(-1!==n){var i=this._catalogDataURL.substr(n).search(/\}/);if(-1!==i){var r=this._catalogDataURL.substr(n,i+1);t=this._catalogDataURL.replace(r,e)}}else t=this._catalogDataURL+"/"+e+".xml";return t},_createContentEntryFromRequestData:function(e,t){try{var n=new s(e);return n.setMediaUrl(this._mediaUrl),n}catch(i){alert(this._getRequestUrl(t)+": "+i.message)}return null},_processNextRequest:function(){if(!this._requestInProgress&&this._requestPendingQueue.length){var e=this._requestPendingQueue[0];if(e in this._objectMap)this._processVideoFromObject(e);else{var t=e.split("|")[0];this._requestVideoWithId(t)}}},_requestVideoWithId:function(e){var t=this._getRequestUrl(e),n=c.getXML({url:t});this._requestInProgress=!0,n.then(this._onContentIdRequestComplete,this._onContentIdRequestIOError).ensure(this._requestCleanup)},_requestCleanup:function(){this._requestInProgress=!1,this._requestPendingQueue.shift(),this._processNextRequest()},_onContentIdRequestComplete:function(e){var t=this._requestPendingQueue[0].split("|"),n=t[0],r=t[1];if(!e)return void this._notifyListeners(n,n,r,"No data",i.ERROR_CMS_PARSE);var o=this._createContentEntryFromRequestData(e,n);return o&&o.hasFiles()?(o.isExpired()&&(o=new l),o.requestId=n,this._videoCatalog.push(o),void this._notifyListeners(o.getId(),o.requestId,r,"","")):void this._notifyListeners(n,n,r,"Invalid data",i.ERROR_CMS_PARSE)},_onContentIdRequestIOError:function(e){var t=this._requestPendingQueue[0].split("|"),n=t[0],r=t[1];this._notifyListeners(n,n,r,"IOError : "+e,i.ERROR_CMS_IO)},_processVideoFromObject:function(e){var t=this._objectMap[e],n=e.split("|"),i=n[0],r=n[1];t.requestId=i,t.setMediaUrl(this._mediaUrl),this._videoCatalog.push(t),this._notifyListeners(i,t.requestId,r,"",""),this._requestCleanup()},_notifyListeners:function(e,t,n,i,r){this.eRequestCompleted.dispatch(e,t,n,i,r)}});t.exports=d},{"../core/app":10,"../cvp/customevent":18,"../cvp/request":37,"../cvp/utils":52,"../vendor/Class":96,"./contententry":65,"./expiredcontententry":72,"./fakecontententry":74}],65:[function(e,t,n){var i=e("../vendor/Class"),r=e("../cvp/utils"),o=e("../cvp/util/xml"),s=e("../cvp/log"),a=s.getLogger(),l=["flv"],c=/[,\s]+/,u=i.extend({init:function(e){var t,n,i,s,u,d,h,p,f,g,m,_,v,y,C,w,b,E,A,T;if(this._xmlEntry=e.documentElement,this._requestId=null,this._mediaUrl="",this._name=o.getNodeValue(this._xmlEntry,"slug"),this._title=o.getNodeValue(this._xmlEntry,"headline"),this._category=o.getNodeValue(this._xmlEntry,"category"),this._trt=+o.getNodeValue(this._xmlEntry,"trt"),this._captionsList=[],t=this._xmlEntry.getElementsByTagName("files"),t.length){for(t=o.getChildElements(t[0]),this._fileList={},d=0,h=t.length;h>d;++d)if(n=t[d],"file"===n.nodeName)if(i=o.getAttribute(n,"key")||o.getAttribute(n,"bitrate"),s=o.getAttribute(n,"fallback"),u=o.getNodeValue(n))if(p="",T=r.parseUrl(this.sanitizeUrl(u)),T&&(C=T.file.lastIndexOf("."),-1!==C&&(p=T.file.substring(C+1))),a.debug("ContentCatalogEntry",i,u,p),-1===r.indexOf(l,p)){if(i in this._fileList){var S=this._fileList[i].url;a.warn("The file key/bitrate '"+i+"' already exists with URL '"+S+"' and is now being overwritten with "+(S===u?"the same URL":"URL '"+u+"'")+".")}this._fileList[i]={url:u,fallback:s,ext:p}}else a.info("Ignoring "+u+" because extention '"+p+"' is unsupported.");else a.info("Ignoring file key/bitrate '"+i+"' because it has no text() -- no URL!")}else a.warn("ContentCatalogEntry","No file entries found!");if(f=this._xmlEntry.getElementsByTagName("images"),f.length)for(f=o.getChildElements(f[0]),this._imageList={},d=0,h=f.length;h>d;++d)g=f[d],m=o.getAttribute(g,"width"),_=o.getAttribute(g,"height"),y=o.getNodeValue(g),a.debug("ContentCatalogEntry","images",m,_,y),v=m+"|"+_,this._imageList[v]={url:y,width:m,height:_};if(w=this._xmlEntry.getElementsByTagName("ads"),w.length)for(w=o.getChildElements(w[0]),this._adList={},d=0,h=w.length;h>d;++d)b=w[d],E=o.getAttribute(b,"type"),A=o.getNodeValue(b),a.debug("ContentCatalogEntry","ad",E,A),this._adList[E]={url:A};var k=this._xmlEntry.getElementsByTagName("closedCaptions")[0]||null;if(k){var P=r.isFlagActive(o.getAttribute(k,"enabled"),!1);if(P){var x=r.filter(r.slice(k.getElementsByTagName("source")),function(e){var t=o.getAttribute(e,"type")||"",n=o.getAttribute(e,"format")||"",i=(o.getAttribute(e,"platform")||"").split(c);return"external"===t&&"webvtt"===n&&-1!==i.indexOf("html5")});r.each(x,function(e){this._captionsList.push.apply(this._captionsList,r.map(r.slice(e.getElementsByTagName("track")),function(e){return{lang:o.getAttribute(e,"lang")||"",label:o.getAttribute(e,"label")||"",channel:o.getAttribute(e,"channel")||"",url:o.getAttribute(e,"url")||""}}))},this),a.debug("ContentCatalogEntry","captions",this._captionsList)}}},hasFiles:function(){return!r.empty(this._fileList)},setMediaUrl:function(e){this._mediaUrl=e},getMediaUrl:function(){return this._mediaUrl},getId:function(){var e=o.getAttribute(this._xmlEntry,"id");return r.empty(e)?this._requestId:e},getName:function(){return this._name},getTitle:function(){return this._title},getCategory:function(){return this._category},getTrt:function(){return this._trt},isExpired:function(){var e=o.getNodeValue(this._xmlEntry,"isExpired");return r.isFlagActive(e,!1)},isAdSensitive:function(){var e=o.getNodeValue(this._xmlEntry,"isAdSensitive");return r.isFlagActive(e,!1)},getSource:function(){var e=o.getAttribute(this._xmlEntry,"source");return e||void 0},getOriginId:function(){var e=o.getAttribute(this._xmlEntry,"originId");return e||void 0},getMode:function(){var e=o.getAttribute(this._xmlEntry,"isLive");return r.empty(e)?"vod":"live"},isLive:function(){return"live"===this.getMode()},sanitizeUrl:function(e){return e?(r.isRelative(e)&&(e=this._mediaUrl+e),this.token&&r.augmentQueryString(e,{hdnea:this.token}),e):e},getAllFiles:function(){var e={};return r.each(this._fileList,function(t,n){e[t]=r.extend({},n)}),e},getContentUrl:function(e){var t,n=null,i=!1;for(t in this._fileList)if(t===e){n=this.sanitizeUrl(this._fileList[t].url),i=!0;break}return i?r.empty(n)&&a.warn("text attribute is empty in the video XML for the <file> node whose quality is '"+e+"'."):a.warn("Config XML specifies a '"+e+"' bitrate entry, but there is no <file> node in video XML where bitrate attribute is '"+e+"'."),n},getContentUrlsForExtension:function(e){var t=[];return r.each(this._fileList,function(n,i){i.ext===e&&t.push(this.sanitizeUrl(i.url))},this),t},getContentUrlsByExtensions:function(e){var t=[];return r.each(e,function(e){var n=this.getContentUrlsForExtension(e);t.push.apply(t,n)},this),t},getContentUrlsByFileKeys:function(e){return r.map(e,this.getContentUrl,this)},getContentUrlFromFallback:function(e){var t=null,n=null,i="";for(i in this._fileList)if(n=this._fileList[i],!r.empty(n.fallback)&&e===n.fallback){t=this.sanitizeUrl(n.url);break}return t},getContentUrlFromType:function(e){var t,n=null,i=null;for(t in this._fileList)if(i=this._fileList[t],e===i.ext){n=this.sanitizeUrl(i.url);break}return n},getThumbnailUrl:function(e,t){var n,i=null,r=e+"|"+t;for(n in this._imageList)if(n===r){i=this._imageList[n].url;break}return i},getImageForDimensions:function(e,t){function n(n){var r={};return r.url=n.url,r.width=Number(n.width)||1,r.height=Number(n.height)||1,r.ratio=r.width/r.height,r.absDeltaWidth=Math.abs(e-r.width),r.absDeltaHeight=Math.abs(t-r.height),r.absDeltaRatio=Math.abs(i-r.ratio),r}if(a.log("getImageForDimensions",e,t),r.isEmpty(this._imageList))return a.log("getImageForDimensions","No images!"),null;var i=e/t,o=this.getThumbnailUrl(e,t);if(o)return a.log("getImageForDimensions","Found exact match!"),o;var s=[];if(r.each(this._imageList,function(e,t){s.push(n(t))}),s.length<2)return s[0].url;var l=s.sort(this._compareAbsDeltaWidth),c=l[0];a.debug("getImageForDimensions","closest by width",c);var u=l.sort(this._compareAbsDeltaHeight),d=u[0];a.debug("getImageForDimensions","closest by height",d);var h;if(c===d)a.debug("getImageForDimensions","found an obvious winner (closest by width AND height)"),h=c;else{var p=[c,d].sort(this._compareAbsDeltaRatio);a.debug("getImageForDimensions","comparing closest-by-width and closest-by-height to find the closest in aspect ratio",c,d),h=p[0]}return a.debug("getImageForDimensions","winner",h),h.url},_compareAbsDeltaWidth:function(e,t){return e.absDeltaWidth-t.absDeltaWidth},_compareAbsDeltaHeight:function(e,t){return e.absDeltaHeight-t.absDeltaHeight},_compareAbsDeltaRatio:function(e,t){return e.absDeltaRatio-t.absDeltaRatio},getAdUrl:function(e){return this._adList&&this._adList[e]&&this._adList[e].url||null},getClosedCaptions:function(){return this._captionsList},getXML:function(){return this._xmlEntry}});t.exports=u},{"../cvp/log":29,"../cvp/util/xml":51,"../cvp/utils":52,"../vendor/Class":96}],66:[function(e,t,n){var i=e("../../cvp/util/dependency"),r=e("../parsers/adpolicy"),o=e("../../cvp/log"),s=e("../../core/app"),a=o.getLogger(),l=i.extend({init:function(){this._super.apply(this,arguments),this.required=!0,this._parser=new r,this._parser.eParseCompleted.addListener(this._onParseCompleted,this),this._parser.eParseError.addListener(this._onParseError,this)},setContext:function(e){this._parser.setAdPolicyContext(e)},load:function(){a.info("AdPolicyDependency","loading xml",this._assetUrl),this._parser.parse(this._assetUrl)},_onParseCompleted:function(e){var t=e.ads.attr.type.toLowerCase();"freewheel"===t?(a.info("AdPolicyDependency","adding FW dependency"),this._manager.addDependency(new i(s.AD_MANAGER_URL,!0))):"dfp"===t&&(a.info("AdPolicyDependency","adding DFP dependency"),this._manager.addDependency(new i(s.AD_DFP_URL,!0))),this._success(e)},_onParseError:function(){this._failure()},_complete:function(){this._parser&&(this._parser.eParseCompleted.removeListener(this._onParseCompleted,this),this._parser.eParseError.removeListener(this._onParseError,this),this._parser=null),this._super()},getDesc:function(){return"AdPolicyDependency: "+this._assetUrl}});t.exports=l},{"../../core/app":10,"../../cvp/log":29,"../../cvp/util/dependency":46,"../parsers/adpolicy":77}],67:[function(e,t,n){var i=e("../../cvp/util/dependency"),r=e("../parsers/appconfig"),o=e("./container"),s=e("../../cvp/utils"),a=e("../../cvp/log"),l=a.getLogger(),c=i.extend({init:function(){this._super.apply(this,arguments),this.required=!0,this._parser=new r,this._parser.eParseCompleted.addListener(this._onParseCompleted,this),this._parser.eParseError.addListener(this._onParseError,this)},load:function(){l.info("AppConfigDependency","loading xml",this._assetUrl),this._parser.parse(this._assetUrl)},_onParseCompleted:function(e){if(!e||s.empty(e.containerUrl)||s.empty(e.configUrl))return l.error("Unable to retrieve the appConfig file."),void this._failure();var t=new o(e.containerUrl,!0);t.setConfigUrl(e.configUrl),t.passParams(this._manager.getParams()),this._manager.addDependency(t),this._success(e)},_onParseError:function(){this._failure()},_complete:function(){this._parser&&(this._parser.eParseCompleted.removeListener(this._onParseCompleted,this),this._parser.eParseError.removeListener(this._onParseError,this),this._parser=null),this._super()},getDesc:function(){return"AppConfigDependency: "+this._assetUrl}});t.exports=c},{"../../cvp/log":29,"../../cvp/util/dependency":46,"../../cvp/utils":52,"../parsers/appconfig":78,"./container":69}],68:[function(e,t,n){var i=e("../../cvp/util/dependency"),r=e("../parsers/config"),o=e("../../cvp/utils"),s=e("../../cvp/log"),a=s.getLogger(),l=i.extend({init:function(){this._super.apply(this,arguments),this.required=!0,this._parser=new r,this._parser.eParseCompleted.addListener(this._onParseCompleted,this),this._parser.eParseError.addListener(this._onParseError,this)},setContext:function(e){this._parser.setPlayerInstance(e)},load:function(){this._parser.parse(this._assetUrl)},_onParseCompleted:function(e){this._manager&&(o.empty(e.omniture)||o.empty(e.omniture.omniture_account)||a.info("ContainerDependency","adding Omniture dependency")),this._success(e)},_onParseError:function(){this._failure()},_complete:function(){this._parser&&(this._parser.eParseCompleted.removeListener(this._onParseCompleted,this),this._parser.eParseError.removeListener(this._onParseError,this),this._parser=null),this._super()},getDesc:function(){return"ConfigDependency: "+this._assetUrl}});t.exports=l},{"../../cvp/log":29,"../../cvp/util/dependency":46,"../../cvp/utils":52,"../parsers/config":79}],69:[function(e,t,n){var i=e("../../cvp/util/dependency"),r=e("../parsers/container"),o=e("./config"),s=e("./adpolicy"),a=e("./trackingpolicy"),l=e("../../cvp/utils"),c=e("../../cvp/log"),u=c.getLogger(),d=i.extend({init:function(){this._super.apply(this,arguments),this.required=!0,this._parser=new r,this._parser.eParseCompleted.addListener(this._onParseCompleted,this),this._parser.eParseError.addListener(this._onParseError,this)},setConfigUrl:function(e){this.configUrl=e},passParams:function(e){this._parser.setParams(e)},load:function(){u.info("ContainerDependency","loading xml",this._assetUrl),this._parser.parse(this._assetUrl)},_onParseCompleted:function(e){var t=new o(this.configUrl,!0);if(t.setContext(e.playerInstance),this._manager.addDependency(t),!l.empty(e.adPolicySrc)){var n=new s(e.adPolicySrc,!0);n.setContext(e.adPolicyContext),this._manager.addDependency(n)}if(!l.empty(e.trackingPolicySrc)){var i=new a(e.trackingPolicySrc,!1);i.setContext(e.trackingPolicyContext),this._manager.addDependency(i)}this._success(e)},_onParseError:function(){this._failure()},_complete:function(){this._parser&&(this._parser.eParseCompleted.removeListener(this._onParseCompleted,this),this._parser.eParseError.removeListener(this._onParseError,this),this._parser=null),this._super()},getDesc:function(){return"ContainerDependency: "+this._assetUrl}});t.exports=d},{"../../cvp/log":29,"../../cvp/util/dependency":46,"../../cvp/utils":52,"../parsers/container":80,"./adpolicy":66,"./config":68,"./trackingpolicy":71}],70:[function(e,t,n){var i=e("../../cvp/util/dependency"),r=e("../parsers/mapping"),o=e("./appconfig"),s=e("../../cvp/utils"),a=e("../../cvp/log"),l=a.getLogger(),c=i.extend({init:function(){this._super.apply(this,arguments),this.required=!0,this._parser=new r,this._parser.eParseCompleted.addListener(this._onParseCompleted,this),this._parser.eParseError.addListener(this._onParseError,this)},setContext:function(e){this._parser.setMappingProfile(e)},load:function(){l.info("MappingDependency","loading xml",this._assetUrl),this._parser.parse(this._assetUrl)},_onParseCompleted:function(e){if(!e||s.empty(e.url))return l.error("Unable to retrieve the mapping file."),void this._failure();var t=s.replaceExtension(e.url,"xml","json");this._manager.addDependency(new o(t,!0)),this._success(e)},_onParseError:function(){this._failure()},_complete:function(){this._parser&&(this._parser.eParseCompleted.removeListener(this._onParseCompleted,this),this._parser.eParseError.removeListener(this._onParseError,this),this._parser=null),this._super()},getDesc:function(){return"MappingDependency: "+this._assetUrl}});t.exports=c},{"../../cvp/log":29,"../../cvp/util/dependency":46,"../../cvp/utils":52,"../parsers/mapping":82,"./appconfig":67}],71:[function(e,t,n){var i=e("../../cvp/util/dependency"),r=e("../parsers/trackingpolicy"),o=e("../../cvp/log"),s=o.getLogger(),a=i.extend({init:function(){this._super.apply(this,arguments),this._parser=new r,this._parser.eParseCompleted.addListener(this._onParseCompleted,this),this._parser.eParseError.addListener(this._onParseError,this)},setContext:function(e){this._parser.setTrackingPolicyContext(e)},load:function(){s.info("TrackingPolicyDependency","loading xml",this._assetUrl),this._parser.parse(this._assetUrl)},_onParseCompleted:function(e){this._success(e)},_onParseError:function(){this._failure()},_complete:function(){this._parser&&(this._parser.eParseCompleted.removeListener(this._onParseCompleted,this),this._parser.eParseError.removeListener(this._onParseError,this),this._parser=null),this._super()},getDesc:function(){return"TrackingPolicyDependency: "+this._assetUrl}});t.exports=a},{"../../cvp/log":29,"../../cvp/util/dependency":46,"../parsers/trackingpolicy":83}],72:[function(e,t,n){var i=e("./contententry"),r=e("../core/app"),o=e("../cvp/util/xml"),s=i.extend({init:function(){var e='<video id="not_avail"><headline>The requested video is not available.</headline><description></description><isExpired>true</isExpired><isAdSensitive>true</isAdSensitive><trt>0</trt><files><file>'+r.EXPIRED_MP4_URL+'</file></files><images><image width="320" height="240">'+r.EXPIRED_IMG_URL+"</image></images></video>",t=o.stringToDoc(e);this._super(t)}});t.exports=s},{"../core/app":10,"../cvp/util/xml":51,"./contententry":65}],73:[function(e,t,n){!function(t,n){"use strict";function i(e,t){function n(){}n.prototype=e;var i=new n;for(var r in t)i[r]=t[r];return t.toString!==Object.prototype.toString&&(i.toString=t.toString),i}function r(e,t){if(null==t)return null;null==t.__id__&&(t.__id__=j++);var n;return null==e.hx__closures__?e.hx__closures__={}:n=e.hx__closures__[t.__id__],null==n&&(n=function(){return n.method.apply(n.scope,arguments)},n.scope=e,n.method=t,e.hx__closures__[t.__id__]=n),n}n.com=n.com||{},n.com.turner=n.com.turner||{},n.com.turner.cvp=n.com.turner.cvp||{},n.com.turner.cvp.feature=n.com.turner.cvp.feature||{},n.com.turner.cvp.feature.ads=n.com.turner.cvp.feature.ads||{},n.com.turner.cvp.feature.ads.kvp=n.com.turner.cvp.feature.ads.kvp||{};var o=function(){return N.__string_rec(this,"")},s=function(e,t){t=t.split("u").join(""),this.r=new RegExp(e,t)};s.__name__=!0,s.prototype={match:function(e){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(e),this.r.s=e,null!=this.r.m}};var a=function(){};a.__name__=!0,a.cca=function(e,t){var n=e.charCodeAt(t);if(n==n)return n},a.substr=function(e,t,n){return null!=t&&0!=t&&null!=n&&0>n?"":(null==n&&(n=e.length),0>t?(t=e.length+t,0>t&&(t=0)):0>n&&(n=e.length+n-t),e.substr(t,n))},a.indexOf=function(e,t,n){var i=e.length;for(0>n&&(n+=i,0>n&&(n=0));i>n;){if(e[n]===t)return n;n++}return-1},a.remove=function(e,t){var n=a.indexOf(e,t,0);return-1==n?!1:(e.splice(n,1),!0)},a.iter=function(e){return{cur:0,arr:e,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var l=function(){this.length=0};l.__name__=!0,l.prototype={add:function(e){var t=[e];null==this.h?this.h=t:this.q[1]=t,this.q=t,this.length++},iterator:function(){return new c(this.h)}};var c=function(e){this.head=e,this.val=null};c.__name__=!0,c.prototype={hasNext:function(){return null!=this.head},next:function(){return this.val=this.head[0],this.head=this.head[1],this.val}},Math.__name__=!0;var u=function(){};u.__name__=!0,u.fields=function(e){var t=[];if(null!=e){var n=Object.prototype.hasOwnProperty;for(var i in e)"__id__"!=i&&"hx__closures__"!=i&&n.call(e,i)&&t.push(i)}return t},u.isEnumValue=function(e){return null!=e&&null!=e.__enum__};var d=function(){};d.__name__=!0,d.string=function(e){return N.__string_rec(e,"")},d.parseInt=function(e){var t=parseInt(e,10);return 0!=t||120!=a.cca(e,1)&&88!=a.cca(e,1)||(t=parseInt(e)),isNaN(t)?null:t};var h=function(){this.b=""};h.__name__=!0,h.prototype={add:function(e){this.b+=d.string(e)},addSub:function(e,t,n){null==n?this.b+=a.substr(e,t,null):this.b+=a.substr(e,t,n)}};var p=function(){};p.__name__=!0,p.fastCodeAt=function(e,t){return e.charCodeAt(t)};var f=function(){};f.__name__=!0,f.getEnum=function(e){return null==e?null:e.__enum__};var g={};g.__name__=!0,g.gt=function(e,t){var n=0>e,i=0>t;return n!=i?n:e>t};var m=function(e){this.nodeType=e,this.children=[],this.attributeMap=new P};m.__name__=!0,m.parse=function(e){return F.parse(e)},m.createElement=function(e){var t=new m(m.Element);if(t.nodeType!=m.Element)throw new M("Bad node type, expected Element but found "+t.nodeType);return t.nodeName=e,t},m.createPCData=function(e){var t=new m(m.PCData);if(t.nodeType==m.Document||t.nodeType==m.Element)throw new M("Bad node type, unexpected "+t.nodeType);return t.nodeValue=e,t},m.createCData=function(e){var t=new m(m.CData);if(t.nodeType==m.Document||t.nodeType==m.Element)throw new M("Bad node type, unexpected "+t.nodeType);return t.nodeValue=e,t},m.createComment=function(e){var t=new m(m.Comment);if(t.nodeType==m.Document||t.nodeType==m.Element)throw new M("Bad node type, unexpected "+t.nodeType);return t.nodeValue=e,t},m.createDocType=function(e){var t=new m(m.DocType);if(t.nodeType==m.Document||t.nodeType==m.Element)throw new M("Bad node type, unexpected "+t.nodeType);return t.nodeValue=e,t},m.createProcessingInstruction=function(e){var t=new m(m.ProcessingInstruction);if(t.nodeType==m.Document||t.nodeType==m.Element)throw new M("Bad node type, unexpected "+t.nodeType);return t.nodeValue=e,t},m.createDocument=function(){return new m(m.Document)},m.prototype={get_nodeName:function(){if(this.nodeType!=m.Element)throw new M("Bad node type, expected Element but found "+this.nodeType);return this.nodeName},get:function(e){if(this.nodeType!=m.Element)throw new M("Bad node type, expected Element but found "+this.nodeType);return this.attributeMap.get(e)},set:function(e,t){if(this.nodeType!=m.Element)throw new M("Bad node type, expected Element but found "+this.nodeType);this.attributeMap.set(e,t)},exists:function(e){if(this.nodeType!=m.Element)throw new M("Bad node type, expected Element but found "+this.nodeType);return this.attributeMap.exists(e)},attributes:function(){if(this.nodeType!=m.Element)throw new M("Bad node type, expected Element but found "+this.nodeType);return this.attributeMap.keys()},elements:function(){if(this.nodeType!=m.Document&&this.nodeType!=m.Element)throw new M("Bad node type, expected Element or Document but found "+this.nodeType);for(var e,t=[],n=0,i=this.children;n<i.length;){var r=i[n];++n,r.nodeType==m.Element&&t.push(r)}return e=t,a.iter(e)},elementsNamed:function(e){if(this.nodeType!=m.Document&&this.nodeType!=m.Element)throw new M("Bad node type, expected Element or Document but found "+this.nodeType);for(var t,n=[],i=0,r=this.children;i<r.length;){var o=r[i];++i,o.nodeType==m.Element&&function(e){var t;if(o.nodeType!=m.Element)throw new M("Bad node type, expected Element but found "+o.nodeType);return t=o.nodeName}(this)==e&&n.push(o)}return t=n,a.iter(t)},firstElement:function(){if(this.nodeType!=m.Document&&this.nodeType!=m.Element)throw new M("Bad node type, expected Element or Document but found "+this.nodeType);for(var e=0,t=this.children;e<t.length;){var n=t[e];if(++e,n.nodeType==m.Element)return n}return null},addChild:function(e){if(this.nodeType!=m.Document&&this.nodeType!=m.Element)throw new M("Bad node type, expected Element or Document but found "+this.nodeType);null!=e.parent&&e.parent.removeChild(e),this.children.push(e),e.parent=this},removeChild:function(e){if(this.nodeType!=m.Document&&this.nodeType!=m.Element)throw new M("Bad node type, expected Element or Document but found "+this.nodeType);return a.remove(this.children,e)?(e.parent=null,!0):!1}};var _=n.AdKeyValueConfigParser=function(){};_.__name__=!0,_.parse=function(e){var t=function(e){var t=m.parse(e);return new O(t.firstElement())},n=t(e);if(null==n)return null;for(var i=function(e){var t=e.x;return t.attributes()},r=function(e,t,n){var i=e.x;return i.exists(t)?i.get(t):n},o=function(e){var t=new P;if(null!=e)for(var n=i(e);n.hasNext();){var o=n.next(),s=r(e,o);null!=B[o]?t.setReserved(o,s):t.h[o]=s}return t},s=[],a=n.nodes.resolve("keyValue").iterator();null!=a.head;){var l;l=function(e){var t;return a.val=a.head[0],a.head=a.head[1],t=a.val}(this);var c;c=l.has.resolve("name")?l.att.resolve("name"):null;var u;u=l.has.resolve("value")?l.att.resolve("value"):null;var d;d=l.has.resolve("source")?l.att.resolve("source"):null;for(var h=new P,p=l.get_elements();p.hasNext();){var f=p.next(),g=f.get_name(),_=o(f);null!=B[g]?h.setReserved(g,_):h.h[g]=_}s.push(new A(c,u,d,new w(h)))}return new v(s)};var v=n.com.turner.cvp.feature.ads.kvp.AdKeyValueConfigVo=function(e){this.keyValuePairs=e};v.__name__=!0,v.prototype={toString:function(){return this.toJson()},toJson:function(){return JSON.stringify(this)}};var y=n.AdKeyValueEvaluator=function(e){this._config=e,null==this._config&&(this._config=new v([])),this._data=[];for(var t=0,n=this._config.keyValuePairs;t<n.length;){var i=n[t];++t,this._data.push(new C(i))}};y.__name__=!0,y.prototype={reset:function(){for(var e=0,t=this._data;e<t.length;){var n=t[e];++e,n.reset()}},evaluate:function(e){var t={};this._data=this._data.filter(function(e){return e.withinLifetime()});for(var n=0,i=this._data;n<i.length;){var r=i[n];++n,r.shouldEvaluate()&&r.evaluate(e);for(var o=r.getPairs(),s=0;s<o.length;){var a=o[s];++s,t[a.key]=a.val}}return t}};var C=function(e){this._vo=e,this._frequency=this._vo.settings.frequency,this._lifetime=this._vo.settings.lifetime,this._maxPairs=this._vo.settings.maxPairs,this._totalCount=0,this._contentCount=0};C.__name__=!0,C.prototype={reset:function(){this._contentCount++},withinLifetime:function(){var e=this._lifetime.scope;switch(e[1]){case 2:return!0;case 0:return g.gt(this._lifetime.value,this._totalCount);case 1:return g.gt(this._lifetime.value,this._contentCount)}},shouldEvaluate:function(){var e=this._frequency.scope;switch(e[1]){case 2:return!0;case 0:return g.gt(this._lifetime.value,this._totalCount);case 1:return g.gt(this._lifetime.value,this._contentCount)}},evaluate:function(e){if(this._pairs=[],null!=this._vo.source){var t,n=T.replace(this._vo.source,e),i=u.fields(n);t=g.gt(this._maxPairs,0)?this._maxPairs:i.length;for(var r=0;t>r;){var o=r++,s=i[o],a=n[s];this._pairs.push({key:s,val:a})}}else{var l=this._vo.key,c=T.replace(this._vo.val,e);this._pairs.push({key:l,val:c}),this._totalCount++}},log:function(e){},getPairs:function(){return this._pairs}};var w=function(e){this.frequency=this.parseScopedConstraint(null!=B.frequency?e.getReserved("frequency"):e.h.frequency),this.lifetime=this.parseScopedConstraint(null!=B.lifetime?e.getReserved("lifetime"):e.h.lifetime),this.maxPairs=this.parseMaxPairs(null!=B.maxPairs?e.getReserved("maxPairs"):e.h.maxPairs)};w.__name__=!0,w.prototype={parseScopedConstraint:function(e){null==e&&(e=new P);var t;t=null!=B.scope?e.getReserved("scope"):e.h.scope;var n;switch(t){case"session":n=E.Session;break;case"ad":n=E.Ad;break;case"content":n=E.Content;break;default:n=E.Session}var i;i=null!=B.value?e.getReserved("value"):e.h.value;var r,o=new s("^\\d+$","").match(i);switch(o){case!0:r=d.parseInt(i);break;case!1:switch(i){case"always":r=0;break;case"once":r=1;break;default:r=0}}var a={scope:n,value:r};return a},parseMaxPairs:function(e){var t;return t=null!=e&&(null!=B.value?e.existsReserved("value"):e.h.hasOwnProperty("value"))?d.parseInt(null!=B.value?e.getReserved("value"):e.h.value):0},toString:function(){return this.toJson()},toJson:function(){return JSON.stringify(this)}};var b=function(){};b.__name__=!0;var E={__ename__:!0,__constructs__:["Ad","Content","Session"]};E.Ad=["Ad",0],E.Ad.toString=o,E.Ad.__enum__=E,E.Content=["Content",1],E.Content.toString=o,E.Content.__enum__=E,E.Session=["Session",2],E.Session.toString=o,E.Session.__enum__=E;var A=function(e,t,n,i){this.key=e,this.val=t,this.source=n,this.settings=i};A.__name__=!0,A.prototype={toString:function(){return this.toJson()},toJson:function(){return JSON.stringify(this)}};var T=function(){};T.__name__=!0,T.replace=function(t,n,i){null==i&&(i=!1);var r=e("../../cvp/util/configutils");return r.stringReplace(t,n,i)};var S=function(){};S.__name__=!0,S.contains=function(e,t){return!(null==t||!u.isEnumValue(t)||e!=f.getEnum(t))},S.isValidOr=function(e,t,n){return S.contains(e,t)?t:n};var k=function(){};k.__name__=!0;var P=function(){this.h={}};P.__name__=!0,P.__interfaces__=[k],P.prototype={set:function(e,t){null!=B[e]?this.setReserved(e,t):this.h[e]=t},get:function(e){return null!=B[e]?this.getReserved(e):this.h[e]},exists:function(e){return null!=B[e]?this.existsReserved(e):this.h.hasOwnProperty(e)},setReserved:function(e,t){null==this.rh&&(this.rh={}),this.rh["$"+e]=t},getReserved:function(e){return null==this.rh?null:this.rh["$"+e]},existsReserved:function(e){return null==this.rh?!1:this.rh.hasOwnProperty("$"+e)},keys:function(){var e=this.arrayKeys();return a.iter(e)},arrayKeys:function(){var e=[];for(var t in this.h)this.h.hasOwnProperty(t)&&e.push(t);if(null!=this.rh)for(var t in this.rh)36==t.charCodeAt(0)&&e.push(t.substr(1));return e}};var x=function(e){this.__x=e};x.__name__=!0;var I=function(e){this.__x=e};I.__name__=!0,I.prototype={resolve:function(e){if(this.__x.nodeType==m.Document)throw new M("Cannot access document attribute "+e);var t=this.__x.get(e);if(null==t)throw new M(this.__x.get_nodeName()+" is missing attribute "+e);return t}};var R=function(e){this.__x=e};R.__name__=!0,R.prototype={resolve:function(e){if(this.__x.nodeType==m.Document)throw new M("Cannot access document attribute "+e);return this.__x.exists(e)}};var L=function(e){this.__x=e};L.__name__=!0;var D=function(e){this.__x=e};D.__name__=!0,D.prototype={resolve:function(e){for(var t=new l,n=this.__x.elementsNamed(e);n.hasNext();){var i=n.next();t.add(new O(i))}return t}};var O=function(e){if(e.nodeType!=m.Document&&e.nodeType!=m.Element)throw new M("Invalid nodeType "+e.nodeType);this.x=e,this.node=new x(e),this.nodes=new D(e),this.att=new I(e),this.has=new R(e),this.hasNode=new L(e)};O.__name__=!0,O.prototype={get_name:function(){return this.x.nodeType==m.Document?"Document":this.x.get_nodeName()},get_elements:function(){var e=this.x.elements();return{hasNext:r(e,e.hasNext),next:function(){var t=e.next();return null==t?null:new O(t)}}}};var F=function(){};F.__name__=!0,F.parse=function(e,t){null==t&&(t=!1);var n=m.createDocument();return F.doParse(e,t,0,n),n},F.doParse=function(e,t,n,i){null==n&&(n=0);for(var r=null,o=1,s=1,l=null,c=0,u=0,f=0,g=e.charCodeAt(n),_=new h,v=1,y=-1;g==g;){switch(o){case 0:switch(g){case 10:case 13:case 9:case 32:break;default:o=s;continue}break;case 1:switch(g){case 60:o=0,s=2;break;default:c=n,o=13;continue}break;case 13:if(60==g){_.addSub(e,c,n-c);var C=m.createPCData(_.b);_=new h,i.addChild(C),u++,o=0,s=2}else 38==g&&(_.addSub(e,c,n-c),o=18,v=13,c=n+1);break;case 17:if(93==g&&93==e.charCodeAt(n+1)&&62==e.charCodeAt(n+2)){var w=m.createCData(a.substr(e,c,n-c));i.addChild(w),u++,n+=2,o=1}break;case 2:switch(g){case 33:if(91==e.charCodeAt(n+1)){if(n+=2,"CDATA["!=a.substr(e,n,6).toUpperCase())throw new M("Expected <![CDATA[");n+=5,o=17,c=n+1}else if(68==e.charCodeAt(n+1)||100==e.charCodeAt(n+1)){if("OCTYPE"!=a.substr(e,n+2,6).toUpperCase())throw new M("Expected <!DOCTYPE");n+=8,o=16,c=n+1}else{if(45!=e.charCodeAt(n+1)||45!=e.charCodeAt(n+2))throw new M("Expected <!--");n+=2,o=15,c=n+1}break;case 63:o=14,c=n;break;case 47:if(null==i)throw new M("Expected node name");c=n+1,o=0,s=10;break;default:o=3,c=n;continue}break;case 3:if(!(g>=97&&122>=g||g>=65&&90>=g||g>=48&&57>=g||58==g||46==g||95==g||45==g)){if(n==c)throw new M("Expected node name");r=m.createElement(a.substr(e,c,n-c)),i.addChild(r),u++,o=0,s=4;continue}break;case 4:switch(g){case 47:o=11;break;case 62:o=9;break;default:o=5,c=n;continue}break;case 5:if(!(g>=97&&122>=g||g>=65&&90>=g||g>=48&&57>=g||58==g||46==g||95==g||45==g)){var b;if(c==n)throw new M("Expected attribute name");if(b=a.substr(e,c,n-c),l=b,r.exists(l))throw new M("Duplicate attribute");o=0,s=6;
continue}break;case 6:switch(g){case 61:o=0,s=7;break;default:throw new M("Expected =")}break;case 7:switch(g){case 34:case 39:_=new h,o=8,c=n+1,y=g;break;default:throw new M('Expected "')}break;case 8:switch(g){case 38:_.addSub(e,c,n-c),o=18,v=8,c=n+1;break;case 62:if(t)throw new M("Invalid unescaped "+String.fromCharCode(g)+" in attribute value");if(g==y){_.addSub(e,c,n-c);var E=_.b;_=new h,r.set(l,E),o=0,s=4}break;case 60:if(t)throw new M("Invalid unescaped "+String.fromCharCode(g)+" in attribute value");if(g==y){_.addSub(e,c,n-c);var A=_.b;_=new h,r.set(l,A),o=0,s=4}break;default:if(g==y){_.addSub(e,c,n-c);var T=_.b;_=new h,r.set(l,T),o=0,s=4}}break;case 9:n=F.doParse(e,t,n,r),c=n,o=1;break;case 11:switch(g){case 62:o=1;break;default:throw new M("Expected >")}break;case 12:switch(g){case 62:return 0==u&&i.addChild(m.createPCData("")),n;default:throw new M("Expected >")}break;case 10:if(!(g>=97&&122>=g||g>=65&&90>=g||g>=48&&57>=g||58==g||46==g||95==g||45==g)){if(c==n)throw new M("Expected node name");var S=a.substr(e,c,n-c);if(S!=function(e){var t;if(i.nodeType!=m.Element)throw new M("Bad node type, expected Element but found "+i.nodeType);return t=i.nodeName}(this))throw new M("Expected </"+function(e){var t;if(i.nodeType!=m.Element)throw"Bad node type, expected Element but found "+i.nodeType;return t=i.nodeName}(this)+">");o=0,s=12;continue}break;case 15:if(45==g&&45==e.charCodeAt(n+1)&&62==e.charCodeAt(n+2)){var k=m.createComment(a.substr(e,c,n-c));i.addChild(k),u++,n+=2,o=1}break;case 16:if(91==g)f++;else if(93==g)f--;else if(62==g&&0==f){var P=m.createDocType(a.substr(e,c,n-c));i.addChild(P),u++,o=1}break;case 14:if(63==g&&62==e.charCodeAt(n+1)){n++;var x=a.substr(e,c+1,n-c-2),I=m.createProcessingInstruction(x);i.addChild(I),u++,o=1}break;case 18:if(59==g){var R=a.substr(e,c,n-c);if(35==R.charCodeAt(0)){var L;L=120==R.charCodeAt(1)?d.parseInt("0"+a.substr(R,1,R.length-1)):d.parseInt(a.substr(R,1,R.length-1)),_.b+=String.fromCharCode(L)}else if(F.escapes.exists(R))_.add(F.escapes.get(R));else{if(t)throw new M("Undefined entity: "+R);_.b+=d.string("&"+R+";")}c=n+1,o=v}else if(!(g>=97&&122>=g||g>=65&&90>=g||g>=48&&57>=g||58==g||46==g||95==g||45==g)&&35!=g){if(t)throw new M("Invalid character in entity: "+String.fromCharCode(g));_.b+="&",_.addSub(e,c,n-c),n--,c=n+1,o=v}}g=p.fastCodeAt(e,++n)}if(1==o&&(c=n,o=13),13==o){if(n!=c||0==u){_.addSub(e,c,n-c);var D=m.createPCData(_.b);i.addChild(D),u++}return n}if(!t&&18==o&&13==v){_.b+="&",_.addSub(e,c,n-c);var O=m.createPCData(_.b);return i.addChild(O),u++,n}throw new M("Unexpected end")};var M=function(e){Error.call(this),this.val=e,this.message=String(e),Error.captureStackTrace&&Error.captureStackTrace(this,M)};M.__name__=!0,M.__super__=Error,M.prototype=i(Error.prototype,{});var N=function(){};N.__name__=!0,N.__string_rec=function(e,t){if(null==e)return"null";if(t.length>=5)return"<...>";var n=typeof e;switch("function"==n&&(e.__name__||e.__ename__)&&(n="object"),n){case"object":if(e instanceof Array){if(e.__enum__){if(2==e.length)return e[0];var i=e[0]+"(";t+="	";for(var r=2,o=e.length;o>r;){var s=r++;i+=2!=s?","+N.__string_rec(e[s],t):N.__string_rec(e[s],t)}return i+")"}var a=e.length,l="[";t+="	";for(var c=0;a>c;){var u=c++;l+=(u>0?",":"")+N.__string_rec(e[u],t)}return l+="]"}var d;try{d=e.toString}catch(h){return h instanceof M&&(h=h.val),"???"}if(null!=d&&d!=Object.toString&&"function"==typeof d){var p=e.toString();if("[object Object]"!=p)return p}var f=null,g="{\n";t+="	";var m=null!=e.hasOwnProperty;for(var f in e)m&&!e.hasOwnProperty(f)||"prototype"!=f&&"__class__"!=f&&"__super__"!=f&&"__interfaces__"!=f&&"__properties__"!=f&&(2!=g.length&&(g+=", \n"),g+=t+f+" : "+N.__string_rec(e[f],t));return t=t.substring(1),g+="\n"+t+"}";case"function":return"<function>";case"string":return e;default:return String(e)}};var j=0;Array.prototype.indexOf&&(a.indexOf=function(e,t,n){return Array.prototype.indexOf.call(e,t,n)}),String.__name__=!0,Array.__name__=!0,null==Array.prototype.filter&&(Array.prototype.filter=function(e){for(var t=[],n=0,i=this.length;i>n;){var r=n++,o=this[r];e(o)&&t.push(o)}return t});var B={};m.Element=0,m.PCData=1,m.CData=2,m.Comment=3,m.DocType=4,m.ProcessingInstruction=5,m.Document=6,F.escapes=function(e){var t,n=new P;return null!=B.lt?n.setReserved("lt","<"):n.h.lt="<",null!=B.gt?n.setReserved("gt",">"):n.h.gt=">",null!=B.amp?n.setReserved("amp","&"):n.h.amp="&",null!=B.quot?n.setReserved("quot",'"'):n.h.quot='"',null!=B.apos?n.setReserved("apos","'"):n.h.apos="'",t=n}(this)}("undefined"!=typeof console?console:{log:function(){}},t.exports)},{"../../cvp/util/configutils":45}],74:[function(e,t,n){var i=e("./contententry"),r=e("../cvp/utils"),o=e("../cvp/util/xml"),s=i.extend({init:function(e){var t=null,n="",i=e.id||e.url;if(r.isString(e.url)&&(t=e.url),r.isObject(e.metadata))for(var s in e.metadata)"files"===s&&t||(n+="<"+s+">"+e.metadata[s]+"</"+s+">");t&&(n+="<files><file>"+t+"</file></files>");var a="<video id='"+i+"'> "+n+"</video>",l=o.stringToDoc(a);this._super(l)}});t.exports=s},{"../cvp/util/xml":51,"../cvp/utils":52,"./contententry":65}],75:[function(e,t,n){var i=e("../vendor/Class"),r=e("../cvp/customevent"),o=e("../cvp/ajax"),s=e("../cvp/utils"),a=e("../cvp/util/jsonconverter"),l=e("../cvp/log"),c=e("../core/app"),u=e("./bootstrapper"),d=e("./aspencontroller"),h=e("./cms"),p=e("./player/instance"),f=e("./tracking/trackingmanager"),g=e("./tracking/aspentracking"),m=e("./player/videobegetter"),_=l.getLogger(),v=i.extend({init:function(){this._configData={},this.ePlayerLoaded=new r,this.ePlayerLoadError=new r,this.ePlayerRendered=new r,this.eContentMetadata=new r,this.eContentBegin=new r,this.eContentPlay=new r,this.eContentPause=new r,this.eContentEnd=new r,this.eContentComplete=new r,this.eContentPlayhead=new r,this.eContentBuffering=new r,this.eContentQueue=new r,this.eContentQueueAutoplay=new r,this.eContentVolume=new r,this.eContentError=new r,this.eContentResize=new r,this.eContentEntryLoad=new r,this.eContentEntryLoadError=new r,this.eAdPlayhead=new r,this.eAdPlay=new r,this.eAdEnd=new r,this.eAdError=new r,this.eAdSensitive=new r,this.eTrackingAdStart=new r,this.eTrackingAdComplete=new r,this.eTrackingAdProgress=new r,this.eTrackingAdCountdown=new r,this.eTrackingAdClick=new r,this.eTrackingContentPlay=new r,this.eTrackingContentBegin=new r,this.eTrackingContentProgress=new r,this.eTrackingContentEnd=new r,this.eTrackingContentComplete=new r,this.eTrackingContentReplay=new r,this.eTrackingContentSeek=new r,this.eTrackingContentSeekEnd=new r,this.eTrackingFullscreen=new r,this.eTrackingMuted=new r,this.eTrackingPaused=new r,this._loadingEntryQueue={},this._params={}},load:function(e){this._videoBegetter=new m,this._videoBegetter.prime(),this._params=e;var t=e.flashVars;s.isSimpleObject(t)&&(e.site=t.site,e.profile=t.profile,e.context=t.context,e.contentId=t.contentId,e.containerUrl=t.containerUrl,e.configUrl=t.configUrl,e.aspenContext=t.aspenContext,e.dt=!!t.superduperdevtime,e.requestTimeout=s.toInt(t.requestTimeout),e.requestRetries=s.toInt(t.requestRetries),"autostart"in t&&(e.autostart=s.isFlagActive(t.autostart,!1)),"controls"in t&&(e.controls=s.isFlagActive(t.controls,!0))),e.requestTimeout&&(o.JSONP.requestTimeout=e.requestTimeout),e.requestRetries&&(o.JSONP.maxRetries=e.requestRetries);var n=this._calculateMappingUrl(this._params.site);return s.empty(n)?(_.error("Unable to calculate mapping file url. Failing."),void this._bootStrapFailure()):(this._bootStrapper=new u(n,this._params),this._bootStrapper.eSuccess.addListener(this._bootStrapSuccess,this),this._bootStrapper.eFailure.addListener(this._bootStrapFailure,this),this._bootStrapper.load(),void d.init({dt:this._params.dt,context:this._params.aspenContext||this._params.context,site:this._params.site}))},_calculateMappingUrl:function(e){if(s.empty(e))return null;var t=s.replaceExtension(c.MAPPING_FILE,"xml","json");return this._params.dt||(t=s.template(c.MAPPING_PATH,e)+t),t},_bootStrapSuccess:function(e){if(!e||!e.data)return _.error("MainController","Unable to retrieve config data - failing."),void this._bootStrapFailure();this._configData=e.data,_.debug("MainController","_bootStrapSuccess");var t={autostart:!1,controls:!0,muted:!1},n=this._configData.configInfo;if(n&&(s.each(t,function(e,t){n[e]=s.isFlagActive(n[e],t)}),"volume"in n)){var i=s.toInt(n.volume)/100;isFinite(i)&&(n.volume=Math.min(Math.max(i,0),1))}var r=this._params;"autostart"in r&&(this._configData.configInfo.autostart=r.autostart),"controls"in r&&(this._configData.configInfo.controls=r.controls),"iosAirplay"in r&&(this._configData.configInfo.iosAirplay=r.iosAirplay),this._playerController=new p(this._videoBegetter,{params:this._params,configData:this._configData}),this._aspenTracking=new g({playerController:this._playerController,cvpElementId:this.getCurrentPlayer()}),this._trackingManager=new f({playerController:this._playerController}),this.setTrackingInterval(this._configData.trackingPolicy.interval),this._cms=new h,this._cms.setDataUrl(this._configData.configInfo.dataSrc),this._cms.setMediaUrl(this._configData.configInfo.mediaSrc),this._listen(!0),function(e){var t=e&&e.adPolicy&&e.adPolicy.ads||{},n=e.configInfo||{},i=e.containerInfo||{},r={cvpElementId:i.elementName,adApi:t.apiUrl,adServerRootUrl:t.adServerRootUrl,adNetworkId:t.adNetworkId,adVideoNetworkId:t.adVideoNetworkId,adVideoAssetId:t.adVideoAssetId,adSection:t.adSection,adPlayerProfile:t.adPlayerProfile,renderersUrl:t.renderersUrl,sensitiveFallbackId:t.sensitiveFallbackId,adLiveContentDuration:t.liveDuration,mediaSrc:n.mediaSrc,dataSrc:n.dataSrc,adPolicyUrl:i.adPolicySrc};d.send("appConfig",{playerConfigUrl:e.appConfig&&e.appConfig.configUrl,containerName:document.URL}),d.send("elementConfig",r)}.call(this,this._configData),this.ePlayerLoaded.dispatch(),this._bootStrapComplete()},_listen:function(e){if(this._isListening!==e){this._isListening=e;var t=e?"addListener":"removeListener";this._playerController.eRendered[t](this._onRendered,this),this._playerController.eContentMetadata[t](this._onContentMetadata,this),this._playerController.eContentBegin[t](this._onContentBegin,this),this._playerController.eContentPlay[t](this._onContentPlay,this),this._playerController.eContentPause[t](this._onContentPause,this),this._playerController.eContentEnd[t](this._onContentEnd,this),this._playerController.eContentComplete[t](this._onContentComplete,this),this._playerController.eContentPlayhead[t](this._onContentPlayhead,this),this._playerController.eContentBuffering[t](this._onContentBuffering,this),this._playerController.eContentQueue[t](this._onContentQueue,this),this._playerController.eContentQueueAutoplay[t](this._onContentQueueAutoplay,this),this._playerController.eContentVolume[t](this._onContentVolume,this),this._playerController.eContentError[t](this._onContentError,this),this._playerController.eContentResize[t](this._onContentResize,this),this._playerController.eAdPlayhead[t](this._onAdPlayhead,this),this._playerController.eAdPlay[t](this._onAdPlay,this),this._playerController.eAdEnd[t](this._onAdEnd,this),this._playerController.eAdError[t](this._onAdError,this),this._playerController.eAdSensitive[t](this._onAdSensitive,this),this._trackingManager.eTrackingAdStart[t](this._onTrackingAdStart,this),this._trackingManager.eTrackingAdComplete[t](this._onTrackingAdComplete,this),this._trackingManager.eTrackingAdProgress[t](this._onTrackingAdProgress,this),this._trackingManager.eTrackingAdCountdown[t](this._onTrackingAdCountdown,this),this._trackingManager.eTrackingAdClick[t](this._onTrackingAdClick,this),this._trackingManager.eTrackingContentPlay[t](this._onTrackingContentPlay,this),this._trackingManager.eTrackingContentBegin[t](this._onTrackingContentBegin,this),this._trackingManager.eTrackingContentProgress[t](this._onTrackingContentProgress,this),this._trackingManager.eTrackingContentEnd[t](this._onTrackingContentEnd,this),this._trackingManager.eTrackingContentComplete[t](this._onTrackingContentComplete,this),this._trackingManager.eTrackingContentReplay[t](this._onTrackingContentReplay,this),this._trackingManager.eTrackingContentSeek[t](this._onTrackingContentSeek,this),this._trackingManager.eTrackingContentSeekEnd[t](this._onTrackingContentSeekEnd,this),this._trackingManager.eTrackingFullscreen[t](this._onTrackingFullscreen,this),this._trackingManager.eTrackingMuted[t](this._onTrackingMuted,this),this._trackingManager.eTrackingPaused[t](this._onTrackingPaused,this),this._cms.eRequestCompleted[t](this._onCmsRequestCompleted,this)}},_bootStrapFailure:function(){_.debug("MainController","_bootStrapFailure"),this.ePlayerLoadError.dispatch(),this._bootStrapComplete()},_bootStrapComplete:function(){_.debug("MainController","_bootStrapComplete"),this._bootStrapper.eSuccess.removeListener(this._bootStrapSuccess,this),this._bootStrapper.eFailure.removeListener(this._bootStrapFailure,this),this._bootStrapper=null},render:function(e){this._playerController.render(e)},remove:function(){this._playerController.remove()},dispose:function(){this._videoBegetter.dispose(),this._videoBegetter=null,this._listen(!1),this._trackingManager.dispose(),this._trackingManager=null,this._aspenTracking.dispose(),this._aspenTracking=null,this._playerController.dispose(),this._playerController=null,this._cms=null},_onRendered:function(){var e=this._params.contentId;s.isNull(e)||(_.debug("MainController","Config property 'contentId' was provided with value '"+e+"'. Initiating play."),this.playContentWithId(e)),this.ePlayerRendered.dispatch()},playContentWithId:function(e,t){if(!s.isString(e))return void _.warn("MainController","playContentWithId","A content ID is required.");_.debug("MainController","playContentWithId",e),this._videoBegetter.prime();var n=this._getNextIndexForId(e),i=e+"|"+n;_.debug("MainController","playContentWithId","key",i),this._loadingEntryQueue[i]={play:!0,additionalParams:t},this._cms.addContentId(i)},playFromObject:function(e,t){if(!s.isString(e.url))return _.warn("MainController","playFromObject","The property 'url' is required of the object parameter."),void this.eContentEntryLoadError.dispatch(e.id,"Invalid object configuration",c.ERROR_CMS_PARSE,!1);var n=e.id||e.url;_.debug("MainController","playFromObject",n),this._videoBegetter.prime();var i=this._getNextIndexForId(n),r=n+"|"+i;_.debug("MainController","playFromObject","key",r),this._loadingEntryQueue[r]={play:!0,additionalParams:t},this._cms.addContentObject(r,e)},queueFromObject:function(e,t){var n=e.id||e.url;_.debug("MainController","queueFromObject",n);var i=this._getNextIndexForId(n),r=n+"|"+i;_.debug("MainController","queueFromObject","key",r),this._loadingEntryQueue[r]={play:!1,additionalParams:t},this._cms.addContentObject(r,e)},playNextInQueue:function(){this._playerController.playNextInQueue()},replay:function(){this._playerController.replay()},pause:function(){this._playerController.pause()},resume:function(){this._playerController.resume()},stop:function(){this._playerController.stop()},queueContentWithId:function(e,t){_.debug("MainController","queueContentWithId",e);var n=this._getNextIndexForId(e),i=e+"|"+n;_.debug("MainController","queueContentWithId","key",i),this._loadingEntryQueue[i]={play:!1,additionalParams:t},this._cms.addContentId(i)},dequeueContentWithId:function(e){this._playerController.dequeue(e)},emptyQueue:function(){this._playerController.emptyQueue()},setQueueAutoplay:function(e){this._playerController.setQueueAutoplay(e)},getQueue:function(){return this._playerController.getQueue()},seek:function(e){this._playerController.seek(e)},resize:function(e,t){this._playerController.resize(e,t)},goFullscreen:function(){this._playerController.goFullscreen()},setVolume:function(e){this._playerController.setVolume(e)},getVolume:function(){return this._playerController.getVolume()},mute:function(){this._playerController.mute()},unmute:function(){this._playerController.unmute()},isMuted:function(){return this._playerController.isMuted()},getContentEntry:function(e){if(!e||!s.isString(e))throw new Error("getContentEntry() requires a content ID");var t=this._cms.getContentId(e);return t?a.xmlToJson(t.getXML()):""},getContentEntryObject:function(e){if(!e||!s.isString(e))throw new Error("getContentEntryObject() requires a content ID");var t=this._cms.getContentId(e);return t?a.xmlToObject(t.getXML()):""},setAdSection:function(e){this._playerController.setAdSection(e)},setAdKeyValue:function(e,t){this._playerController.setAdKeyValue(e,t)},getAdKeyValues:function(){return this._playerController.getAdKeyValues()},clearAdKeyValues:function(){this._playerController.clearAdKeyValues()},setTrackingInterval:function(e){this._trackingManager.setTrackingInterval(e)},setDataSrc:function(e){this._cms.setDataUrl(e)},reportAnalytics:function(e,t){d.send(e,t)},getCurrentPlayer:function(){return this._configData.containerInfo.elementName},_onContentMetadata:function(e){d.send("videoConfig",{cvpElementId:this.getCurrentPlayer(),videoXmlJson:this.getContentEntryObject(e)}),this.eContentMetadata.dispatch.apply(this.eContentMetadata,arguments)},_onContentBegin:function(){this.eContentBegin.dispatch.apply(this.eContentBegin,arguments)},_onContentPlay:function(){this.eContentPlay.dispatch.apply(this.eContentPlay,arguments)},_onContentPause:function(){this.eContentPause.dispatch.apply(this.eContentPause,arguments)},_onContentEnd:function(){this.eContentEnd.dispatch.apply(this.eContentEnd,arguments)},_onContentComplete:function(){this.eContentComplete.dispatch.apply(this.eContentComplete,arguments)},_onContentPlayhead:function(){this.eContentPlayhead.dispatch.apply(this.eContentPlayhead,arguments)},_onContentBuffering:function(){this.eContentBuffering.dispatch.apply(this.eContentBuffering,arguments)},_onContentQueue:function(){this.eContentQueue.dispatch.apply(this.eContentQueue,arguments)},_onContentQueueAutoplay:function(){this.eContentQueueAutoplay.dispatch.apply(this.eContentQueueAutoplay,arguments)},_onContentVolume:function(){this.eContentVolume.dispatch.apply(this.eContentVolume,arguments)},_onContentError:function(e,t){d.send("error",{cvpElementId:this.getCurrentPlayer(),contentId:e,videoContentCount:void 0,errorCode:void 0,errorMessage:t}),this.eContentError.dispatch.apply(this.eContentError,arguments)},_onContentResize:function(){this.eContentResize.dispatch.apply(this.eContentResize,arguments)},_onAdPlayhead:function(){this.eAdPlayhead.dispatch.apply(this.eAdPlayhead,arguments)},_onAdPlay:function(){this.eAdPlay.dispatch.apply(this.eAdPlay,arguments)},_onAdEnd:function(){this.eAdEnd.dispatch.apply(this.eAdEnd,arguments)},_onAdError:function(){this.eAdError.dispatch.apply(this.eAdError,arguments)},_onAdSensitive:function(){this.eAdSensitive.dispatch.apply(this.eAdSensitive,arguments)},_onTrackingAdStart:function(){this.eTrackingAdStart.dispatch.apply(this.eTrackingAdStart,arguments)},_onTrackingAdComplete:function(){this.eTrackingAdComplete.dispatch.apply(this.eTrackingAdComplete,arguments)},_onTrackingAdProgress:function(){this.eTrackingAdProgress.dispatch.apply(this.eTrackingAdProgress,arguments)},_onTrackingAdCountdown:function(){this.eTrackingAdCountdown.dispatch.apply(this.eTrackingAdCountdown,arguments)},_onTrackingAdClick:function(){this.eTrackingAdClick.dispatch.apply(this.eTrackingAdClick,arguments)},_onTrackingContentPlay:function(){this.eTrackingContentPlay.dispatch.apply(this.eTrackingContentPlay,arguments)},_onTrackingContentBegin:function(){this.eTrackingContentBegin.dispatch.apply(this.eTrackingContentBegin,arguments)},_onTrackingContentProgress:function(){this.eTrackingContentProgress.dispatch.apply(this.eTrackingContentProgress,arguments)},_onTrackingContentEnd:function(){this.eTrackingContentEnd.dispatch.apply(this.eTrackingContentEnd,arguments)},_onTrackingContentComplete:function(){this.eTrackingContentComplete.dispatch.apply(this.eTrackingContentComplete,arguments)},_onTrackingContentReplay:function(){this.eTrackingContentReplay.dispatch.apply(this.eTrackingContentReplay,arguments)},_onTrackingContentSeek:function(){this.eTrackingContentSeek.dispatch.apply(this.eTrackingContentSeek,arguments)},_onTrackingContentSeekEnd:function(){this.eTrackingContentSeekEnd.dispatch.apply(this.eTrackingContentSeekEnd,arguments)},_onTrackingFullscreen:function(){this.eTrackingFullscreen.dispatch.apply(this.eTrackingFullscreen,arguments)},_onTrackingMuted:function(){this.eTrackingMuted.dispatch.apply(this.eTrackingMuted,arguments)},_onTrackingPaused:function(){this.eTrackingPaused.dispatch.apply(this.eTrackingPaused,arguments)},_removeLoadingQueueEntry:function(e){delete this._loadingEntryQueue[e]},_onCmsRequestCompleted:function(e,t,n,i,r){_.debug("_onCmsRequestCompleted",arguments);var o=t+"|"+n;if(r)return this.eContentEntryLoadError.dispatch(e,i,r,!1),void this._removeLoadingQueueEntry(o);var a=this._loadingEntryQueue[o],l=this._cms.getContentId(e+"|"+n),c=!1;return s.empty(a)?void _.warn("onCmsRequestCompleted","no entry for key '"+o+"' found in loading queue"):s.empty(l)?(_.error("onCmsRequestCompleted","no catalogEntry for contentId '"+e+"'"),void this._removeLoadingQueueEntry(o)):(_.debug("onCmsRequestCompleted",e,a.play),a.play?(this._playerController.emptyQueue(),this._playerController.play(l,a.additionalParams)):(this._playerController.queue(l,a.additionalParams),c=!0),this._removeLoadingQueueEntry(o),void(""===r&&this.eContentEntryLoad.dispatch(e,c)))},_getNextIndexForId:function(e){var t,n,i,r,o=0;for(t in this._loadingEntryQueue)n=t.split("|"),n&&n.length>1&&(i=n[0],r=+n[1],i===e&&!isNaN(r)&&r>=o&&(o=r+1));return o}});t.exports=v},{"../core/app":10,"../cvp/ajax":12,"../cvp/customevent":18,"../cvp/log":29,"../cvp/util/jsonconverter":48,"../cvp/utils":52,"../vendor/Class":96,"./aspencontroller":62,"./bootstrapper":63,"./cms":64,"./player/instance":89,"./player/videobegetter":91,"./tracking/aspentracking":94,"./tracking/trackingmanager":95}],76:[function(e,t,n){function i(e){var t={attr:{}},n="dev",i="prod",r="42448",o="48804",s="NONE",a="FREEWHEEL";for(var l in e.ads){var c=e.ads[l];switch(l){case"attr":for(l in e.ads.attr)c=e.ads.attr[l],c.toUpperCase()!=a&&c.toUpperCase()!=s||(t.attr[l]=c.toUpperCase());break;case"adNetworkId":case"adVideoNetworkId":var u;c==n?u=r:c==i?u=o:c!=r&&c!=o||(u=c),u&&(t.adNetworkId=t.adVideoNetworkId=u);break;case"adServerRootUrl":c==n&&(t[l]="http://bea4.v.fwmrm.net/");break;default:t[l]=c}}e.ads=t}var r=e("../vendor/Class"),o=e("../cvp/utils"),s=e("../cvp/log"),a=e("./parsers/adpolicy"),l=s.getLogger("OverWriteManager"),c={adPolicy:{ads:{apiUrl:"",adManRootUrl:"",adServerRootUrl:"",adVideoRootUrl:"",adVideoExtension:"",additionalVideoSegVars:"",additionalSyncSegVars:"",adSection:"",adNetworkId:"",adVideoNetworkId:"",adVideoAssetId:"",adPlayerProfile:"",renderersUrl:"",externalSlots:"",fallbackId:"",sensitiveFallbackId:"",adLiveContentDuration:"",adCuepointTimer:"",attr:{type:""}}}},u=r.extend({init:function(e){l.debug("init() flashvars: ",e),this._flashvars=e},overwrite:function(e){var t=o.merge({},new p(this._flashvars).getData(),new h(window.top.location.href).getData(),new h(window.location.href).getData());l.debug("merged:",o.merge({},t));var n=(new f).validate(t);l.debug("validated:",n);var i=a.jsonToXML(n.adPolicy);l.debug("adXml",i),(new a).parseData(i,e.adPolicy)}}),d=r.extend({getData:function(){return this.normalize()},normalize:function(){l.error("Subclass must implement")},getNormalized:function(e,t){var n={};if(!e||!t)return n;for(var i in e)void 0!=e[i]&&t.hasOwnProperty(i)&&(o.isSimpleObject(e[i])?n[i]=this.getNormalized(e[i],t[i]):n[i]=e[i]);return n}}),h=d.extend({init:function(e){l.debug("QueryStringEntryPoint - url: ",e),this._url=e,this._data=o.getQueryParams(this._url)},normalize:function(){var e={adPolicy:{ads:{adNetworkId:this._data.adNetworkId,adVideoNetworkId:this._data.adVideoNetworkId,adServerRootUrl:this._data.adServerRootUrl,attr:{}}}};return this.getNormalized(e,c)}}),p=d.extend({init:function(e){this._data={};var t=e[p.FLASH_VAR_NAME];l.debug("FlashVarsEntryPoint - overwrite: ",t),o.isEmpty(t)||(this._data={adPolicy:{ads:t.ads.adServer}},o.isEmpty(t.ads.adServer.type)||(this._data.adPolicy.ads.attr={type:t.ads.adServer.type},delete t.ads.adServer.type))},normalize:function(){return this.getNormalized(this._data,c)}});p.FLASH_VAR_NAME="overwrite";var f=r.extend({validate:function(e){return i(e.adPolicy),e}});t.exports=u},{"../cvp/log":29,"../cvp/utils":52,"../vendor/Class":96,"./parsers/adpolicy":77}],77:[function(e,t,n){function i(e,t,n){switch(t){case"adApi":e.apiUrl=n;break;case"adManRootUrl":e.adManRootUrl=n;break;case"adServerRootUrl":e.adServerRootUrl=n;break;case"adVideoRootUrl":e.adVideoRootUrl=n;break;case"adVideoExtension":e.adVideoExtension=n;break;case"additionalVideoSegvars":e.additionalVideoSegVars=n;break;case"additionalSyncSegvars":e.additionalSyncSegVars=n;break;case"adSection":e.adSection=n;break;case"adNetworkId":e.adNetworkId=n;break;case"adVideoNetworkId":e.adVideoNetworkId=n;break;case"adVideoAssetId":e.adVideoAssetId=n;break;case"adPlayerProfile":e.adPlayerProfile=n;break;case"renderersUrl":e.renderersUrl=n;break;case"externalSlots":e.externalSlots=u.isFlagActive(n,e.externalSlots);break;case"adLiveContentDuration":e.liveDuration=n;break;default:e[t]=n}}function r(e,t){t.hasAttributes&&(e.attr||(e.attr={}),c.assignAttributes(e.attr,t.attributes))}function o(e,t){var n=null;switch(t){case"adServer":n=e.ads}return n}function s(e,t){var n=c.docToString(t);e.keyValues=f.AdKeyValueConfigParser.parse(n)}function a(e,t){if(!u.isNull(e))for(var n,l,d=e.childNodes,h=0,p=d.length;p>h;++h)l=d[h],n=o(t,l.nodeName),u.isNull(n)?"param"===l.nodeName?i(t,c.getAttribute(l,"name"),c.getAttribute(l,"value")):"keyValuePairs"===l.nodeName&&s(t,l):(r(n,l),l.childNodes.length&&a(l,n))}var l=e("./generic"),c=e("../../cvp/util/xml"),u=e("../../cvp/utils"),d=e("../shared/playerconfig"),h=e("../../cvp/log"),p=e("../../cvp/util/xml"),f=e("../extensions/ad-kvps"),g=h.getLogger("AdPolicyParser"),m=l.extend({setAdPolicyContext:function(e){this.adPolicyContextName=e||""},parseData:function(e,t){var n=u.extend({},t||d.adPolicy),i=e.documentElement,r=i.getElementsByTagName("default");0!==r.length&&a(r[0],n);var o=null,s=i.getElementsByTagName("context");if(t)o=s[0];else for(var l=0,h=s.length;h>l;++l)if(c.getAttribute(s[l],"name")===this.adPolicyContextName){o=s[l];break}u.isNull(o)||a(o,n),g.debug("adPolicy:",n),this._fireLoadedSuccess(n)}});m.jsonToXML=function(e){var t="<policy><context><adServer/></context></policy>",n=p.stringToDoc(t),i=n.getElementsByTagName("adServer")[0],r=["attr"];for(var o in e.ads)if(!(r.indexOf(o)>-1)){var s=n.createElement("param"),a=n.createAttribute("name");a.nodeValue=o,s.setAttributeNode(a),a=n.createAttribute("value"),a.nodeValue=e.ads[o],s.setAttributeNode(a),i.appendChild(s)}return e.ads.attr&&e.ads.attr.type&&(a=n.createAttribute("type"),a.nodeValue=e.ads.attr.type,i.setAttributeNode(a)),n},t.exports=m},{"../../cvp/log":29,"../../cvp/util/xml":51,"../../cvp/utils":52,"../extensions/ad-kvps":73,"../shared/playerconfig":93,"./generic":81}],78:[function(e,t,n){var i=e("./generic"),r=e("../../cvp/request"),o=i.extend({_createRequest:function(e){return r.getJSONP({url:e,jsonpCallback:"cvp_onAppConfigReceived"})},parseData:function(e){var t=e.appConfig;this._fireLoadedSuccess(t)}});t.exports=o},{"../../cvp/request":37,"./generic":81}],79:[function(e,t,n){function i(e,t,n){switch(t){default:e[t]=n}}function r(e,t){t.hasAttributes&&(e.attr||(e.attr={}),l.assignAttributes(e.attr,t.attributes))}function o(e,t){var n=null;switch(t){case"akamai2":e.akamai2={},n=e.akamai2;break;case"akamaiSpe":e.akamaiSpe={},n=e.akamaiSpe;break;case"tokenAuth":e.token={},n=e.token}return n}function s(e,t){if(!c.isNull(e))for(var n,a,u=e.childNodes,d=0,h=u.length;h>d;++d)a=u[d],n=o(t,a.nodeName),c.isNull(n)?"param"===a.nodeName&&i(t,l.getAttribute(a,"name"),l.getAttribute(a,"value")):(r(n,a),a.childNodes.length&&s(a,n))}var a=e("./generic"),l=e("../../cvp/util/xml"),c=e("../../cvp/utils"),u=e("../shared/playerconfig"),d=a.extend({setPlayerInstance:function(e){this.playerInstanceName=e||""},parseData:function(e){var t=c.extend({},u.configInfo),n=e.documentElement,i=n.getElementsByTagName("default");i.length>0&&s(i[0],t);for(var r=null,o=n.getElementsByTagName("player"),a=null;o.length;)a=o[o.length-1],l.getAttribute(a,"name")===this.playerInstanceName&&(r=a.cloneNode(!0)),n.removeChild(a);c.isNull(r)||s(r,t),c.print(t,"configInfo"),this._fireLoadedSuccess(t)}});t.exports=d},{"../../cvp/util/xml":51,"../../cvp/utils":52,"../shared/playerconfig":93,"./generic":81}],80:[function(e,t,n){function i(e,t){var n=o.getParamValue(e,"adPolicySrc"),i=o.getParamValue(e,"adPolicyContext"),r=o.getParamValue(e,"trackingPolicySrc"),a=o.getParamValue(e,"trackingPolicyContext");s.empty(n)||(t.adPolicySrc=n),s.empty(i)||(t.adPolicyContext=i),s.empty(r)||(t.trackingPolicySrc=r),s.empty(a)||(t.trackingPolicyContext=a)}var r=e("./generic"),o=e("../../cvp/util/xml"),s=e("../../cvp/utils"),a=e("../shared/playerconfig"),l=r.extend({setParams:function(e){this._params=e},parseData:function(e){var t=0,n=0,r=e.documentElement,l=this._params.context||"",c=this._params.element||"",u=null,d=null,h=[],p=s.extend({},a.containerInfo),f=r.getElementsByTagName("default");if(f.length&&(h=f[0].getElementsByTagName("policies"),h.length&&i(h[0],p)),p.elementName=c,u=r.getElementsByTagName("context"),u.length){for(n=u.length;n>t;++t)if(o.getAttribute(u[t],"name")===l){d=u[t];break}if(d){var g=d.getElementsByTagName("element"),m=null,_=null;for(t=0,n=g.length;n>t;++t)if(m=g[t],o.getAttribute(m,"id")===c){_=m;break}_||(_=g[0]),c=o.getAttribute(_,"id"),h=_.getElementsByTagName("policies"),h.length&&i(h[0],p);var v=_.getElementsByTagName("player"),y=o.getAttribute(v[v.length-1],"playerInstance");s.empty(y)&&(y=l),p.playerInstance=y}s.empty(c)||(p.elementName=c)}s.print(p,"containerInfo"),this._fireLoadedSuccess(p)}});t.exports=l},{"../../cvp/util/xml":51,"../../cvp/utils":52,"../shared/playerconfig":93,"./generic":81}],81:[function(e,t,n){var i=e("../../vendor/Class"),r=e("../../cvp/customevent"),o=e("../../cvp/utils"),s=e("../../cvp/request"),a=e("../../cvp/log"),l=a.getLogger(),c=i.extend({init:function(){this.onLoaded=o.bind(this.onLoaded,this),this.onLoadError=o.bind(this.onLoadError,this),this.eParseCompleted=new r,this.eParseError=new r},parse:function(e){l.debug("Parser","Loading the file to parse",e),this.load(e)},load:function(e){this._createRequest(e).then(this.onLoaded,this.onLoadError)},_createRequest:function(e){return s.getXML({url:e})},onLoaded:function(e){l.debug("Parser","Data loaded"),this.parseData(e)},onLoadError:function(e){l.error("Parser","onLoadError:",e),this._fireLoadedFailure()},parseData:function(){l.error("Parser","`parseData` requires implementation")},_fireLoadedSuccess:function(){l.debug("Parser","successfully Loaded asset"),this.eParseCompleted.dispatch.apply(this.eParseCompleted,arguments)},_fireLoadedFailure:function(){l.error("Parser","failed to Load asset"),this.eParseError.dispatch.apply(this.eParseError,arguments)}});t.exports=c},{"../../cvp/customevent":18,"../../cvp/log":29,"../../cvp/request":37,"../../cvp/utils":52,"../../vendor/Class":96}],82:[function(e,t,n){var i=e("./generic"),r=e("../../cvp/utils"),o=e("../../cvp/request"),s=i.extend({_createRequest:function(e){return o.getJSONP({url:e,jsonpCallback:"cvp_onMappingReceived"})},setMappingProfile:function(e){this.profile=e},parseData:function(e){var t,n,i;if(r.undef(e)||r.undef(e.mappings))return void this.eParseError.dispatch();if(n=e.mappings,r.empty(this.profile))return void this.onLoadError(null,"No mapping profile provided","Invalid mapping profile");for(i in n)n[i].profile===this.profile&&(t=n[i]);return r.empty(t)?void this.onLoadError(null,"No mapping profile '"+this.profile+"' found","Invalid mapping profile"):void this._fireLoadedSuccess(t)}});t.exports=s},{"../../cvp/request":37,"../../cvp/utils":52,"./generic":81}],83:[function(e,t,n){
function i(e,t,n){switch(t){case"interval":e.interval=n}}function r(e,t){if(!a.isNull(e))for(var n,r=s.getChildElements(e),o=0,l=r.length;l>o;++o)n=r[o],"param"===n.nodeName&&i(t,s.getAttribute(n,"name"),s.getAttribute(n,"value"))}var o=e("./generic"),s=e("../../cvp/util/xml"),a=e("../../cvp/utils"),l=e("../shared/playerconfig"),c=o.extend({setTrackingPolicyContext:function(e){this.trackingPolicyContextName=e||""},parseData:function(e){var t=a.extend({},l.trackingPolicy),n=e.documentElement,i=n.getElementsByTagName("default");i.length&&r(i[0],t);for(var o,c=null,u=n.getElementsByTagName("context"),d=0,h=u.length;h>d;++d)if(o=u[d],s.getAttribute(o,"name")===this.trackingPolicyContextName){c=o;break}c&&r(c,t),a.print(t,"trackingPolicy"),this._fireLoadedSuccess(t)}});t.exports=c},{"../../cvp/util/xml":51,"../../cvp/utils":52,"../shared/playerconfig":93,"./generic":81}],84:[function(e,t,n){var i=e("../../vendor/Class"),r=e("../../cvp/customevent"),o=e("../../cvp/utils"),s=e("../../cvp/util/conditionaltask"),a=e("../../cvp/log"),l=a.getLogger(),c=i.extend({init:function(e){if(this._config=e.config,this.options=o.extend({containerElement:"",elementId:"",controls:!0,width:0,height:0},e),this.elementId=this.options.elementId,o.empty(this.elementId))throw l.error("Invalid element id...exiting"),new Error("Invalid element id");this.playerOptions={},this.width=this.options.width,this.height=this.options.height,this.element=null,this._isRendered=!1,this.position={top:null,right:null,bottom:null,left:null},this.eRendered=new r,this.eContentMetadata=new r,this.eContentPlay=new r,this.eContentPause=new r,this.eContentEnd=new r,this.eContentPlayhead=new r,this.eContentBuffering=new r,this.eContentVolume=new r,this.eContentError=new r,this.eContentResize=new r,this.eContentSeek=new r,this.eContentSeekEnd=new r,this.eFullscreenChange=new r,this.eFullscreenError=new r,this.ePlayerMuted=new r,this.ePlayerPaused=new r,this.ePlayerStopped=new r},embed:function(){},render:function(e){if(l.debug("Player","render"),this.containerElement=o.byId(e||this.options.containerElement),o.isNull(this.containerElement))throw l.error("Container element could not be found...cannot render...exiting"),new Error("Container could not be found");var t=this,n=function(){return!o.isNull(o.byId(t.elementId))},i=function(){t._isRendered=!0,t.element=o.byId(t.elementId),t.fireRendered()};if(this.containerElement.hasChildNodes()&&(this.containerElement.innerHTML=""),this.embed(this.containerElement),n())l.info("Player element was found; render immediately."),i();else{l.info("Player element was not found; render eventually.");var r=new s(n,i);r.start()}},rendered:function(){return this._isRendered},show:function(){this.element&&this.position.left&&(this.element.style.left=this.position.left)},hide:function(){this.element&&(this.position.left=this.element.style.left,this.element.style.left="-5000px")},remove:function(){l.debug("Player","remove");var e=this.containerElement;if(o.isNull(e))throw l.error("Container element could not be found .. cannot remove"),new Error("Container element could not be found");for(;e.firstChild;)e.removeChild(e.firstChild);e.parentNode&&e.parentNode.removeChild(e)},dispose:function(){this.removePlayerListeners(),this.remove()},addPlayerListeners:function(){},removePlayerListeners:function(){},fireRendered:function(){this.eRendered.dispatch()},getContentId:function(){return this._catalogEntry?this._catalogEntry.getId():""},firePlay:function(){this.eContentPlay.dispatch(this.getContentId(),"")},fireEnded:function(){this.eContentEnd.dispatch(this.getContentId())}});t.exports=c},{"../../cvp/customevent":18,"../../cvp/log":29,"../../cvp/util/conditionaltask":44,"../../cvp/utils":52,"../../vendor/Class":96}],85:[function(e,t,n){var i=e("../../vendor/Class"),r=e("../../cvp/static"),o=e("../../cvp/utils"),s=e("../../cvp/util/commandqueue"),a=e("../../cvp/customevent"),l=e("../../cvp/log"),c=e("./videoplayer"),u=e("../ads/adserverproxy"),d=l.getLogger("PlayerController"),h="",p="AD",f="CONTENT",g=0,m=1,_=2,v="play",y="replay",C=0,w=i.extend({init:function(e,t){this._videoBegetter=e,this._autostart="autostart"in t.configInfo?!!t.configInfo.autostart:!1;var n="controls"in t.configInfo?!!t.configInfo.controls:!0;this._commandQ=new s,this._stoppingQ=new s;var i=t.params;this._elementId=i.id,this._videoElement=e.getElement(),e.setControls(n),this._videoPlayer=new c(this._videoElement,{config:t,containerElement:"player_container",elementId:this._elementId,width:i.width,height:i.height,controls:n,autostart:this._autostart}),this._adProxy=new u(t.adPolicy),this._listen(!0),this._state=g,this._listeningForVideoElementActivation=!1,this._listeningForStart=!1,this._currentContentId="",this._contentQueue=[],this._seekTo=0,this._triggeredAd=!1,this._contentStarted=!1,this._fullscreen=!1,this._queueAutoplay=!0,this._metadataFired=!1,this._playEventQueue=[],this.eRendered=new a,this.eFullscreenChange=new a,this.eFullscreenError=new a,this.ePlayerPaused=new a,this.ePlayerMuted=new a,this.ePlayerStopped=new a,this.eContentMetadata=new a,this.eContentBegin=new a,this.eContentPlay=new a,this.eContentPause=new a,this.eContentEnd=new a,this.eContentComplete=new a,this.eContentReplay=new a,this.eContentPlayhead=new a,this.eContentSeek=new a,this.eContentSeekEnd=new a,this.eContentBuffering=new a,this.eContentQueue=new a,this.eContentQueueAutoplay=new a,this.eContentVolume=new a,this.eContentError=new a,this.eContentResize=new a,this.eContentStart=new a,this.eAdPlayhead=new a,this.eAdPlay=new a,this.eAdEnd=new a,this.eAdError=new a,this.eAdSensitive=new a,this.eAdClick=new a},_listen:function(e){if(this._isListening!==e){this._isListening=e;var t=e?"addListener":"removeListener";this._videoPlayer.eRendered[t](this._onRendered,this),this._videoPlayer.eFullscreenChange[t](this._onFullscreenChange,this),this._videoPlayer.eFullscreenError[t](this._onFullscreenError,this),this._videoPlayer.ePlayerPaused[t](this._onPlayerPaused,this),this._videoPlayer.ePlayerMuted[t](this._onPlayerMuted,this),this._videoPlayer.ePlayerStopped[t](this._onPlayerStopped,this),this._videoPlayer.eContentMetadata[t](this._onContentMetadata,this),this._videoPlayer.eContentPlay[t](this._onContentPlay,this),this._videoPlayer.eContentPause[t](this._onContentPause,this),this._videoPlayer.eContentEnd[t](this._onContentEnd,this),this._videoPlayer.eContentPlayhead[t](this._onContentPlayhead,this),this._videoPlayer.eContentSeek[t](this._onContentSeek,this),this._videoPlayer.eContentSeekEnd[t](this._onContentSeeked,this),this._videoPlayer.eContentBuffering[t](this._onContentBuffering,this),this._videoPlayer.eContentVolume[t](this._onContentVolume,this),this._videoPlayer.eContentError[t](this._onContentError,this),this._videoPlayer.eContentResize[t](this._onContentResize,this),this._adProxy.eAdPlayhead[t](this._onAdPlayhead,this),this._adProxy.eAdPlay[t](this._onAdPlay,this),this._adProxy.eAdEnd[t](this._onAdEnd,this),this._adProxy.eAdError[t](this._onAdError,this),this._adProxy.eAdClick[t](this._onAdClick,this),this._adProxy.eAdReady[t](this._onAdReady,this),this._adProxy.eAdStopped[t](this._onPlayerStopped,this)}},render:function(e){this._adProxy.setVideoDisplayBase(e),this._videoPlayer.render(e)},remove:function(){this._videoPlayer.remove()},dispose:function(){d.log("dispose"),this.stop(),this._commandQ.clear(),this._commandQ=null,this._stoppingQ.clear(),this._stoppingQ=null,this._listenForVideoElementActivation(!1),this._listenForStart(!1),this._listen(!1),this._adProxy.dispose(),this._adProxy=null,this._videoPlayer.dispose(),this._videoPlayer=null,this._videoBegetter.dispose(),this._videoBegetter=null},_onRendered:function(e){d.log("_onRendered",e),this._commandQ.execute(),this._commandQ.clear(),this.eRendered.dispatch()},_listenForVideoElementActivation:function(e){if(this._listeningForVideoElementActivation!==e){this._listeningForVideoElementActivation=e;var t=e?"addListener":"removeListener";this._videoBegetter.eActivate[t](this._onVideoElementActivation,this)}},_onVideoElementActivation:function(){switch(d.log("_onVideoElementActivation"),this._listenForVideoElementActivation(!1),this._shimPurpose){case v:this._playMedia();break;case y:this.replay()}},_listenForStart:function(e){if(this._listeningForStart!==e){this._listeningForStart=e;var t=e?"addListener":"removeListener";this._videoPlayer.eContentPlayhead[t](this._onContentStarted,this)}},play:function(e,t){return d.log("play",e.getId()),this._catalogEntry=e,this._playOptions=t,this._state!==g?(this._stoppingQ.clear(),this._stoppingQ.push(this._play,this),void this.stop()):void this._play()},_play:function(){var e=this._catalogEntry,t=e.getId();return d.log("_play",t),this._triggeredAd=!1,this._contentStarted=!1,e.isAdSensitive()&&this._onAdSensitive(t),this._videoPlayer.rendered()?(this._currentContentId=t,this._videoBegetter.setPoster(this._getPosterImageForPlayer()),this._autostart&&this._videoBegetter.isPrimed()?(d.debug("_play","autostart enabled and video element is primed; immediate play"),this._listenForVideoElementActivation(!1),this._playMedia()):(d.debug("_play","video element is NOT primed; deferred play via shim"),this._videoPlayer.removePlayerListeners(),this._shimPurpose=v,this._listenForVideoElementActivation(!0),this._videoBegetter.shim({autostart:this._autostart})),void(this._autostart=!0)):(d.debug("videoPlayer is not rendered; deferring play()"),void this._commandQ.push(this._play,this))},_rewind:function(){var e=this._videoPlayer;e.removePlayerListeners(),e.pause(),this._videoBegetter.setPoster(this._getPosterImageForPlayer()),this._shimPurpose=y,this._listenForVideoElementActivation(!0),this._videoBegetter.shim({autostart:!1});var t=this._videoElement;t.addEventListener("loadedmetadata",function n(){t.removeEventListener("loadedmetadata",n,!1),e.exitFullscreen()},!1),this._state=g},replay:function(){d.log("replay");var e=this._elementId,t=this._catalogEntry;if(!t)return void d.warn("replay","No previous content entry to replay!");var n=this._playOptions,i=t.getId();d.log("request to replay contentId '"+i+"'");var s=r.onCallback(e,["onContentReplayRequest",e,i,n]);return s===!1?(d.debug("user CB canceled replay request"),void this._rewind()):(o.isObject(s)&&(n=s),this.eContentReplay.dispatch(i,n),void this._play())},playNextInQueue:function(){if(!this._contentQueue.length)return void d.warn("playNextInQueue","Content queue is empty!");var e=this._contentQueue.shift();this.eContentQueue.dispatch(this.getQueue()),this.play(e.entry,e.options)},_getPosterImageForPlayer:function(){return this._catalogEntry.getImageForDimensions(this._videoPlayer.getWidth(),this._videoPlayer.getHeight())},_playMedia:function(){d.log("_playMedia"),this._state=_,this._metadataFired=!1,this._onContentBegin(this._catalogEntry.getId()),this._adProxy.isEnabled()?(this._videoPlayer.disableCrossOrigin(),this._videoPlayer.hideControls(),this._adProxy.loadAds(this._catalogEntry)):this._playContent()},_playContent:function(){d.log("_playContent"),this._listenForStart(!0),this._adProxy.setVideoStatePlaying(),this._playContentTime=o.now(),this._videoPlayer.showControls(),this._videoPlayer.play(this._catalogEntry)},pause:function(){d.log("pause"),this._videoPlayer.pause()},resume:function(){d.log("resume"),this._currentContentId&&this._videoPlayer.resume()},reset:function(){d.log("reset"),this.clearRestorePlayhead(),this._listenForVideoElementActivation(!1),this._listenForStart(!1)},stop:function(){d.log("stop"),this._state!==m&&(this._state=m,this.reset(),this._mediaClass===p?(d.log("stopping ad"),this._adProxy.stop()):this._mediaClass===f?(d.log("stopping content"),this._videoPlayer.stop()):this._onPlayerStopped())},queue:function(e,t){d.debug("queue",e.getId()),this._contentQueue.push({entry:e,options:t}),this.eContentQueue.dispatch(this.getQueue())},dequeue:function(e){for(var t,n=this._contentQueue.length,i=n-1;i>=0;--i)if(t=this._contentQueue[i].entry,t.getId()===e){this._contentQueue.splice(i,1);break}this._contentQueue.length!==n&&this.eContentQueue.dispatch(this.getQueue())},emptyQueue:function(){this._contentQueue.length&&(this._contentQueue.length=0,this.eContentQueue.dispatch(this.getQueue()))},setQueueAutoplay:function(e){this._queueAutoplay=e,this.eContentQueueAutoplay.dispatch(this._queueAutoplay)},getQueue:function(){return o.map(this._contentQueue,function(e){return e.entry.getId()})},seek:function(e){this._contentStarted?(d.log("seeking to "+e+" seconds into the content"),this._videoPlayer.seek(e)):(d.debug("only setting playhead restore point if seek() has been called before content started"),this.setRestorePlayhead(e))},setRestorePlayhead:function(e){d.info("set restore playhead to "+e),this._seekTo=e},clearRestorePlayhead:function(){this._seekTo=0},resize:function(e,t){this._videoPlayer.resize(e,t)},goFullscreen:function(){this._videoPlayer.goFullscreen()},setVolume:function(e){this._videoPlayer.setVolume(e)},getVolume:function(){return this._videoPlayer.getVolume()},mute:function(){this._videoPlayer.mute()},unmute:function(){this._videoPlayer.unmute()},isMuted:function(){this._videoPlayer.isMuted()},setAdSection:function(e){this._adProxy.setAdSection(e)},getAdSection:function(){return this._adProxy.getAdSection()},setAdKeyValue:function(e,t){this._adProxy.setAdKeyValue(e,t)},getAdKeyValue:function(e){return this._adProxy.getAdKeyValue(e)},getAdKeyValues:function(){return this._adProxy.getAdKeyValues()},clearAdKeyValues:function(){this._adProxy.clearAdKeyValues()},getCatalogEntry:function(){return this._catalogEntry},getPlayerDimensions:function(){var e=this._videoPlayer.getDimensions();return this._fullscreen&&o.extend(e,{width:window.screen.width,height:window.screen.height}),e},getAdId:function(){return this._adProxy.currentAdId},getAdType:function(){return this._adProxy.getCurrentAdType()},_onFullscreenChange:function(e){if(d.log("_onFullscreenChange"),this._fullscreen=e,this.eFullscreenChange.dispatch(this._currentContentId,e),this._mediaClass===f){var t=this.getPlayerDimensions();this._onContentResize(t.width,t.height,e)}},_onFullscreenError:function(){d.log("_onFullscreenError"),this.eFullscreenError.dispatch()},_onPlayerPaused:function(e,t,n){d.log("_onPlayerPaused",e,t,n),this.ePlayerPaused.dispatch(e,t,n)},_onPlayerMuted:function(e){d.log("_onPlayerMuted",e),this.ePlayerMuted.dispatch(e)},_onPlayerStopped:function(){d.log("_onPlayerStopped"),this._state=g,this._currentContentId="",this._stoppingQ.execute(),this._stoppingQ.clear()},_onContentMetadata:function(e,t,n,i){d.log("_onContentMetadata",e,t,n,i),this._metadataFired||(this._metadataFired=!0,this.eContentMetadata.dispatch(e,t,n,i)),this._dumpPlayEventQueue()},_onContentBegin:function(e){d.log("_onContentBegin",e),C=0,this.eContentBegin.dispatch(e,this._playOptions)},_dumpPlayEventQueue:function(){if(this._playEventQueue.length){for(var e=0,t=this._playEventQueue.length;t>e;++e)this._fireContentPlay.apply(this,this._playEventQueue[e]);this._playEventQueue.length=0}},_fireContentPlay:function(e,t){this.eContentPlay.dispatch(e,t)},_onContentPlay:function(e,t){d.log("_onContentPlay",e,t),this._mediaClass=f,this._contentStarted=!1,this._metadataFired?this._fireContentPlay(e,t):this._playEventQueue.push(arguments)},_onContentPause:function(e,t){d.log("_onContentPause",e,t),this.eContentPause.dispatch(e,t),t?this._adProxy.setVideoStatePaused():this._adProxy.setVideoStatePlaying()},_onContentEnd:function(e){d.log("_onContentEnd",e),this._mediaClass=h,this.eContentEnd.dispatch(e),this._adProxy.setVideoStateStopped(),this._adProxy.isEnabled()?(this._videoPlayer.hideControls(),this._videoPlayer.disableCrossOrigin(),this._adProxy.playPostroll(this._catalogEntry)):this._onContentComplete.apply(this,arguments)},_continueAutoplay:function(){this._queueAutoplay&&this._contentQueue.length?this.playNextInQueue():this._rewind()},_onContentComplete:function(){d.log("_onContentComplete"),this.eContentComplete.dispatch(this._catalogEntry.getId()),this._videoPlayer.showControls(),this._adProxy.setVideoStateCompleted(),this._continueAutoplay()},_onContentStarted:function(e,t){if(t>0){d.log("_onContentStarted","firing ContentStart because playhead is greater than zero"),this._listenForStart(!1),this._contentStarted=!0;var n=Math.ceil((o.now()-this._playContentTime)/1e3);this._metadataFired||this._dumpPlayEventQueue(),this.eContentStart.dispatch(this._catalogEntry.getId(),n),this._seekAhead()}else d.log("_onContentStarted","playhead still at zero")},_seekAhead:function(){this._seekTo&&(d.info("restoring playhead to "+this._seekTo),this.seek(this._seekTo),this.clearRestorePlayhead())},_onContentPlayhead:function(e,t,n){this._currentContentPlayhead=t,this.eContentPlayhead.dispatch(e,t,n,-1)},_onAdReady:function(){d.log("_onAdReady"),this._midrollMap=this._adProxy.getMidrolls(),o.isSimpleObject(this._midrollMap)&&!o.isEmpty(this._midrollMap)&&(d.log("_onAdReady - midrolls: ",o.keys(this._midrollMap)),this._videoPlayer.eContentPlayhead.addListener(this._onPlayheadForMidrolls,this))},_onPlayheadForMidrolls:function(e,t){var n=Math.floor(t);n in this._midrollMap&&(d.log("_onPlayheadForMidrolls","playing midroll at "+n+" of midrolls: ",o.keys(this._midrollMap)),this.setRestorePlayhead(t),this._currentMidroll=this._midrollMap[n],delete this._midrollMap[n],this._playMidroll(this._currentMidroll))},_playMidroll:function(e){d.log("_playMidroll"),this._adProxy.setVideoStatePaused(),this._videoPlayer.disableCrossOrigin(),this._adProxy.playMidroll(e)},_resumeFromMidroll:function(){d.log("_resumeFromMidroll"),this._playContent()},_onContentSeek:function(e,t,n,i){d.log("_onContentSeek",e,t,n,i),this.eContentSeek.dispatch(e,t,n,i)},_onContentSeeked:function(e,t,n,i){d.log("_onContentSeeked",e,t,n,i),this.eContentSeekEnd.dispatch(e,t,n,i)},_onContentBuffering:function(e,t){d.log("_onContentBuffering"),this.eContentBuffering.dispatch(e,t)},_onContentVolume:function(e,t){d.log("_onContentVolume"),this.eContentVolume.dispatch(e,t)},_onContentError:function(e,t){d.log("_onContentError",e,t),this.eContentError.dispatch(e,t),this._continueAutoplay()},_onContentResize:function(e,t,n){d.log("_onContentResize",e,t,n),this.eContentResize.dispatch(e,t,n)},_onAdSensitive:function(e){d.debug("_onAdSensitive",e),this.eAdSensitive.dispatch(e)},_onAdPlayhead:function(e,t){this._currentAdPlayhead=e,this._currentAdDuration=t,this.eAdPlayhead.dispatch(e,t,C)},_onAdPlay:function(e){var t=e.token,n=e.mode,i=e.id,r=e.duration,o=e.adType,s=e.adAnalyticsData;d.debug("_onAdPlay","event",e),this._triggeredAd=!0,this._contentStarted=!1,this._mediaClass=p,this._videoPlayer.removePlayerListeners(),this.eAdPlay.dispatch(t,n,i,r,C,o,s)},_onAdEnd:function(e){var t=e.token,n=e.mode,i=e.id,r=e.adType;d.debug("_onAdEnd","event",e),this._triggeredAd&&this.eAdEnd.dispatch(t,n,i,C,r),this._onAdComplete(r)},_onAdError:function(e){var t=e.adType,n=e.errors,i=e.errorMessage;d.debug("_onAdError","event",e),this.eAdError.dispatch(i,C,t,n),this._onAdComplete(t)},_onAdComplete:function(e){if(C+=1,this._triggeredAd=!1,this._mediaClass=h,this._state===m)return d.debug("_onAdComplete","halting further activities because stop() was called, resetting video player"),void this._videoPlayer.reset();switch(e){case u.PREROLL:this._playContent();break;case u.MIDROLL:this._resumeFromMidroll();break;case u.POSTROLL:this._onContentComplete(this._currentContentId);break;default:this._onContentError("Failed to determine adType!")}},_onAdClick:function(e){this.eAdClick.dispatch(e.url),this._videoPlayer.showControls()}});t.exports=w},{"../../cvp/customevent":18,"../../cvp/log":29,"../../cvp/static":39,"../../cvp/util/commandqueue":43,"../../cvp/utils":52,"../../vendor/Class":96,"../ads/adserverproxy":55,"./videoplayer":92}],86:[function(e,t,n){var i=e("../../vendor/Class"),r=e("../../cvp/utils"),o=i.extend({init:function(e,t,n,i){if(!(e||t||n))throw new Error("Usage: new DOMEventHandler(element, events, listener, capture).once().while(fn).until(fn)");return this._enabled=!1,this._element=e,this._events=r.isArray(t)?t:t.split(/\W+/),this._listener=n,this._capture=i||!1,this._once=!1,this._precondition=null,this._postcondition=null,this.listener=r.bind(this.listener,this),this.addListener=r.bind(this.addListener,this),this.removeListener=r.bind(this.removeListener,this),this},dispose:function(){this.off(),this._element=null,this._events=null,this._listener=null,this._precondition=null,this._postcondition=null},listener:function(){return this._precondition&&!this._precondition()?void this.off():(this._once&&this.off(),this._listener.apply(this._element,arguments),void(this._postcondition&&!this._postcondition()&&this.off()))},addListener:function(e){this._element.addEventListener(e,this.listener,this._capture)},removeListener:function(e){this._element.removeEventListener(e,this.listener,this._capture)},once:function(){return this._once=!0,this},every:function(){return this._once=!1,this},"while":function(e){return r.isFunction(e)&&(this._precondition=e),this},until:function(e){return r.isFunction(e)&&(this._postcondition=e),this},off:function(){this._enabled&&(this._enabled=!1,r.each(this._events,this.removeListener))},on:function(){!this._enabled&&this._element&&(this._enabled=!0,r.each(this._events,this.addListener))}});t.exports=o},{"../../cvp/utils":52,"../../vendor/Class":96}],87:[function(e,t,n){var i=e("../../vendor/Class"),r=e("../../cvp/utils"),o=e("../../cvp/util/configutils"),s=e("../../cvp/browser"),a=e("../../cvp/util/jsonconverter"),l=e("../../cvp/log"),c=l.getLogger("FileSelection"),u=function(e){return e=e||{},e.hasOwnProperty("key")?e.key:e.hasOwnProperty("bitrate")?e.bitrate:void 0},d=function(e){var t=u(e);return m.availableFiles.hasOwnProperty(t)?m.availableFiles[t].ext:""},h=function(e,t){return function(n){return n.hasOwnProperty(e)?n[e]===t:!1}},p=function(e,t){return function(n){return n&&n.hasOwnProperty(e)?n[e]:t}},f=p("url",""),g=p("text",""),m={config:{},supportedFileTypes:[],selectedFileKeys:[],fallbackFileTypes:["m3u8","mp4"],availableFiles:{},availableFileKeys:[],availableFileUrls:[],contentEntryObj:{},contentEntryFiles:[]},_=i.extend({canExecute:function(){var e=m.config.params;return e.hasOwnProperty("fileSelection")||e.hasOwnProperty("perVideoFallbacks")},execute:function(e){var t,n=m.config.params;return n.hasOwnProperty("fileSelection")?t=this._getPageFileSelection(e):n.hasOwnProperty("perVideoFallbacks")&&(t=this._getFileByParameterFallback(e)),r.isString(t)&&(t=[t]),r.isArray(t)&&(r.each(t,function(e){-1===r.indexOf(m.availableFileUrls,e)&&c.warn("Potentially invalid url: "+e)}),t=r.map(t,function(t){return e.sanitizeUrl(t)})),t},_getPageFileSelection:function(){c.debug("Using page selection via 'fileSelection'");var e=m.config.params.fileSelection||null;if(!e)return!1;var t={_makeList:function(e){return r.isString(e)&&(e=e.split(",")),r.isArray(e)?e.map(function(e){return r.trim(e)}):[]},filterBy:function(e,t,n){var i=r.isFunc(t)?t:h(t,n);return r.filter(e,i)},filterByDimension:function(e,t,n){return this.filterBy(e,function(e){return e.width===t&&e.height===n})},filterByKey:function(e,t){return t=this._makeList(t),this.filterBy(e,function(e){return r.indexOf(t,u(e))>-1})},filterByExtension:function(e,t){return t=this._makeList(t),this.filterBy(e,function(e){return r.indexOf(t,d(e))>-1})}},n=e.call(t,m.contentEntryFiles,m.contentEntryObj);return r.isArray(n)?n.map(g):n},_getFileByParameterFallback:function(e){c.debug("Using page selection via 'perVideoFallbacks'");var t=m.config.params.perVideoFallbacks||[];if(!t)return!1;for(var n,i,r=0,s=t.length;s>r;++r)if(n=t[r],i=o.stringReplace(n.criteria,e,!1),n.evaluate(i))return o.stringReplace(n.filter,e,!1);return null}}),v=i.extend({canExecute:function(){return!0},execute:function(e){var t=[];if(m.selectedFileKeys.length||m.supportedFileTypes.length){c.debug("Using config file key selection: "+m.selectedFileKeys),c.debug("Using config file type selection: "+m.supportedFileTypes);var n=e.getContentUrlsByFileKeys(m.selectedFileKeys),i=e.getContentUrlsByExtensions(m.supportedFileTypes);c.debug("fileKeyUrls:",n),c.debug("fileTypeUrls:",i),n&&n.length&&t.push.apply(t,n),i&&i.length&&t.push.apply(t,i)}else{c.debug("Using config legacy selection");var r=this._getFileByFallback(e),o=this._getFileByConfigFallbackParam(e),s=e.getContentUrlsByExtensions(m.fallbackFileTypes);c.debug("iOSFallbackUrl:",r),c.debug("configFallbackUrl:",o),c.debug("defaultUrls:",s),r&&t.push(r),o&&t.push(o),s&&s.length&&t.push.apply(t,s)}return t},_getFileByConfigFallbackParam:function(e){var t=m.config.configInfo.fallbackFilenameIOS;return r.empty(t)?t:t=o.stringReplace(t,e,!1)},_getFileByFallback:function(e){return s.isOS(s.IOS)?e.getContentUrlFromFallback("iOS"):void 0}}),y=i.extend({init:function(e){m.config=e;var t=/\W+/,n=m.config.configInfo;m.supportedFileTypes=r.uniq(r.filter(n.html5Types.split(t))),m.selectedFileKeys=r.uniq(r.filter(n.html5Order.split(t))),this._pageSelection=new _,this._configSelection=new v},getDefaultPlaylistForEntry:function(e){return e.getContentUrlsByExtensions(m.fallbackFileTypes)},getPlaylistForEntry:function(e){this._setState(e);var t=[],n=this._pageSelection.canExecute(),i=null,o=this._configSelection.canExecute(),s=null;return n&&(i=this._pageSelection.execute(e)),n&&r.isArray(i)?t=t.concat(i):n&&i!==!0&&null!==i&&void 0!==i||o&&(s=this._configSelection.execute(e),r.isArray(s)&&(t=t.concat(s))),t=r.uniq(r.filter(t))},_setState:function(e){m.availableFiles=e.getAllFiles(),m.availableFileKeys=r.keys(m.availableFiles),m.availableFileUrls=r.map(m.availableFileKeys,function(e,t,n){return f(m.availableFiles[e],t,n)});var t=a.xmlToObject(e.getXML());m.contentEntryObj=t;var n=[];r.filter(t.files,function(e){var t=e.file,i=u(t);m.availableFiles.hasOwnProperty(i)&&t.text===m.availableFiles[i].url&&n.push(t)}),m.contentEntryFiles=n}});t.exports=y},{"../../cvp/browser":14,"../../cvp/log":29,"../../cvp/util/configutils":45,"../../cvp/util/jsonconverter":48,"../../cvp/utils":52,"../../vendor/Class":96}],88:[function(e,t,n){function i(){this._isFullscreen=!1,this._onW3FullscreenChangeBind=r.bind(this._onW3FullscreenChange,this),this._onWebKitFullscreenChangeBind=r.bind(this._onWebKitFullscreenChange,this),this._onMozFullscreenChangeBind=r.bind(this._onMozFullscreenChange,this),this._onWebKitBeginFullscreenBind=r.bind(this._onWebKitBeginFullscreen,this),this._onWebKitEndFullscreenBind=r.bind(this._onWebKitEndFullscreen,this),this._onW3FullscreenErrorBind=r.bind(this._onW3FullscreenError,this),this._onWebKitFullscreenErrorBind=r.bind(this._onWebKitFullscreenError,this),this._onMozFullscreenErrorBind=r.bind(this._onMozFullscreenError,this),this.emitFullscreenChange=r.bind(this.emitFullscreenChange,this),this.emitFullscreenError=r.bind(this.emitFullscreenError,this),this.onFullscreenChange=new s("fullscreenChange"),this.onFullscreenError=new s("fullscreenError")}var r=e("../../cvp/utils"),o=e("../../cvp/log"),s=e("../../cvp/customevent"),a=o.getLogger("FullscreenMonitor");i.prototype={setup:function(e){a.log("setup"),e&&!this.player&&(this.player=e,this._listen(!0))},teardown:function(){a.log("teardown"),this.player&&this._listen(!1)},dispose:function(){this.teardown(),this.player=null},_listen:function(e){if(this._isListening!==e){this._isListening=e;var t=e?"addEventListener":"removeEventListener",n=this.player.getPlayerElement();n[t]("webkitbeginfullscreen",this._onWebKitBeginFullscreenBind,!1),n[t]("webkitendfullscreen",this._onWebKitEndFullscreenBind,!1),document[t]("fullscreenchange",this._onW3FullscreenChangeBind,!1),document[t]("webkitfullscreenchange",this._onWebKitFullscreenChangeBind,!1),document[t]("mozfullscreenchange",this._onMozFullscreenChangeBind,!1),document[t]("fullscreenerror",this._onW3FullscreenErrorBind,!1),document[t]("webkitfullscreenerror",this._onWebKitFullscreenErrorBind,!1),document[t]("mozfullscreenerror",this._onMozFullscreenErrorBind,!1)}},_handleFullscreenChange:function(e,t){(!e||e&&t===this.player.getPlayerElement())&&e!==this._isFullscreen&&(this._isFullscreen=e,this.emitFullscreenChange(this._isFullscreen,t))},_onW3FullscreenChange:function(){var e=document.fullscreenElement,t=!(!document.fullscreenEnabled&&!document.fullscreen&&!e);a.debug("_onW3FullscreenChange",t,e),this._handleFullscreenChange(t,e)},_onWebKitFullscreenChange:function(){var e=document.webkitFullscreenElement,t=!!document.webkitIsFullScreen||!!e;a.debug("_onWebKitFullscreenChange",t,e),this._handleFullscreenChange(t,e)},_onMozFullscreenChange:function(){var e=document.mozFullScreenElement,t=!(!document.mozFullScreen&&!document.fullScreen&&!e);a.debug("_onMozFullscreenChange",t,e),this._handleFullscreenChange(t,e)},_onWebKitBeginFullscreen:function(){var e=this.player.getPlayerElement(),t=!0;a.debug("_onWebKitBeginFullscreen",t,e),this._handleFullscreenChange(t,e)},_onWebKitEndFullscreen:function(){var e=null,t=!1;a.debug("_onWebKitEndFullscreen",t,e),this._handleFullscreenChange(t,e)},_handleFullscreenError:function(){a.log("_onFullscreenError"),this.emitFullscreenError()},_onW3FullscreenError:function(){a.log("_onW3FullscreenError"),this._handleFullscreenError()},_onWebKitFullscreenError:function(){a.log("_onWebKitFullscreenError"),this._handleFullscreenError()},_onMozFullscreenError:function(){a.log("_onMozFullscreenError"),this._handleFullscreenError()},emitFullscreenChange:function(e,t){a.log("emitFullscreenChange"),this.onFullscreenChange.dispatch(e,t)},emitFullscreenError:function(){a.log("emitFullscreenError"),this.onFullscreenError.dispatch()}},t.exports=i},{"../../cvp/customevent":18,"../../cvp/log":29,"../../cvp/utils":52}],89:[function(e,t,n){var i=e("../shared/playerconfig"),r=e("../../cvp/utils"),o=e("./controller"),s=function(e,t){var n=r.extend({},i);return r.extend(n.params,t.params),r.extend(n,t.configData),new o(e,n)};t.exports=s},{"../../cvp/utils":52,"../shared/playerconfig":93,"./controller":85}],90:[function(e,t,n){function i(e){return e instanceof f&&"code"in e}function r(e){var t=e.code,n=t===f.MEDIA_ERR_SRC_NOT_SUPPORTED,i=t===f.MEDIA_ERR_ABORTED;if(i)try{e.code=f.MEDIA_ERR_SRC_NOT_SUPPORTED}catch(r){u.debug("Failed to set error.code.  That's fine, I didn't want to do it anyway.")}return n||i}var o=e("../../vendor/Class"),s=e("../../cvp/customevent"),a=e("../../cvp/utils"),l=e("../../cvp/log"),c=e("../../cvp/util/timing"),u=l.getLogger("PilotEpisode"),d=2e4,h=5e3,p="loadstart progress suspend abort error emptied stalled loadedmetadata loadeddata canplay canplaythrough playing waiting seeking seeked ended durationchange timeupdate play pause ratechange resize volumechange".split(" "),f=window.MediaError||function(){},g=o.extend({init:function(e){this._started=!1,this._addedListeners=!1,this._player=e,this._player.eRendered.addListener(this._onPlayerRendered,this),this.onBuffering=new s,this.onConcluded=new s,this._pilotEvents=[],this._onPilotEvent=a.bind(this._onPilotEvent,this),this._onPilotTimeout=a.bind(this._onPilotTimeout,this),this._pilotTimer=c.eventually(this._onPilotTimeout,h),this._addEventListener=a.bind(this.addEventListener,this),this._removeEventListener=a.bind(this.removeEventListener,this)},_onPlayerRendered:function(){this._element=this._player.getVideoElement()},addEventListener:function(e,t){this._element.addEventListener(e,t,!1)},removeEventListener:function(e,t){this._element.removeEventListener(e,t,!1)},_queuePilotEvent:function(e){this._pilotEvents.push(e),u.log("queued pilot events: ",this._pilotEvents.length)},_clearPilotEvents:function(){u.log("clearing queued Pilot events"),this._pilotEvents.length=0},_dispatchPilotEvent:function(e){u.log("dispatching Pilot event '"+e.type+"'");try{this._element.dispatchEvent(e)}catch(t){u.debug("failed to dispatch event '"+e.type+"': "+t.message)}},_dispatchPilotEvents:function(){var e=this._pilotEvents,t=e.length;if(u.log("_dispatchPilotEvents","queue length = "+t),t){for(var n=t-1,i=0;n>i;++i)this._dispatchPilotEvent(e[i]);window.setTimeout(a.bind(this._dispatchPilotEvent,this,e[n]),0),this._clearPilotEvents();
}},_onPilotEvent:function(e){u.log("_onPilotEvent",e.type);var t=e.target;switch(e.type){case"loadedmetadata":case"playing":this._queuePilotEvent(e),this._concludePilot();break;case"error":t&&i(t.error)&&r(t.error)&&(this._queuePilotEvent(e),this._next());break;case"waiting":this._pilotBuffering||(this._pilotBuffering=!0,this.onBuffering.dispatch()),this._startPilotTimer();break;case"progress":case"suspend":case"stalled":this._startPilotTimer();break;default:this._queuePilotEvent(e)}},_addPilotListener:function(e){this._addEventListener(e,this._onPilotEvent)},_addPilotListeners:function(){return this._addedListeners?void u.log("_addPilotListeners","already listening to events!"):(u.log("_addPilotListeners",p),this._element?(a.each(p,this._addPilotListener,this),void(this._addedListeners=!0)):(u.error("_addPilotListeners","reference to video element was not fulfilled"),void this._concludePilot()))},_removePilotListener:function(e){this._removeEventListener(e,this._onPilotEvent)},_removePilotListeners:function(){return this._addedListeners?(u.log("_removePilotListeners",p),a.each(p,this._removePilotListener,this),void(this._addedListeners=!1)):void u.log("_removePilotListeners","already NOT listening to events!")},_stopPilotTimer:function(){u.log("_stopPilotTimer"),this._pilotTimer.stop()},_hasExceededAttemptMaxDuration:function(){var e=a.now()-this._pilotAttemptStart;return e>h},_startPilotTimer:function(){u.log("_startPilotTimer"),this._pilotTimer.start()},_onPilotTimeout:function(){u.log("_onPilotTimeout"),this._hasPilotCompleted||this._next()},_concludePilot:function(){return this._hasPilotCompleted?void u.log("_concludePilot","already concluded!"):(u.log("_concludePilot"),this._hasPilotCompleted=!0,void this._transitionBackToPlayer())},_teardownPilot:function(){this._stopPilotTimer(),this._removePilotListeners()},_transitionBackToPlayer:function(){this._teardownPilot(),this.onConcluded.dispatch(),this._dispatchPilotEvents(),this.stop()},_hasExceededSessionMaxDuration:function(){var e=a.now()-this._pilotSessionStart;return e>d},_next:function(){if(!this._playlist.length)return u.debug("_next","no more video URLs to try"),void this._concludePilot();if(this._hasExceededSessionMaxDuration())return u.debug("_next","the pilot session has exceeded the maximum allowed duration"),void this._concludePilot();var e=this._playlist.shift();u.debug("_next","attempting to play '"+e+"'"),this._clearPilotEvents(),this._pilotAttemptStart=a.now(),this._startPilotTimer(),this._playUrl(e)},_playUrl:function(e){u.log("playing URL '"+e+"'");var t=this._element;t.src=e,t.load(),t.play()},_setupPilot:function(){this._pilotBuffering=!1,this._hasPilotCompleted=!1,this._player.removePlayerListeners(),this._addPilotListeners()},start:function(e){this._started&&this.stop(),u.log("start"),this._started=!0,this._pilotSessionStart=a.now(),this._playlist=e,this._setupPilot(),this._next()},stop:function(){this._started&&(u.log("stop"),this._started=!1,this._teardownPilot(),this._clearPilotEvents())},dispose:function(){u.log("dispose"),this.stop(),this._element=null,this._player=null,this._pilotTimer=null}});t.exports=g},{"../../cvp/customevent":18,"../../cvp/log":29,"../../cvp/util/timing":50,"../../cvp/utils":52,"../../vendor/Class":96}],91:[function(e,t,n){var i=e("../../vendor/Class"),r=e("../../cvp/customevent"),o=e("../../cvp/log"),s=e("../../core/app"),a=e("../../cvp/utils"),l=o.getLogger("VideoBegetter"),c=["click","play"],u=i.extend({init:function(){l.log("init"),this._listening=!1,this._primed=!1,this._showControls=!0,this._videoElement=document.createElement("video"),this._onActivation=a.bind(this._onActivation,this),this.eActivate=new r},dispose:function(){l.log("dispose"),this.teardown(),this._videoElement=null},getElement:function(){return this._videoElement},isPrimed:function(){return this._primed},listen:function(e){if(e!==this._listening){l.log("listen",e),this._listening=e;for(var t=e?"addEventListener":"removeEventListener",n=0,i=c.length;i>n;++n)this._videoElement[t](c[n],this._onActivation,!0)}},setPoster:function(e){l.log('setPoster(url="'+e+'")');var t=this._videoElement;t.poster=s.BLANK_IMG_URL,null!=e&&(t.poster=e)},setControls:function(e){l.log('setControls(preferred="'+e+'")'),this._showControls=e,e||this.hideControls()},showControls:function(){return this._videoElement?this._showControls?(l.log("showControls","showing controls"),void(this._videoElement.controls=!0)):void l.log("showControls","disallowed by configuration"):void l.warn("showControls","no video element")},hideControls:function(){return this._videoElement?(l.log("hideControls","hiding controls"),void(this._videoElement.controls=!1)):void l.warn("hideControls","no video element")},prime:function(){if(l.log("prime"),this.isPrimed())return void this.listen(!1);this.listen(!0);var e=this._videoElement;this.showControls(),e.removeAttribute("src"),e.load()},shim:function(e){var t=a.extend({},e);l.log("shim",t),this.listen(!0);var n=this._videoElement;this.showControls(),n.removeAttribute("src"),n.src=s.BLANK_MP4_URL,null!=t.poster&&this.setPoster(t.poster),t.autostart&&(n.load(),n.play())},teardown:function(){l.log("teardown"),this.listen(!1)},_onFirstActivation:function(){l.log("_onFirstActivation"),this._primed||(this._primed=!0,this._videoElement.preload="metadata")},_onActivation:function(){l.log("_onActivation"),this.listen(!1),this.isPrimed()||this._onFirstActivation(),this.eActivate.dispatch()}});t.exports=u},{"../../core/app":10,"../../cvp/customevent":18,"../../cvp/log":29,"../../cvp/utils":52,"../../vendor/Class":96}],92:[function(e,t,n){function i(e){var t=e instanceof _&&!p.isEmpty(e);return t||(m.debug("error instanceof MediaError: ",e instanceof _),m.debug("error.code:",e.code),m.debug("Utils.hasOwn(error, 'code'):",p.hasOwn(e,"code"))),t}function r(e){switch(e.code){case _.MEDIA_ERR_ABORTED:return h.MEDIA_ERR_ABORTED;case _.MEDIA_ERR_NETWORK:return h.MEDIA_ERR_NETWORK;case _.MEDIA_ERR_DECODE:return h.MEDIA_ERR_DECODE;case _.MEDIA_ERR_SRC_NOT_SUPPORTED:return h.MEDIA_ERR_SRC_NOT_SUPPORTED}return h.MEDIA_ERR_UNKNOWN}var o=e("./baseplayer"),s=e("./pilotepisode"),a=e("./fileselection"),l=e("./fullscreenmonitor"),c=e("./domeventhandler"),u=e("../../core/app"),d=e("../../cvp/browser"),h=e("../../cvp/static"),p=e("../../cvp/utils"),f=e("../../cvp/log"),g=e("../../cvp/util/timing"),m=f.getLogger("VideoPlayer"),_=window.MediaError||function(){},v=o.extend({init:function(e,t){m.log("init"),this._videoElement=e,this._super(t);var n=this._config.configInfo.iosAirplay;d.isOS(d.IOS)&&!p.undef(n)&&(this.playerOptions["x-webkit-airplay"]=n),this.playerOptions.controls=this.options.controls,this._playlist=[],this._addedListeners=!1,this._muted=!1,this._fullscreen=!1,this.updatePlayhead=p.throttle(this.firePlayhead,250,{leading:!0,trailing:!1}),this.fireSeek=p.throttle(this.fireSeek,250,{leading:!0,trailing:!1}),this.fireSeekEnd=p.bind(this.fireSeekEnd,this),this._seekEndTimer=g.eventually(this.fireSeekEnd,1e3),this._pilotEpisode=new s(this),this._pilotEpisode.onBuffering.addListener(this._onContentBuffering,this),this._pilotEpisode.onConcluded.addListener(this._onPilotConcluded,this),this._fileSelectionHandler=new a(this._config),this._fullscreenMonitor=new l,this.eRendered.addListener(this.onRender,this),this._eventListeners={loadeddata:p.bind(this._onLoadedData,this),play:p.bind(this._onContentPlay,this),ended:p.bind(this._onContentEnd,this),playing:p.bind(this._onContentPlaying,this),pause:p.bind(this._onContentPause,this),timeupdate:p.bind(this._onContentPlayhead,this),error:p.bind(this._onContentError,this),seeking:p.bind(this._onContentSeeking,this),seeked:p.bind(this._onContentSeeked,this),stalled:p.bind(this._onContentBuffering,this),waiting:p.bind(this._onContentBuffering,this),canplay:p.bind(this._onContentBuffered,this),volumechange:p.bind(this._onContentVolume,this)},this._addEventListener=p.bind(this.addEventListener,this),this._removeEventListener=p.bind(this.removeEventListener,this),this._manuallyCallEnded=p.bind(this._manuallyCallEnded,this),this._playIfPlayerIsPaused=p.bind(this._playIfPlayerIsPaused,this),this._ensureLoadedMetaDataFiresOnce=p.bind(this._ensureLoadedMetaDataFiresOnce,this),this._endedWatch=g.eventually(this._manuallyCallEnded,1e3)},_setupEnsurePlayWhenAbleHandler:function(){this._ensurePlayWhenAbleHandler||(this._ensurePlayWhenAbleHandler=new c(this.element,"canplay",this._playIfPlayerIsPaused,!0).once())},_disposeEnsurePlayWhenAbleHandler:function(){this._ensurePlayWhenAbleHandler&&(this._ensurePlayWhenAbleHandler.dispose(),this._ensurePlayWhenAbleHandler=null)},_setupEnsureLoadedMetaDataHandler:function(){this._ensureLoadedMetaDataHandler||(this._ensureLoadedMetaDataHandler=new c(this.element,"loadedmetadata loadeddata playing",this._ensureLoadedMetaDataFiresOnce,!0).once())},_disposeEnsureLoadedMetaDataHandler:function(){this._ensureLoadedMetaDataHandler&&(this._ensureLoadedMetaDataHandler.dispose(),this._ensureLoadedMetaDataHandler=null)},_disposeEndedWatch:function(){this._endedWatch.stop(),this._endedWatch=null},_setupFullscreenMonitor:function(){this._fullscreenMonitor.setup(this),this._fullscreenMonitor.onFullscreenChange.addListener(this._onFullscreenChange,this),this._fullscreenMonitor.onFullscreenError.addListener(this._onFullscreenError,this)},_teardownFullscreenMonitor:function(){this._fullscreenMonitor&&(this._fullscreenMonitor.onFullscreenChange.removeListener(this._onFullscreenChange,this),this._fullscreenMonitor.onFullscreenError.removeListener(this._onFullscreenError,this),this._fullscreenMonitor.teardown())},_disposeFullscreenMonitor:function(){this._fullscreenMonitor&&(this._teardownFullscreenMonitor(),this._fullscreenMonitor.dispose(),this._fullscreenMonitor=null)},addEventListener:function(e,t){this.element.addEventListener(e,t,!1)},removeEventListener:function(e,t){this.element.removeEventListener(e,t,!1)},showControls:function(){return this.element?this.playerOptions.controls?(m.log("showControls","showing controls"),void(this.element.controls=!0)):void m.log("showControls","disallowed by configuration"):void m.warn("showControls","no video element")},hideControls:function(){return this.element?(m.log("hideControls","hiding controls"),void(this.element.controls=!1)):void m.warn("hideControls","no video element")},getPlayerElement:function(){return this.element},getVideoElement:function(){return this.element},getPlaybackRate:function(){return this.element&&this.element.playbackRate||1},getCurrentSrc:function(){return this.element&&this.element.currentSrc},getCurrentTime:function(){return this.element&&this.element.currentTime||0},getDuration:function(){return this.element&&this.element.duration||this._catalogEntry&&this._catalogEntry.getTrt()||0},dispose:function(){this.eRendered.removeListener(this.onRender,this),this._seekEndTimer.stop(),this._seekEndTimer=null,this._disposeFullscreenMonitor(),this._disposeEnsurePlayWhenAbleHandler(),this._disposeEnsureLoadedMetaDataHandler(),this._disposeEndedWatch(),this._pilotEpisode.onBuffering.removeListener(this._onContentBuffering,this),this._pilotEpisode.onConcluded.removeListener(this._onPilotConcluded,this),this.reset(),this._pilotEpisode.dispose(),this._pilotEpisode=null,this.remove(),this._videoElement=null,this.element=null},onRender:function(){this._setupEnsurePlayWhenAbleHandler(),this._setupEnsureLoadedMetaDataHandler(),this._setupFullscreenMonitor();var e=this._config.configInfo;e.volume&&this.setVolume(e.volume),e.muted&&this.mute()},firePause:function(){var e=this.getCurrentTime();this.ePlayerPaused.dispatch(this.getContentId(),this.getCurrentTime(),this._paused),this.eContentPause.dispatch(this.getContentId(),this._paused),this._lastPlayhead=e},fireBuffering:function(){this.eContentBuffering.dispatch(this.getContentId(),this._buffering)},fireMetadata:function(){this.eContentMetadata.dispatch(this.getContentId(),this.getDuration(),this.element.videoWidth,this.element.videoHeight)},firePlayhead:function(){var e=this.getCurrentTime();this.eContentPlayhead.dispatch(this.getContentId(),e,this.getDuration(),-1),this._lastPlayhead=e},fireSeek:function(){var e=this.getCurrentTime();this._seeking=!0,this.eContentSeek.dispatch(this.getContentId(),this._lastPlayhead,e,this.getDuration()),this._lastPlayhead=e},fireSeekEnd:function(){if(this._seeking){var e=this.getCurrentTime();this._seeking=!1,this._seekEndTimer.stop(),this.eContentSeekEnd.dispatch(this.getContentId(),this._timeAtSeekBegin,e,this.getDuration()),this._lastPlayhead=e}},_getCSSDimensionValue:function(e){var t=/^\d+$/;return t.test(e)?e+"px":e},_setCSSDimension:function(e,t,n){e.style[t]=this._getCSSDimensionValue(n)},_setWidth:function(e,t){this.width=t,this._setCSSDimension(e,"width",t)},_setHeight:function(e,t){this.height=t,this._setCSSDimension(e,"height",t)},_setAttribute:function(e,t){try{this.element.setAttribute(e,t)}catch(n){m.error('Exception thrown while attempting to set attribute "'+e+'" to value "'+t+'" ('+typeof t+"): "+n.message)}},_removeAttribute:function(e){try{this.element.removeAttribute(e)}catch(t){m.error('Exception thrown while attempting to remove attribute "'+e+'": '+t.message)}},embed:function(e){return this._videoElement.id=this.elementId,this._setWidth(this._videoElement,this.width),this._setHeight(this._videoElement,this.height),this._videoElement.src=u.BLANK_MP4_URL,this._videoElement.preload="none",this._videoElement.controls=this.playerOptions.controls,this._setWidth(e,this.width),this._setHeight(e,this.height),e.appendChild(this._videoElement),this._videoElement.parentNode===e?(this._videoElement=null,!0):!1},_onPilotConcluded:function(){var e=this.element.currentSrc;m.log("_onPilotConcluded",e),this._currentSrc=e,this.setDefaultOptions(),this.addPlayerListeners()},_resetPlayerStatesForPlayStart:function(){m.log("_resetPlayerStatesForPlayStart"),this._playlist.length=0,this._lastPlayhead=0,this._metadataEmitted=!1,this._playEmitted=!1,this._stopped=!1,this._paused=!1,this._buffering=!1,this._seeking=!1},enableCrossOrigin:function(){this._setAttribute("crossOrigin",this.options.crossOrigin||"anonymous")},disableCrossOrigin:function(){this._removeAttribute("crossOrigin")},play:function(e){m.log("play");var t=this._catalogEntry,n=this._currentSrc,i=this._catalogEntry=e||t;if(this._resetPlayerStatesForPlayStart(),i!==t||!n)switch(this._currentSrc=null,this._setPoster(),e.getClosedCaptions().length?(this.enableCrossOrigin(),this.element.innerHTML=this._getCaptionTrackMarkup(e)):(this.disableCrossOrigin(),this.element.innerHTML=""),this._updatePlaylist(this._playlist,i),this._playlist.length){case 0:return void this.eContentError.dispatch(this.getContentId(),"No content URL selected.");case 1:m.log("skipping Pilot Mode as there is only one video in the playlist"),this._currentSrc=this._playlist[0];break;default:this._pilotEpisode.start(this._playlist)}if(this._currentSrc){this.setDefaultOptions(),this.addPlayerListeners();var r=this._currentSrc,o=this.element;m.log("playing URL '"+r+"'"),o.src=r,o.load(),o.play()}},_getCaptionTrackMarkup:function(e,t){t||(t="en");var n,i=p.filter(e.getClosedCaptions(),function(e){return e.url});return i.length&&(n=p.find(i,function(e){return e.lang===t}),n||(n=p.find(i,function(e){return!e.lang})),n)?'<track kind="captions" label="'+n.label+'" srclang="'+n.lang+'" src="'+n.url+'" default>':""},_updatePlaylist:function(e,t){m.log("_updatePlaylist"),e.length=0,t.isExpired()?e.push(u.EXPIRED_MP4_URL):e.push.apply(e,this._fileSelectionHandler.getPlaylistForEntry(t)),m.debug("internal playlist ["+e.length+"]:",e)},pause:function(){this.element.pause()},resume:function(){this.element.play()},reset:function(){this.pause(),this._pilotEpisode.stop(),this.removePlayerListeners(),this._clearPoster(),this.hideControls(),this.disableCrossOrigin(),this._removeAttribute("src"),this.element.load()},stop:function(){this._stopped||(this._stopped=!0,this.reset(),this.ePlayerStopped.dispatch(this.getContentId()))},seek:function(e){this.element.currentTime=e},setVolume:function(e){this.element.volume=e},getVolume:function(){return this.element.volume},mute:function(){this.element.muted=!0},unmute:function(){this.element.muted=!1},isMuted:function(){return this.element.muted},resize:function(e,t){this._setWidth(this.element,e),this._setHeight(this.element,t),this._onContentResize()},getFullscreenElement:function(){return document.fullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement||document.mozFullscreenElement},_requestFullscreen:function(e){for(var t,n=["requestFullscreen","requestFullScreen","webkitRequestFullscreen","webkitRequestFullScreen","webkitEnterFullscreen","webkitEnterFullScreen","mozRequestFullScreen","msRequestFullscreen"],i=0,r=n.length;r>i;++i)if(t=n[i],t in e&&p.isFunction(e[t]))return e[t]()},_exitFullscreen:function(){for(var e,t=["exitFullscreen","cancelFullscreen","cancelFullScreen","webkitExitFullscreen","webkitExitFullScreen","webkitCancelFullscreen","webkitCancelFullScreen","mozCancelFullScreen","msExitFullscreen"],n=0,i=t.length;i>n;++n)if(e=t[n],e in document&&p.isFunction(document[e]))return document[e]();var r=this.getVideoElement();if(r===this.getPlayerElement()&&r.webkitDisplayingFullscreen)for(var o,s=["webkitExitFullscreen","webkitExitFullScreen"],a=0,l=s.length;l>a;++a)if(o=s[a],o in r&&p.isFunction(r[o]))return r[o]()},exitFullscreen:function(){try{this._exitFullscreen()}catch(e){m.debug("exitFullscreen failed",e)}},goFullscreen:function(){var e=this.element;if(this.getFullscreenElement()===e)try{this._exitFullscreen()}catch(t){m.error("goFullscreen failed to exit fullscreen",t.message)}else try{this._requestFullscreen(e)}catch(t){m.error("goFullscreen failed to enter fullscreen",t.message)}},getDimensions:function(){return{width:this.getWidth(),height:this.getHeight(),videoWidth:this.element.videoWidth,videoHeight:this.element.videoHeight}},setDefaultOptions:function(){this.setOptions(this.playerOptions)},setOptions:function(e){e=e||{},m.log("setOptions",e),p.each(e,function(e,t){void 0===t||null===t?this._removeAttribute(e):this._setAttribute(e,t)},this)},_clearPoster:function(){this.element.poster=""},_setPoster:function(e){var t=arguments.length?e:this.getThumbnail();m.log("_setPoster",t),this.element.poster=u.BLANK_IMG_URL,t&&(this.element.poster=t)},getThumbnail:function(){return this._catalogEntry?this._catalogEntry.getImageForDimensions(this.getWidth(),this.getHeight()):""},getWidth:function(){var e=p.getStyle(this.getPlayerElement(),"width");return e?p.toInt(e):this.width},getHeight:function(){var e=p.getStyle(this.getPlayerElement(),"height");return e?p.toInt(e):this.height},_ensureLoadedMetaDataFiresOnce:function(){this._metadataEmitted||(this._metadataEmitted=!0,this.fireMetadata())},_playIfPlayerIsPaused:function(){this._paused&&(m.log("Attempting to force play since the video element was found paused."),this.element.play())},_onLoadedData:function(){m.log("_onLoadedData"),this._ensurePlayWhenAbleHandler.on()},_onContentPlay:function(){m.log("_onContentPlay"),this._ended=!1,this._seeking&&this.fireSeekEnd(),this._paused&&(this._paused=!1,this.firePause()),this._playEmitted||(this._playEmitted=!0,this.firePlay(),this.firePlayhead())},_onContentPlaying:function(){m.log("_onContentPlaying"),this._clearPoster()},_onContentPause:function(){m.log("_onContentPause"),this._paused=!0,this.getCurrentTime()!==this.getDuration()&&this.firePause()},_onContentPlayhead:function(){if(!this._seeking&&!this._ended){var e=this.getCurrentTime();this._isDoingNothing()?(m.debug("Suspect that the video element did not emit 'ended' event."),this._startEndWatcher()):e!==this._lastPlayhead&&(this._stopEndWatcher(),this.updatePlayhead())}},_isDoingNothing:function(){return 0===p.toInt(this.getCurrentTime())&&Math.abs(this._lastPlayhead-this.getDuration())<2&&!this._stopped&&!this._paused&&!this._seeking&&!this._buffering},_startEndWatcher:function(){this._stopEndWatcher(),this._ended||this._endedWatch.start()},_manuallyCallEnded:function(){this._stopEndWatcher(),this._ended||(m.debug("Manually calling ended because the video element did not."),this._onContentEnd())},_stopEndWatcher:function(){this._endedWatch&&this._endedWatch.stop()},_onContentSeeking:function(){Math.abs(this.getCurrentTime()-this._lastPlayhead)<1||(this._seeking||(this._timeAtSeekBegin=this._lastPlayhead),this.fireSeek(),this._seeking&&this._deferSeekEnd())},_deferSeekEnd:function(){this._seekEndTimer.start()},_onContentSeeked:function(){return this._seeking?void this._deferSeekEnd():void m.debug("received 'seeked' while not seeking?")},_onContentEnd:function(){this._ended||(this._stopEndWatcher(),this._ended=!0,m.log("_onContentEnd"),this.firePlayhead(),this.fireEnded())},_onContentError:function(e){var t=e.target,n=t.error;if(t!==this.element)return void m.error("How can this be?  We've received an error from an element we're not listening to?");if(!n)return void m.error("How can this be?  We've received an 'error' event, but no 'error' property was set on the video element?");if(!i(n))return void m.warn("Received 'error' media event without accompanying error code; ignoring as false error, so content may continue.");var o=r(n);m.error("_onContentError",o),this.eContentError.dispatch(this.getContentId(),o)},_onContentBuffering:function(){return this._buffering?void m.log("_onContentBuffering: still buffering"):(m.log("_onContentBuffering"),this._buffering=!0,void this.fireBuffering())},_onContentBuffered:function(){return this._buffering?(m.log("_onContentBuffered"),this._buffering=!1,void this.fireBuffering()):void m.log("_onContentBuffered: not even buffering")},_onContentVolume:function(){m.log("_onContentVolume");var e=this.element.muted;this._muted!==e&&(this._muted=e,this.ePlayerMuted.dispatch(e)),this.eContentVolume.dispatch(e,this.element.volume)},_onContentResize:function(){m.log("_onContentResize"),this.eContentResize.dispatch(this.getWidth(),this.getHeight(),this._fullscreen)},_onFullscreenChange:function(e){m.log("_onFullscreenChange",e),this._fullscreen=e,this.eFullscreenChange.dispatch(this._fullscreen)},_onFullscreenError:function(){m.log("_onFullscreenError"),this.eFullscreenError.dispatch()},addPlayerListeners:function(){return m.log("addPlayerListeners"),this.element?this._addedListeners?void m.log("addPlayerListeners","already listening to events!"):(this._ensureLoadedMetaDataHandler.on(),p.each(this._eventListeners,this._addEventListener,this),void(this._addedListeners=!0)):void m.error("addPlayerListeners","cannot find element to listen to!")},removePlayerListeners:function(){return m.log("removePlayerListeners"),this.element?this._addedListeners?(this._ensureLoadedMetaDataHandler.off(),p.each(this._eventListeners,this._removeEventListener,this),this._pilotEpisode.stop(),void(this._addedListeners=!1)):void m.log("removePlayerListeners","already stopped listening to events!"):void m.error("removePlayerListeners","cannot find element to not listen to!")}});t.exports=v},{"../../core/app":10,"../../cvp/browser":14,"../../cvp/log":29,"../../cvp/static":39,"../../cvp/util/timing":50,"../../cvp/utils":52,"./baseplayer":84,"./domeventhandler":86,"./fileselection":87,"./fullscreenmonitor":88,"./pilotepisode":90}],93:[function(e,t,n){t.exports={params:{},mapping:{},appConfig:{},containerInfo:{},configInfo:{html5Order:"",html5Types:"",omniture:{},share:{},embed:{}},adPolicy:{ads:{attr:{type:"NONE"}}},trackingPolicy:{interval:"50%"}}},{}],94:[function(e,t,n){var i=e("../../vendor/Class"),r=e("../../cvp/utils"),o=e("../../cvp/log"),s=e("./trackingmanager"),a=e("../aspencontroller"),l=e("../../cvp/errors"),c=o.getLogger("AspenTracking"),u="content",d="ad",h=r.toFixed,p=i.extend({init:function(e){c.log("init"),this._playerController=e.playerController,this._cvpElementId=e.cvpElementId,this._trackingManager=new s({logger:o.getLogger("AspenTrackingManager"),playerController:this._playerController}),this._isListening=!1,this.listen(!0),a.isReady()?this.updateTrackingInterval():(this.setTrackingInterval("23"),this._watchAspenInit())},setTrackingInterval:function(e){c.log("setTrackingInterval",e),e=r.toInt(e)+"s",this._trackingManager.setTrackingInterval(e)},switchTrackingIntervalFor:function(e){var t;switch(e){case u:t=a.getConfig("progressReportInterval");break;case d:t=a.getConfig("adProgressReportInterval")}t&&(c.log("setting tracking interval for "+e+" to:",t),this.setTrackingInterval(t))},updateTrackingInterval:function(){c.log("updateTrackingInterval"),this._unwatchAspenInit(),this.switchTrackingIntervalFor(u)},_watchAspenInit:function(){a.eInitSuccess.addListener(this.updateTrackingInterval,this)},_unwatchAspenInit:function(){a.eInitSuccess.removeListener(this.updateTrackingInterval,this)},dispose:function(){c.log("dispose"),this._unwatchAspenInit(),this.listen(!1),this._trackingManager.dispose(),this._trackingManager=null},listen:function(e){if(c.log("listen",e),this._isListening===e)return void c.log("already "+(e?"":"not")+" listening");this._isListening=e;var t=e?"addListener":"removeListener";this._trackingManager.eTrackingAdStart[t](this._onTrackingAdStart,this),this._trackingManager.eTrackingAdComplete[t](this._onTrackingAdComplete,this),this._trackingManager.eTrackingAdProgress[t](this._onTrackingAdProgress,this),this._trackingManager.eTrackingAdError[t](this._onTrackingAdError,this),this._trackingManager.eTrackingContentBegin[t](this._onTrackingContentBegin,this),this._trackingManager.eTrackingContentStart[t](this._onTrackingContentStart,this),this._trackingManager.eTrackingContentProgress[t](this._onTrackingContentProgress,this),this._trackingManager.eTrackingContentEnd[t](this._onTrackingContentEnd,this),this._trackingManager.eTrackingContentComplete[t](this._onTrackingContentComplete,this),this._trackingManager.eTrackingContentSeekEnd[t](this._onTrackingContentSeekEnd,this),this._trackingManager.eTrackingPaused[t](this._onTrackingPaused,this)},getCurrentPlayer:function(){return this._playerManager.getCurrentPlayer()},_onTrackingAdInfo:function(e){c.log("_onTrackingAdInfo"),a.send("adInfo",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),adSection:e.adSection,adAssetId:e.adTitle,adSlotInfo:void 0})},_onTrackingAdError:function(e){c.log("_onTrackingAdError");var t=e.errorMessage,n=l.determineAdErrorCode(t);a.send("error",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),adType:e.adType,adBlockId:String(e.adBlock),errorMessage:t,errorCode:n})},_onTrackingAdStart:function(e){c.log("_onTrackingAdStart"),a.send("adStart",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),adType:e.adType,adBlockId:String(e.adBlock),adSection:e.adSection,adAssetId:e.adTitle,width:String(e.adWidth),height:String(e.adHeight),adDuration:String(e.adDuration),slotId:void 0,adInstances:void 0})},_onTrackingAdProgress:function(e){c.log("_onTrackingAdProgress"),a.send("adProgress",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),adType:e.adType,adBlockId:String(e.adBlock),adPlayHead:h(e.playheadTime),adDuration:h(e.adDuration),adTimeSpent:h(e.adTotalPlayTime),slotId:void 0,adInstances:void 0})},_onTrackingAdComplete:function(e){c.log("_onTrackingAdComplete"),a.send("adStop",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),adType:e.adType,adBlockId:String(e.adBlock),adAssetId:e.adTitle,slotId:void 0})},_onTrackingContentBegin:function(e){c.log("_onTrackingContentBegin"),a.videoCount+=1,a.send("contentStart",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),originId:e.originId,playOptions:e.playOptions,mode:e.contentMode,propertyName:e.contentSource})},_onTrackingContentStart:function(e){c.log("_onTrackingContentStart"),a.send("contentPlay",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),originId:e.originId,contentType:e.contentType,duration:String(e.length),joinTime:String(e.joinTime),mediaPath:e.mediaUrl,bandwidth:void 0,serverIp:void 0,ccAvailable:void 0,dvrAvailable:void 0})},_onTrackingContentProgress:function(e){c.log("_onTrackingContentProgress");var t="totalPlayTime"in e&&"adTotalPlayTime"in e?((e.totalPlayTime||0)-(e.adTotalPlayTime||0)).toFixed(3):void 0;a.send("contentProgress",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),originId:e.originId,timeSpentBuffering:void 0,timeSpentPlaying:t,playHead:h(e.playheadTime),playerWidth:String(e.playerWidth),playerHeight:String(e.playerHeight),ccAvailable:void 0,ccEnabled:void 0,ccTrackLang:void 0,dvrAvailable:void 0,dvrEnabled:void 0,dvrWindow:void 0,dvrStart:void 0})},_onTrackingPaused:function(e){c.log("_onTrackingPaused"),a.send("contentPause",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),contentPlayHead:h(e.playhead),isPaused:String(e.paused)})},_onTrackingContentSeekEnd:function(e){c.log("_onTrackingContentSeekEnd"),a.send("contentSeek",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),seekFrom:h(e.previousPlayhead),seekTo:h(e.newPlayhead),dvrAvailable:void 0,dvrEnabled:void 0})},_onTrackingContentEnd:function(e){c.log("_onTrackingContentEnd"),a.send("contentStop",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),playHead:h(e.playheadTime),segmentId:void 0})},_onTrackingContentComplete:function(e){c.log("_onTrackingContentComplete"),a.send("contentFinish",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount)})}});t.exports=p},{"../../cvp/errors":27,"../../cvp/log":29,"../../cvp/utils":52,"../../vendor/Class":96,"../aspencontroller":62,"./trackingmanager":95}],95:[function(e,t,n){var i=e("../../vendor/Class"),r=e("../../cvp/customevent"),o=e("../../cvp/log"),s=o.getLogger("TrackingManager"),a=i.extend({setLogger:function(e){this._logger=e},init:function(e){this.setLogger(e.logger||s),this._playerController=e.playerController,this._trackingInterval=0,this.eTrackingAdStart=new r,this.eTrackingAdComplete=new r,this.eTrackingAdError=new r,this.eTrackingAdProgress=new r,this.eTrackingAdCountdown=new r,this.eTrackingAdClick=new r,this.eTrackingContentBegin=new r,this.eTrackingContentPlay=new r,this.eTrackingContentStart=new r,this.eTrackingContentProgress=new r,this.eTrackingContentEnd=new r,this.eTrackingContentComplete=new r,this.eTrackingContentReplay=new r,this.eTrackingContentSeek=new r,this.eTrackingContentSeekEnd=new r,this.eTrackingFullscreen=new r,this.eTrackingMuted=new r,this.eTrackingPaused=new r,this.reset(),this._isListening=!1,this.listen(!0)},reset:function(){this._lastPlayhead=0,this._lastPercent=0,this._previousAdPlayhead=0,this._currentAdDuration=0,this._currentAdPlayhead=0,this._totalAdPlayTime=0,this._previousContentPlayhead=0,this._currentContentPlayhead=0,this._totalGrossPlayTime=0},dispose:function(){this.listen(!1),this._playerController=null,this._logger=null},getCatalogEntry:function(){return this._playerController.getCatalogEntry()},getPlayerDimensions:function(){return this._playerController.getPlayerDimensions()},getAdId:function(){return this._playerController.getAdId()},getAdType:function(){return this._playerController.getAdType()},getAdSection:function(){return this._playerController.getAdSection()},listen:function(e){if(this._isListening!==e){this._isListening=e;var t=e?"addListener":"removeListener";this._playerController.eAdPlay[t](this._onTrackingAdStart,this),this._playerController.eAdEnd[t](this._onTrackingAdComplete,this),this._playerController.eAdError[t](this._onTrackingAdError,this),this._playerController.eAdPlayhead[t](this._onTrackingAdProgress,this),this._playerController.eAdPlayhead[t](this._onTrackingAdCountdown,this),this._playerController.eAdClick[t](this._onTrackingAdClick,this),this._playerController.eContentBegin[t](this._onTrackingContentBegin,this),
this._playerController.eContentPlay[t](this._onTrackingContentPlay,this),this._playerController.eContentStart[t](this._onTrackingContentStart,this),this._playerController.eContentPlayhead[t](this._onTrackingContentProgress,this),this._playerController.eContentEnd[t](this._onTrackingContentEnd,this),this._playerController.eContentComplete[t](this._onTrackingContentComplete,this),this._playerController.eContentReplay[t](this._onTrackingContentReplay,this),this._playerController.eContentSeek[t](this._onTrackingContentSeek,this),this._playerController.eContentSeekEnd[t](this._onTrackingContentSeekEnd,this),this._playerController.eFullscreenChange[t](this._onTrackingFullscreen,this),this._playerController.ePlayerPaused[t](this._onTrackingPaused,this),this._playerController.ePlayerMuted[t](this._onTrackingMuted,this)}},_canEmitProgress:function(e,t){var n=this._trackingInterval;if(!n)return!1;var i=Math.floor(e),r=Math.floor(e/t*100),o=!1,s=this._intervalRegex.exec(n),a=Number(s[1]),l=s[2];return isNaN(t)&&"%"===l&&(a=30,l="s"),"s"===l&&(a>t?(a=50,l="%"):i!==this._lastPlayhead&&i%a===0&&(o=!0)),"%"===l&&r!==this._lastPercent&&100>r&&r%a===0&&(o=!0),o&&(this._lastPlayhead=i,this._lastPercent=r),o},_onTrackingAdStart:function(e,t,n,i,r,o,s){this._logger.log("_onTrackingAdStart",arguments),this._lastPlayhead=0,this._lastPercent=0,this._previousAdPlayhead=0,this._currentAdPlayhead=0,this._currentAdDuration=0;var a=this.getPlayerDimensions(),l=this.getCatalogEntry();this.eTrackingAdStart.dispatch({adTitle:n,adWidth:a.videoWidth,adHeight:a.videoHeight,adSection:this.getAdSection(),contentId:l.getId(),originId:l.getOriginId(),mediaUrl:l.getMediaUrl(),adType:o,adDuration:i,adBlock:r,totalPlayTime:this._totalGrossPlayTime,adTotalPlayTime:this._totalAdPlayTime,adAnalyticsData:s})},_onTrackingAdComplete:function(e,t,n,i,r){this._logger.log("_onTrackingAdComplete",arguments);var o=this.getCatalogEntry();this.eTrackingAdComplete.dispatch({contentId:o.getId(),adTitle:n,adType:r,adBlock:i,totalPlayTime:this._totalGrossPlayTime,adTotalPlayTime:this._totalAdPlayTime})},_onTrackingAdError:function(e,t,n,i){this._logger.log("_onTrackingAdError",arguments);var r=this.getCatalogEntry();this.eTrackingAdError.dispatch({contentId:r.getId(),errorMessage:e,adType:n,adBlock:t,errors:i})},_onTrackingAdProgress:function(e,t,n){this._currentAdPlayhead=e,this._currentAdDuration=t;var i=e-this._previousAdPlayhead;this._previousAdPlayhead=e,0>=i||i>=1.25||(this._totalAdPlayTime+=i,this._totalGrossPlayTime+=i,this._canEmitProgress(e,t)&&this.eTrackingAdProgress.dispatch({totalPlayTime:this._totalGrossPlayTime,playheadTime:this._currentAdPlayhead,adDuration:this._currentAdDuration,grossProgressMarker:0,adType:this.getAdType(),adBlock:n,adTotalPlayTime:this._totalAdPlayTime}))},_onTrackingAdCountdown:function(e,t){var n=Math.ceil(t-e);n>0&&n!==this._previousAdCountdown&&(this._previousAdCountdown=n,this.eTrackingAdCountdown.dispatch({adMode:"standard",secs:n}))},_onTrackingAdClick:function(e){this._logger.log("_onTrackingAdClick",arguments);var t=this.getCatalogEntry();this.eTrackingAdClick.dispatch({contentId:t.getId(),url:e})},_onTrackingContentBegin:function(e,t){this._logger.log("_onTrackingContentBegin",arguments),this.reset();var n=this.getCatalogEntry();this.eTrackingContentBegin.dispatch({contentId:n.getId(),playOptions:t,originId:n.getOriginId(),contentMode:n.getMode(),contentSource:n.getSource(),totalPlayTime:this._totalGrossPlayTime,adTotalPlayTime:this._totalAdPlayTime})},_onTrackingContentPlay:function(){this._logger.log("_onTrackingContentPlay",arguments),this._lastPlayhead=0,this._lastPercent=0;var e=this.getCatalogEntry();this.eTrackingContentPlay.dispatch({contentId:e.getId(),originId:e.getOriginId(),mediaUrl:e.getMediaUrl(),length:e.getTrt(),grossLength:e.getTrt(),totalPlayTime:this._totalGrossPlayTime,adTotalPlayTime:this._totalAdPlayTime})},_onTrackingContentStart:function(e,t){this._logger.log("_onTrackingContentStart",arguments);var n=this.getCatalogEntry();this.eTrackingContentStart.dispatch({contentId:n.getId(),originId:n.getOriginId(),mediaUrl:n.getMediaUrl(),joinTime:t,length:n.getTrt(),grossLength:n.getTrt(),totalPlayTime:this._totalGrossPlayTime,adTotalPlayTime:this._totalAdPlayTime})},_onTrackingContentProgress:function(e,t,n){this._currentContentPlayhead=t;var i=t-this._previousContentPlayhead;if(this._previousContentPlayhead=t,!(0>=i||i>=1.25)&&(this._totalGrossPlayTime+=i,this._canEmitProgress(t,n))){var r=this.getCatalogEntry(),o=this.getPlayerDimensions();this.eTrackingContentProgress.dispatch({contentId:r.getId(),originId:r.getOriginId(),playerWidth:o.width,playerHeight:o.height,percent:t/n*100,totalPlayTime:this._totalGrossPlayTime,playheadTime:this._currentContentPlayhead,progressMarker:0,grossProgressMarker:0,adTotalPlayTime:this._totalAdPlayTime})}},_onTrackingContentEnd:function(){this._logger.log("_onTrackingContentEnd",arguments);var e=this.getCatalogEntry();this.eTrackingContentEnd.dispatch({contentId:e.getId(),totalPlayTime:this._totalGrossPlayTime,playheadTime:this._currentContentPlayhead,adTotalPlayTime:this._totalAdPlayTime})},_onTrackingContentComplete:function(){this._logger.log("_onTrackingContentComplete",arguments);var e=this.getCatalogEntry();this.eTrackingContentComplete.dispatch({contentId:e.getId(),percent:100,totalPlayTime:this._totalGrossPlayTime,playheadTime:this._currentContentPlayhead,progressMarker:0,grossProgressMarker:0,adTotalPlayTime:this._totalAdPlayTime})},_onTrackingContentReplay:function(e,t){this._logger.log("_onTrackingContentReplay",arguments),this.eTrackingContentReplay.dispatch({contentId:e,additionalParams:t})},_onTrackingContentSeek:function(e,t,n,i){this._logger.log("_onTrackingContentSeek",arguments),this.eTrackingContentSeek.dispatch({contentId:e,previousPlayhead:t,newPlayhead:n,duration:i})},_onTrackingContentSeekEnd:function(e,t,n,i){this._logger.log("_onTrackingContentSeekEnd",arguments),this.eTrackingContentSeekEnd.dispatch({contentId:e,previousPlayhead:t,newPlayhead:n,duration:i})},_onTrackingFullscreen:function(e,t){this._logger.log("_onTrackingFullscreen",arguments),this.eTrackingFullscreen.dispatch({contentId:e,fullscreen:t})},_onTrackingMuted:function(e,t){this._logger.log("_onTrackingMuted",arguments),this.eTrackingMuted.dispatch({contentId:e,muted:t})},_onTrackingPaused:function(e,t,n){this._logger.log("_onTrackingPaused",arguments),this.eTrackingPaused.dispatch({contentId:e,playhead:t,paused:n})},_intervalRegex:/(\d+)([s%])?/,setTrackingInterval:function(e){if(!e)return void(this._trackingInterval=0);var t=this._intervalRegex.exec(String(e));if(!t)return void this._logger.error('setTrackingInterval param "'+e+'" did not match accepted regex');var n=t[1],i=t[2]||"%";n>100&&(i="s"),this._trackingInterval=n+i}});t.exports=a},{"../../cvp/customevent":18,"../../cvp/log":29,"../../vendor/Class":96}],96:[function(e,t,n){var i=!1,r=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,o=function(){};o.extend=function s(e){function t(){!i&&this.init&&this.init.apply(this,arguments)}var n=this.prototype;i=!0;var o=new this;i=!1;for(var a in e)o[a]="function"==typeof e[a]&&"function"==typeof n[a]&&r.test(e[a])?function(e,t){return function(){var i=this._super;this._super=n[e];var r=t.apply(this,arguments);return this._super=i,r}}(a,e[a]):e[a];return t.prototype=o,t.prototype.constructor=t,t.extend=s,t},t.exports=o},{}],97:[function(e,t,n){t.exports=function(e,t,n,i,r,o){function s(e,t){var n=typeof e[t];return"function"==n||!("object"!=n||!e[t])||"unknown"==n}function a(e,t){return!("object"!=typeof e[t]||!e[t])}function l(e){return"[object Array]"===Object.prototype.toString.call(e)}function c(){var e="Shockwave Flash",t="application/x-shockwave-flash";if(!y(navigator.plugins)&&"object"==typeof navigator.plugins[e]){var n=navigator.plugins[e].description;n&&!y(navigator.mimeTypes)&&navigator.mimeTypes[t]&&navigator.mimeTypes[t].enabledPlugin&&(P=n.match(/\d+/g))}if(!P){var i;try{i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),P=Array.prototype.slice.call(i.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1),i=null}catch(r){}}if(!P)return!1;var o=parseInt(P[0],10),s=parseInt(P[1],10);return x=o>9&&s>0,!0}function u(){if(!Q){Q=!0;for(var e=0;e<H.length;e++)H[e]();H.length=0}}function d(e,t){return Q?void e.call(t):void H.push(function(){e.call(t)})}function h(){var e=parent;if(""!==j)for(var t=0,n=j.split(".");t<n.length;t++)e=e[n[t]];return e.easyXDM}function p(t){return e.easyXDM=U,j=t,j&&(q="easyXDM_"+j.replace(".","_")+"_"),B}function f(e){return e.match(F)[3]}function g(e){return e.match(F)[4]||""}function m(e){var t=e.toLowerCase().match(F),n=t[2],i=t[3],r=t[4]||"";return("http:"==n&&":80"==r||"https:"==n&&":443"==r)&&(r=""),n+"//"+i+r}function _(e){if(e=e.replace(N,"$1/"),!e.match(/^(http||https):\/\//)){var t="/"===e.substring(0,1)?"":n.pathname;"/"!==t.substring(t.length-1)&&(t=t.substring(0,t.lastIndexOf("/")+1)),e=n.protocol+"//"+n.host+t+e}for(;M.test(e);)e=e.replace(M,"");return e}function v(e,t){var n="",i=e.indexOf("#");-1!==i&&(n=e.substring(i),e=e.substring(0,i));var r=[];for(var s in t)t.hasOwnProperty(s)&&r.push(s+"="+o(t[s]));return e+(V?"#":-1==e.indexOf("?")?"?":"&")+r.join("&")+n}function y(e){return"undefined"==typeof e}function C(e,t,n){var i;for(var r in t)t.hasOwnProperty(r)&&(r in e?(i=t[r],"object"==typeof i?C(e[r],i,n):n||(e[r]=t[r])):e[r]=t[r]);return e}function w(){var e=t.body.appendChild(t.createElement("form")),n=e.appendChild(t.createElement("input"));n.name=q+"TEST"+D,k=n!==e.elements[n.name],t.body.removeChild(e)}function b(e){y(k)&&w();var n;k?n=t.createElement('<iframe name="'+e.props.name+'"/>'):(n=t.createElement("IFRAME"),n.name=e.props.name),n.id=n.name=e.props.name,delete e.props.name,"string"==typeof e.container&&(e.container=t.getElementById(e.container)),e.container||(C(n.style,{position:"absolute",top:"-2000px",left:"0px"}),e.container=t.body);var i=e.props.src;if(e.props.src="javascript:false",C(n,e.props),n.border=n.frameBorder=0,n.allowTransparency=!0,e.container.appendChild(n),e.onLoad&&I(n,"load",e.onLoad),e.usePost){var r,o=e.container.appendChild(t.createElement("form"));if(o.target=n.name,o.action=i,o.method="POST","object"==typeof e.usePost)for(var s in e.usePost)e.usePost.hasOwnProperty(s)&&(k?r=t.createElement('<input name="'+s+'"/>'):(r=t.createElement("INPUT"),r.name=s),r.value=e.usePost[s],o.appendChild(r));o.submit(),o.parentNode.removeChild(o)}else n.src=i;return e.props.src=i,n}function E(e,t){"string"==typeof e&&(e=[e]);for(var n,i=e.length;i--;)if(n=e[i],n=new RegExp("^"==n.substr(0,1)?n:"^"+n.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"),n.test(t))return!0;return!1}function A(i){var r,o=i.protocol;if(i.isHost=i.isHost||y(K.xdm_p),V=i.hash||!1,i.props||(i.props={}),i.isHost)i.remote=_(i.remote),i.channel=i.channel||"default"+D++,i.secret=Math.random().toString(16).substring(2),y(o)&&(o=m(n.href)==m(i.remote)?"4":s(e,"postMessage")||s(t,"postMessage")?"1":i.swf&&s(e,"ActiveXObject")&&c()?"6":"Gecko"===navigator.product&&"frameElement"in e&&-1==navigator.userAgent.indexOf("WebKit")?"5":i.remoteHelper?"2":"0");else if(i.channel=K.xdm_c.replace(/["'<>\\]/g,""),i.secret=K.xdm_s,i.remote=K.xdm_e.replace(/["'<>\\]/g,""),o=K.xdm_p,i.acl&&!E(i.acl,i.remote))throw new Error("Access denied for "+i.remote);switch(i.protocol=o,o){case"0":if(C(i,{interval:100,delay:2e3,useResize:!0,useParent:!1,usePolling:!1},!0),i.isHost){if(!i.local){for(var a,l=n.protocol+"//"+n.host,u=t.body.getElementsByTagName("img"),d=u.length;d--;)if(a=u[d],a.src.substring(0,l.length)===l){i.local=a.src;break}i.local||(i.local=e)}var h={xdm_c:i.channel,xdm_p:0};i.local===e?(i.usePolling=!0,i.useParent=!0,i.local=n.protocol+"//"+n.host+n.pathname+n.search,h.xdm_e=i.local,h.xdm_pa=1):h.xdm_e=_(i.local),i.container&&(i.useResize=!1,h.xdm_po=1),i.remote=v(i.remote,h)}else C(i,{channel:K.xdm_c,remote:K.xdm_e,useParent:!y(K.xdm_pa),usePolling:!y(K.xdm_po),useResize:i.useParent?!1:i.useResize});r=[new B.stack.HashTransport(i),new B.stack.ReliableBehavior({}),new B.stack.QueueBehavior({encode:!0,maxLength:4e3-i.remote.length}),new B.stack.VerifyBehavior({initiate:i.isHost})];break;case"1":r=[new B.stack.PostMessageTransport(i)];break;case"2":i.isHost&&(i.remoteHelper=_(i.remoteHelper)),r=[new B.stack.NameTransport(i),new B.stack.QueueBehavior,new B.stack.VerifyBehavior({initiate:i.isHost})];break;case"3":r=[new B.stack.NixTransport(i)];break;case"4":r=[new B.stack.SameOriginTransport(i)];break;case"5":r=[new B.stack.FrameElementTransport(i)];break;case"6":P||c(),r=[new B.stack.FlashTransport(i)]}return r.push(new B.stack.QueueBehavior({lazy:i.lazy,remove:!0})),r}function T(e){for(var t,n={incoming:function(e,t){this.up.incoming(e,t)},outgoing:function(e,t){this.down.outgoing(e,t)},callback:function(e){this.up.callback(e)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}},i=0,r=e.length;r>i;i++)t=e[i],C(t,n,!0),0!==i&&(t.down=e[i-1]),i!==r-1&&(t.up=e[i+1]);return t}function S(e){e.up.down=e.down,e.down.up=e.up,e.up=e.down=null}var k,P,x,I,R,L=this,D=Math.floor(1e4*Math.random()),O=Function.prototype,F=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,M=/[\-\w]+\/\.\.\//,N=/([^:])\/\//g,j="",B={},U=e.easyXDM,q="easyXDM_",V=!1;if(s(e,"addEventListener"))I=function(e,t,n){e.addEventListener(t,n,!1)},R=function(e,t,n){e.removeEventListener(t,n,!1)};else{if(!s(e,"attachEvent"))throw new Error("Browser not supported");I=function(e,t,n){e.attachEvent("on"+t,n)},R=function(e,t,n){e.detachEvent("on"+t,n)}}var z,Q=!1,H=[];if("readyState"in t?(z=t.readyState,Q="complete"==z||~navigator.userAgent.indexOf("AppleWebKit/")&&("loaded"==z||"interactive"==z)):Q=!!t.body,!Q){if(s(e,"addEventListener"))I(t,"DOMContentLoaded",u);else if(I(t,"readystatechange",function(){"complete"==t.readyState&&u()}),t.documentElement.doScroll&&e===top){var W=function(){if(!Q){try{t.documentElement.doScroll("left")}catch(e){return void i(W,1)}u()}};W()}I(e,"load",u)}var K=function(e){e=e.substring(1).split("&");for(var t,n={},i=e.length;i--;)t=e[i].split("="),n[t[0]]=r(t[1]);return n}(/xdm_e=/.test(n.search)?n.search:n.hash),$=function(){var e={},t={a:[1,2,3]},n='{"a":[1,2,3]}';return"undefined"!=typeof JSON&&"function"==typeof JSON.stringify&&JSON.stringify(t).replace(/\s/g,"")===n?JSON:(Object.toJSON&&Object.toJSON(t).replace(/\s/g,"")===n&&(e.stringify=Object.toJSON),"function"==typeof String.prototype.evalJSON&&(t=n.evalJSON(),t.a&&3===t.a.length&&3===t.a[2]&&(e.parse=function(e){return e.evalJSON()})),e.stringify&&e.parse?($=function(){return e},e):null)};return C(B,{version:"2.4.19.3",query:K,stack:{},apply:C,getJSONObject:$,whenReady:d,noConflict:p}),B.DomHelper={on:I,un:R,requiresJSON:function(n){a(e,"JSON")||t.write('<script type="text/javascript" src="'+n+'"></script>')}},function(){var e={};B.Fn={set:function(t,n){e[t]=n},get:function(t,n){if(e.hasOwnProperty(t)){var i=e[t];return n&&delete e[t],i}}}}(),B.Socket=function(e){var t=T(A(e).concat([{incoming:function(t,n){e.onMessage(t,n)},callback:function(t){e.onReady&&e.onReady(t)}}])),n=m(e.remote);this.origin=m(e.remote),this.destroy=function(){t.destroy()},this.postMessage=function(e){t.outgoing(e,n)},t.init()},B.Rpc=function(e,t){if(t.local)for(var n in t.local)if(t.local.hasOwnProperty(n)){var i=t.local[n];"function"==typeof i&&(t.local[n]={method:i})}var r=T(A(e).concat([new B.stack.RpcBehavior(this,t),{callback:function(t){e.onReady&&e.onReady(t)}}]));this.origin=m(e.remote),this.destroy=function(){r.destroy()},r.init()},B.stack.SameOriginTransport=function(e){var t,r,o,s;return t={outgoing:function(e,t,n){o(e),n&&n()},destroy:function(){r&&(r.parentNode.removeChild(r),r=null)},onDOMReady:function(){s=m(e.remote),e.isHost?(C(e.props,{src:v(e.remote,{xdm_e:n.protocol+"//"+n.host+n.pathname,xdm_c:e.channel,xdm_p:4}),name:q+e.channel+"_provider"}),r=b(e),B.Fn.set(e.channel,function(e){return o=e,i(function(){t.up.callback(!0)},0),function(e){t.up.incoming(e,s)}})):(o=h().Fn.get(e.channel,!0)(function(e){t.up.incoming(e,s)}),i(function(){t.up.callback(!0)},0))},init:function(){d(t.onDOMReady,t)}}},B.stack.FlashTransport=function(e){function r(e,t){i(function(){a.up.incoming(e,c)},0)}function s(n){var i=e.swf+"?host="+e.isHost,r="easyXDM_swf_"+Math.floor(1e4*Math.random());B.Fn.set("flash_loaded"+n.replace(/[\-.]/g,"_"),function(){B.stack.FlashTransport[n].swf=u=h.firstChild;for(var e=B.stack.FlashTransport[n].queue,t=0;t<e.length;t++)e[t]();e.length=0}),e.swfContainer?h="string"==typeof e.swfContainer?t.getElementById(e.swfContainer):e.swfContainer:(h=t.createElement("div"),C(h.style,x&&e.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0}),t.body.appendChild(h));var s="callback=flash_loaded"+o(n.replace(/[\-.]/g,"_"))+"&proto="+L.location.protocol+"&domain="+o(f(L.location.href))+"&port="+o(g(L.location.href))+"&ns="+o(j);h.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+r+"' data='"+i+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+i+"'></param><param name='flashvars' value='"+s+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+s+"' allowScriptAccess='always' wmode='transparent' src='"+i+"' height='1' width='1'></embed></object>"}var a,l,c,u,h;return a={outgoing:function(t,n,i){u.postMessage(e.channel,t.toString()),i&&i()},destroy:function(){try{u.destroyChannel(e.channel)}catch(t){}u=null,l&&(l.parentNode.removeChild(l),l=null)},onDOMReady:function(){c=e.remote,B.Fn.set("flash_"+e.channel+"_init",function(){i(function(){a.up.callback(!0)})}),B.Fn.set("flash_"+e.channel+"_onMessage",r),e.swf=_(e.swf);var t=f(e.swf),o=function(){B.stack.FlashTransport[t].init=!0,u=B.stack.FlashTransport[t].swf,u.createChannel(e.channel,e.secret,m(e.remote),e.isHost),e.isHost&&(x&&e.swfNoThrottle&&C(e.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"}),C(e.props,{src:v(e.remote,{xdm_e:m(n.href),xdm_c:e.channel,xdm_p:6,xdm_s:e.secret}),name:q+e.channel+"_provider"}),l=b(e))};B.stack.FlashTransport[t]&&B.stack.FlashTransport[t].init?o():B.stack.FlashTransport[t]?B.stack.FlashTransport[t].queue.push(o):(B.stack.FlashTransport[t]={queue:[o]},s(t))},init:function(){d(a.onDOMReady,a)}}},B.stack.PostMessageTransport=function(t){function r(e){if(e.origin)return m(e.origin);if(e.uri)return m(e.uri);if(e.domain)return n.protocol+"//"+e.domain;throw"Unable to retrieve the origin of the event"}function o(e){var n=r(e);n==c&&e.data.substring(0,t.channel.length+1)==t.channel+" "&&s.up.incoming(e.data.substring(t.channel.length+1),n)}var s,a,l,c;return s={outgoing:function(e,n,i){l.postMessage(t.channel+" "+e,n||c),i&&i()},destroy:function(){R(e,"message",o),a&&(l=null,a.parentNode.removeChild(a),a=null)},onDOMReady:function(){if(c=m(t.remote),t.isHost){var r=function(n){n.data==t.channel+"-ready"&&(l="postMessage"in a.contentWindow?a.contentWindow:a.contentWindow.document,R(e,"message",r),I(e,"message",o),i(function(){s.up.callback(!0)},0))};I(e,"message",r),C(t.props,{src:v(t.remote,{xdm_e:m(n.href),xdm_c:t.channel,xdm_p:1}),name:q+t.channel+"_provider"}),a=b(t)}else I(e,"message",o),l="postMessage"in e.parent?e.parent:e.parent.document,l.postMessage(t.channel+"-ready",c),i(function(){s.up.callback(!0)},0)},init:function(){d(s.onDOMReady,s)}}},B.stack.FrameElementTransport=function(r){var o,s,a,l;return o={outgoing:function(e,t,n){a.call(this,e),n&&n()},destroy:function(){s&&(s.parentNode.removeChild(s),s=null)},onDOMReady:function(){l=m(r.remote),r.isHost?(C(r.props,{src:v(r.remote,{xdm_e:m(n.href),xdm_c:r.channel,xdm_p:5}),name:q+r.channel+"_provider"}),s=b(r),s.fn=function(e){return delete s.fn,a=e,i(function(){o.up.callback(!0)},0),function(e){o.up.incoming(e,l)}}):(t.referrer&&m(t.referrer)!=K.xdm_e&&(e.top.location=K.xdm_e),a=e.frameElement.fn(function(e){o.up.incoming(e,l)}),o.up.callback(!0))},init:function(){d(o.onDOMReady,o)}}},B.stack.NameTransport=function(e){function t(t){var n=e.remoteHelper+(a?"#_3":"#_2")+e.channel;l.contentWindow.sendMessage(t,n)}function n(){a?2!==++u&&a||s.up.callback(!0):(t("ready"),s.up.callback(!0))}function r(e){s.up.incoming(e,p)}function o(){h&&i(function(){h(!0)},0)}var s,a,l,c,u,h,p,f;return s={outgoing:function(e,n,i){h=i,t(e)},destroy:function(){l.parentNode.removeChild(l),l=null,a&&(c.parentNode.removeChild(c),c=null)},onDOMReady:function(){a=e.isHost,u=0,p=m(e.remote),e.local=_(e.local),a?(B.Fn.set(e.channel,function(t){a&&"ready"===t&&(B.Fn.set(e.channel,r),n())}),f=v(e.remote,{xdm_e:e.local,xdm_c:e.channel,xdm_p:2}),C(e.props,{src:f+"#"+e.channel,name:q+e.channel+"_provider"}),c=b(e)):(e.remoteHelper=e.remote,B.Fn.set(e.channel,r));var t=function(){var r=l||this;R(r,"load",t),B.Fn.set(e.channel+"_load",o),function s(){"function"==typeof r.contentWindow.sendMessage?n():i(s,50)}()};l=b({props:{src:e.local+"#_4"+e.channel},onLoad:t})},init:function(){d(s.onDOMReady,s)}}},B.stack.HashTransport=function(t){function n(e){if(g){var n=t.remote+"#"+p++ +"_"+e;(l||!_?g.contentWindow:g).location=n}}function r(e){h=e,a.up.incoming(h.substring(h.indexOf("_")+1),v)}function o(){if(f){var e=f.location.href,t="",n=e.indexOf("#");-1!=n&&(t=e.substring(n)),t&&t!=h&&r(t)}}function s(){c=setInterval(o,u)}var a,l,c,u,h,p,f,g,_,v;return a={outgoing:function(e,t){n(e)},destroy:function(){e.clearInterval(c),!l&&_||g.parentNode.removeChild(g),g=null},onDOMReady:function(){if(l=t.isHost,u=t.interval,h="#"+t.channel,p=0,_=t.useParent,v=m(t.remote),l){if(C(t.props,{src:t.remote,name:q+t.channel+"_provider"}),_)t.onLoad=function(){f=e,s(),a.up.callback(!0)};else{var n=0,r=t.delay/50;!function o(){if(++n>r)throw new Error("Unable to reference listenerwindow");try{f=g.contentWindow.frames[q+t.channel+"_consumer"]}catch(e){}f?(s(),a.up.callback(!0)):i(o,50)}()}g=b(t)}else f=e,s(),_?(g=parent,a.up.callback(!0)):(C(t,{props:{src:t.remote+"#"+t.channel+new Date,name:q+t.channel+"_consumer"},onLoad:function(){a.up.callback(!0)}}),g=b(t))},init:function(){d(a.onDOMReady,a)}}},B.stack.ReliableBehavior=function(e){var t,n,i=0,r=0,o="";return t={incoming:function(e,s){var a=e.indexOf("_"),l=e.substring(0,a).split(",");e=e.substring(a+1),l[0]==i&&(o="",n&&n(!0)),e.length>0&&(t.down.outgoing(l[1]+","+i+"_"+o,s),r!=l[1]&&(r=l[1],t.up.incoming(e,s)))},outgoing:function(e,s,a){o=e,n=a,t.down.outgoing(r+","+ ++i+"_"+e,s)}}},B.stack.QueueBehavior=function(e){function t(){if(e.remove&&0===a.length)return void S(n);if(!l&&0!==a.length&&!s){l=!0;var r=a.shift();n.down.outgoing(r.data,r.origin,function(e){l=!1,r.callback&&i(function(){r.callback(e)},0),t()})}}var n,s,a=[],l=!0,c="",u=0,d=!1,h=!1;return n={init:function(){y(e)&&(e={}),e.maxLength&&(u=e.maxLength,h=!0),e.lazy?d=!0:n.down.init()},callback:function(e){l=!1;var i=n.up;t(),i.callback(e)},incoming:function(t,i){if(h){var o=t.indexOf("_"),s=parseInt(t.substring(0,o),10);c+=t.substring(o+1),0===s&&(e.encode&&(c=r(c)),n.up.incoming(c,i),c="")}else n.up.incoming(t,i)},outgoing:function(i,r,s){e.encode&&(i=o(i));var l,c=[];if(h){for(;0!==i.length;)l=i.substring(0,u),i=i.substring(l.length),c.push(l);for(;l=c.shift();)a.push({data:c.length+"_"+l,origin:r,callback:0===c.length?s:null})}else a.push({data:i,origin:r,callback:s});d?n.down.init():t()},destroy:function(){s=!0,n.down.destroy()}}},B.stack.VerifyBehavior=function(e){function t(){i=Math.random().toString(16).substring(2),n.down.outgoing(i)}var n,i,r;return n={incoming:function(o,s){var a=o.indexOf("_");-1===a?o===i?n.up.callback(!0):r||(r=o,e.initiate||t(),n.down.outgoing(o)):o.substring(0,a)===r&&n.up.incoming(o.substring(a+1),s)},outgoing:function(e,t,r){n.down.outgoing(i+"_"+e,t,r)},callback:function(n){e.initiate&&t()}}},B.stack.RpcBehavior=function(e,t){function n(e){e.jsonrpc="2.0",o.down.outgoing(s.stringify(e))}function i(e,t){var i=Array.prototype.slice;return function(){var r,o=arguments.length,s={method:t};o>0&&"function"==typeof arguments[o-1]?(o>1&&"function"==typeof arguments[o-2]?(r={success:arguments[o-2],error:arguments[o-1]},s.params=i.call(arguments,0,o-2)):(r={success:arguments[o-1]},s.params=i.call(arguments,0,o-1)),c[""+ ++a]=r,s.id=a):s.params=i.call(arguments,0),e.namedParams&&1===s.params.length&&(s.params=s.params[0]),n(s)}}function r(e,t,i,r){if(!i)return void(t&&n({id:t,error:{code:-32601,message:"Procedure not found."}}));var o,s;t?(o=function(e){o=O,n({id:t,result:e})},s=function(e,i){s=O;var r={id:t,error:{code:-32099,message:e}};i&&(r.error.data=i),n(r)}):o=s=O,l(r)||(r=[r]);try{var a=i.method.apply(i.scope,r.concat([o,s]));y(a)||o(a)}catch(c){s(c.message)}}var o,s=t.serializer||$(),a=0,c={};return o={incoming:function(e,i){var o=s.parse(e);if(o.method)t.handle?t.handle(o,n):r(o.method,o.id,t.local[o.method],o.params);else{var a=c[o.id];o.error?a.error&&a.error(o.error):a.success&&a.success(o.result),delete c[o.id]}},init:function(){if(t.remote)for(var n in t.remote)t.remote.hasOwnProperty(n)&&(e[n]=i(t.remote[n],n));o.down.init()},destroy:function(){for(var n in t.remote)t.remote.hasOwnProperty(n)&&e.hasOwnProperty(n)&&delete e[n];o.down.destroy()}}},B}(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent)},{}],98:[function(e,t,n){function i(e,t){function n(e){if(n[e]!==m)return n[e];var i;if("bug-string-char-index"==e)i="a"!="a"[0];else if("json"==e)i=n("json-stringify")&&n("json-parse");else{var r,o='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var l=t.stringify,u="function"==typeof l&&y;if(u){(r=function(){return 1}).toJSON=r;try{u="0"===l(0)&&"0"===l(new s)&&'""'==l(new a)&&l(v)===m&&l(m)===m&&"1"===l(r)&&"[1]"==l([r])&&"[null]"==l([m])&&"null"==l(null)&&"[null,null,null]"==l([m,v,null])&&l({a:[r,!0,!1,null,"\x00\b\n\f\r	"]})==o&&"1"===l(null,r)&&"[\n 1,\n 2\n]"==l([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==l(new c(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==l(new c(864e13))&&'"-000001-01-01T00:00:00.000Z"'==l(new c(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==l(new c(-1))}catch(d){u=!1}}i=u}if("json-parse"==e){var h=t.parse;if("function"==typeof h)try{if(0===h("0")&&!h(!1)){r=h(o);var p=5==r.a.length&&1===r.a[0];if(p){try{p=!h('"	"')}catch(d){}if(p)try{p=1!==h("01")}catch(d){}if(p)try{p=1!==h("1.")}catch(d){}}}}catch(d){p=!1}i=p}}return n[e]=!!i}e||(e=o.Object()),t||(t=o.Object());var s=e.Number||o.Number,a=e.String||o.String,l=e.Object||o.Object,c=e.Date||o.Date,u=e.SyntaxError||o.SyntaxError,d=e.TypeError||o.TypeError,h=e.Math||o.Math,p=e.JSON||o.JSON;"object"==typeof p&&p&&(t.stringify=p.stringify,t.parse=p.parse);var f,g,m,_=l.prototype,v=_.toString,y=new c(-0xc782b5b800cec);try{y=-109252==y.getUTCFullYear()&&0===y.getUTCMonth()&&1===y.getUTCDate()&&10==y.getUTCHours()&&37==y.getUTCMinutes()&&6==y.getUTCSeconds()&&708==y.getUTCMilliseconds()}catch(C){}if(!n("json")){var w="[object Function]",b="[object Date]",E="[object Number]",A="[object String]",T="[object Array]",S="[object Boolean]",k=n("bug-string-char-index");if(!y)var P=h.floor,x=[0,31,59,90,120,151,181,212,243,273,304,334],I=function(e,t){return x[t]+365*(e-1970)+P((e-1969+(t=+(t>1)))/4)-P((e-1901+t)/100)+P((e-1601+t)/400)};if((f=_.hasOwnProperty)||(f=function(e){var t,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=v?f=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(t=n.constructor,f=function(e){var n=(this.constructor||t).prototype;return e in this&&!(e in n&&this[e]===n[e])}),n=null,f.call(this,e)}),g=function(e,t){var n,i,o,s=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,i=new n;for(o in i)f.call(i,o)&&s++;return n=i=null,s?g=2==s?function(e,t){var n,i={},r=v.call(e)==w;for(n in e)r&&"prototype"==n||f.call(i,n)||!(i[n]=1)||!f.call(e,n)||t(n)}:function(e,t){var n,i,r=v.call(e)==w;for(n in e)r&&"prototype"==n||!f.call(e,n)||(i="constructor"===n)||t(n);(i||f.call(e,n="constructor"))&&t(n)}:(i=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],g=function(e,t){var n,o,s=v.call(e)==w,a=!s&&"function"!=typeof e.constructor&&r[typeof e.hasOwnProperty]&&e.hasOwnProperty||f;for(n in e)s&&"prototype"==n||!a.call(e,n)||t(n);for(o=i.length;n=i[--o];a.call(e,n)&&t(n));}),g(e,t)},!n("json-stringify")){var R={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},L="000000",D=function(e,t){return(L+(t||0)).slice(-e)},O="\\u00",F=function(e){for(var t='"',n=0,i=e.length,r=!k||i>10,o=r&&(k?e.split(""):e);i>n;n++){var s=e.charCodeAt(n);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=R[s];break;default:if(32>s){t+=O+D(2,s.toString(16));break}t+=r?o[n]:e.charAt(n)}}return t+'"'},M=function(e,t,n,i,r,o,s){var a,l,c,u,h,p,_,y,C,w,k,x,R,L,O,N;try{a=t[e]}catch(j){}if("object"==typeof a&&a)if(l=v.call(a),l!=b||f.call(a,"toJSON"))"function"==typeof a.toJSON&&(l!=E&&l!=A&&l!=T||f.call(a,"toJSON"))&&(a=a.toJSON(e));else if(a>-1/0&&1/0>a){if(I){for(h=P(a/864e5),c=P(h/365.2425)+1970-1;I(c+1,0)<=h;c++);for(u=P((h-I(c,0))/30.42);I(c,u+1)<=h;u++);h=1+h-I(c,u),p=(a%864e5+864e5)%864e5,_=P(p/36e5)%24,y=P(p/6e4)%60,C=P(p/1e3)%60,w=p%1e3}else c=a.getUTCFullYear(),u=a.getUTCMonth(),h=a.getUTCDate(),_=a.getUTCHours(),y=a.getUTCMinutes(),C=a.getUTCSeconds(),w=a.getUTCMilliseconds();a=(0>=c||c>=1e4?(0>c?"-":"+")+D(6,0>c?-c:c):D(4,c))+"-"+D(2,u+1)+"-"+D(2,h)+"T"+D(2,_)+":"+D(2,y)+":"+D(2,C)+"."+D(3,w)+"Z"}else a=null;if(n&&(a=n.call(t,e,a)),null===a)return"null";if(l=v.call(a),l==S)return""+a;if(l==E)return a>-1/0&&1/0>a?""+a:"null";if(l==A)return F(""+a);if("object"==typeof a){for(L=s.length;L--;)if(s[L]===a)throw d();if(s.push(a),k=[],O=o,o+=r,l==T){for(R=0,L=a.length;L>R;R++)x=M(R,a,n,i,r,o,s),k.push(x===m?"null":x);N=k.length?r?"[\n"+o+k.join(",\n"+o)+"\n"+O+"]":"["+k.join(",")+"]":"[]"}else g(i||a,function(e){var t=M(e,a,n,i,r,o,s);t!==m&&k.push(F(e)+":"+(r?" ":"")+t)}),N=k.length?r?"{\n"+o+k.join(",\n"+o)+"\n"+O+"}":"{"+k.join(",")+"}":"{}";return s.pop(),N}};t.stringify=function(e,t,n){var i,o,s,a;if(r[typeof t]&&t)if((a=v.call(t))==w)o=t;else if(a==T){s={};for(var l,c=0,u=t.length;u>c;l=t[c++],a=v.call(l),(a==A||a==E)&&(s[l]=1));}if(n)if((a=v.call(n))==E){if((n-=n%1)>0)for(i="",n>10&&(n=10);i.length<n;i+=" ");}else a==A&&(i=n.length<=10?n:n.slice(0,10));return M("",(l={},l[""]=e,l),o,s,i,"",[])}}if(!n("json-parse")){var N,j,B=a.fromCharCode,U={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},q=function(){throw N=j=null,u()},V=function(){for(var e,t,n,i,r,o=j,s=o.length;s>N;)switch(r=o.charCodeAt(N)){case 9:case 10:case 13:case 32:N++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=k?o.charAt(N):o[N],N++,e;case 34:for(e="@",N++;s>N;)if(r=o.charCodeAt(N),32>r)q();else if(92==r)switch(r=o.charCodeAt(++N)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=U[r],N++;break;case 117:for(t=++N,n=N+4;n>N;N++)r=o.charCodeAt(N),r>=48&&57>=r||r>=97&&102>=r||r>=65&&70>=r||q();e+=B("0x"+o.slice(t,N));break;default:q()}else{if(34==r)break;for(r=o.charCodeAt(N),t=N;r>=32&&92!=r&&34!=r;)r=o.charCodeAt(++N);e+=o.slice(t,N)}if(34==o.charCodeAt(N))return N++,e;q();default:if(t=N,45==r&&(i=!0,r=o.charCodeAt(++N)),r>=48&&57>=r){for(48==r&&(r=o.charCodeAt(N+1),r>=48&&57>=r)&&q(),i=!1;s>N&&(r=o.charCodeAt(N),r>=48&&57>=r);N++);if(46==o.charCodeAt(N)){for(n=++N;s>n&&(r=o.charCodeAt(n),r>=48&&57>=r);n++);n==N&&q(),N=n}if(r=o.charCodeAt(N),101==r||69==r){for(r=o.charCodeAt(++N),43!=r&&45!=r||N++,n=N;s>n&&(r=o.charCodeAt(n),r>=48&&57>=r);n++);n==N&&q(),N=n}return+o.slice(t,N)}if(i&&q(),"true"==o.slice(N,N+4))return N+=4,!0;if("false"==o.slice(N,N+5))return N+=5,!1;if("null"==o.slice(N,N+4))return N+=4,null;q()}return"$"},z=function(e){var t,n;if("$"==e&&q(),"string"==typeof e){if("@"==(k?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];e=V(),"]"!=e;n||(n=!0))n&&(","==e?(e=V(),"]"==e&&q()):q()),","==e&&q(),t.push(z(e));return t}if("{"==e){
for(t={};e=V(),"}"!=e;n||(n=!0))n&&(","==e?(e=V(),"}"==e&&q()):q()),","!=e&&"string"==typeof e&&"@"==(k?e.charAt(0):e[0])&&":"==V()||q(),t[e.slice(1)]=z(V());return t}q()}return e},Q=function(e,t,n){var i=H(e,t,n);i===m?delete e[t]:e[t]=i},H=function(e,t,n){var i,r=e[t];if("object"==typeof r&&r)if(v.call(r)==T)for(i=r.length;i--;)Q(r,i,n);else g(r,function(e){Q(r,e,n)});return n.call(e,t,r)};t.parse=function(e,t){var n,i;return N=0,j=""+e,n=z(V()),"$"!=V()&&q(),N=j=null,t&&v.call(t)==w?H((i={},i[""]=n,i),"",t):n}}}return t.runInContext=i,t}var r={"function":!0,object:!0},o=window,s=i(o,{});t.exports=s},{}],99:[function(e,t,n){var i=function(){function e(){if(!K&&document.getElementsByTagName("body")[0]){try{var e,t=v("span");t.style.display="none",e=U.getElementsByTagName("body")[0].appendChild(t),e.parentNode.removeChild(e),e=null,t=null}catch(n){return}K=!0;for(var i=z.length,r=0;i>r;r++)z[r]()}}function t(e){K?e():z[z.length]=e}function n(e){if(typeof B.addEventListener!==R)B.addEventListener("load",e,!1);else if(typeof U.addEventListener!==R)U.addEventListener("load",e,!1);else if(typeof B.attachEvent!==R)C(B,"onload",e);else if("function"==typeof B.onload){var t=B.onload;B.onload=function(){t(),e()}}else B.onload=e}function r(){var e=U.getElementsByTagName("body")[0],t=v(L);t.setAttribute("style","visibility: hidden;"),t.setAttribute("type",F);var n=e.appendChild(t);if(n){var i=0;!function r(){if(typeof n.GetVariable!==R)try{var s=n.GetVariable("$version");s&&(s=s.split(" ")[1].split(","),X.pv=[y(s[0]),y(s[1]),y(s[2])])}catch(a){X.pv=[8,0,0]}else if(10>i)return i++,void setTimeout(r,10);e.removeChild(t),n=null,o()}()}else o()}function o(){var e=Q.length;if(e>0)for(var t=0;e>t;t++){var n=Q[t].id,i=Q[t].callbackFn,r={success:!1,id:n};if(X.pv[0]>0){var o=_(n);if(o)if(!w(Q[t].swfVersion)||X.wk&&X.wk<312)if(Q[t].expressInstall&&a()){var u={};u.data=Q[t].expressInstall,u.width=o.getAttribute("width")||"0",u.height=o.getAttribute("height")||"0",o.getAttribute("class")&&(u.styleclass=o.getAttribute("class")),o.getAttribute("align")&&(u.align=o.getAttribute("align"));for(var d={},h=o.getElementsByTagName("param"),p=h.length,f=0;p>f;f++)"movie"!==h[f].getAttribute("name").toLowerCase()&&(d[h[f].getAttribute("name")]=h[f].getAttribute("value"));l(u,d,n,i)}else c(o),i&&i(r);else E(n,!0),i&&(r.success=!0,r.ref=s(n),r.id=n,i(r))}else if(E(n,!0),i){var g=s(n);g&&typeof g.SetVariable!==R&&(r.success=!0,r.ref=g,r.id=g.id),i(r)}}}function s(e){var t=null,n=_(e);return n&&"OBJECT"===n.nodeName.toUpperCase()&&(t=typeof n.SetVariable!==R?n:n.getElementsByTagName(L)[0]||n),t}function a(){return!$&&w("6.0.65")&&(X.win||X.mac)&&!(X.wk&&X.wk<312)}function l(e,t,n,i){var r=_(n);if(n=m(n),$=!0,k=i||null,P={success:!1,id:n},r){"OBJECT"===r.nodeName.toUpperCase()?(T=u(r),S=null):(T=r,S=n),e.id=M,(typeof e.width===R||!/%$/.test(e.width)&&y(e.width)<310)&&(e.width="310"),(typeof e.height===R||!/%$/.test(e.height)&&y(e.height)<137)&&(e.height="137");var o=X.ie?"ActiveX":"PlugIn",s="MMredirectURL="+encodeURIComponent(B.location.toString().replace(/&/g,"%26"))+"&MMplayerType="+o+"&MMdoctitle="+encodeURIComponent(U.title.slice(0,47)+" - Flash Player Installation");if(typeof t.flashvars!==R?t.flashvars+="&"+s:t.flashvars=s,X.ie&&4!=r.readyState){var a=v("div");n+="SWFObjectNew",a.setAttribute("id",n),r.parentNode.insertBefore(a,r),r.style.display="none",f(r)}h(e,t,n)}}function c(e){if(X.ie&&4!=e.readyState){e.style.display="none";var t=v("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(u(e),t),f(e)}else e.parentNode.replaceChild(u(e),e)}function u(e){var t=v("div");if(X.win&&X.ie)t.innerHTML=e.innerHTML;else{var n=e.getElementsByTagName(L)[0];if(n){var i=n.childNodes;if(i)for(var r=i.length,o=0;r>o;o++)1==i[o].nodeType&&"PARAM"===i[o].nodeName||8==i[o].nodeType||t.appendChild(i[o].cloneNode(!0))}}return t}function d(e,t){var n=v("div");return n.innerHTML="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'><param name='movie' value='"+e+"'>"+t+"</object>",n.firstChild}function h(e,t,n){var i,r=_(n);if(n=m(n),X.wk&&X.wk<312)return i;if(r){var o,s,a,l=v(X.ie?"div":L);typeof e.id===R&&(e.id=n);for(a in t)t.hasOwnProperty(a)&&"movie"!==a.toLowerCase()&&p(l,a,t[a]);X.ie&&(l=d(e.data,l.innerHTML));for(o in e)e.hasOwnProperty(o)&&(s=o.toLowerCase(),"styleclass"===s?l.setAttribute("class",e[o]):"classid"!==s&&"data"!==s&&l.setAttribute(o,e[o]));X.ie?H[H.length]=e.id:(l.setAttribute("type",F),l.setAttribute("data",e.data)),r.parentNode.replaceChild(l,r),i=l}return i}function p(e,t,n){var i=v("param");i.setAttribute("name",t),i.setAttribute("value",n),e.appendChild(i)}function f(e){var t=_(e);t&&"OBJECT"===t.nodeName.toUpperCase()&&(X.ie?(t.style.display="none",function n(){if(4==t.readyState){for(var e in t)"function"==typeof t[e]&&(t[e]=null);t.parentNode.removeChild(t)}else setTimeout(n,10)}()):t.parentNode.removeChild(t))}function g(e){return e&&e.nodeType&&1===e.nodeType}function m(e){return g(e)?e.id:e}function _(e){if(g(e))return e;var t=null;try{t=U.getElementById(e)}catch(n){}return t}function v(e){return U.createElement(e)}function y(e){return parseInt(e,10)}function C(e,t,n){e.attachEvent(t,n),W[W.length]=[e,t,n]}function w(e){e+="";var t=X.pv,n=e.split(".");return n[0]=y(n[0]),n[1]=y(n[1])||0,n[2]=y(n[2])||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]}function b(e,t,n,i){var r=U.getElementsByTagName("head")[0];if(r){var o="string"==typeof n?n:"screen";if(i&&(x=null,I=null),!x||I!=o){var s=v("style");s.setAttribute("type","text/css"),s.setAttribute("media",o),x=r.appendChild(s),X.ie&&typeof U.styleSheets!==R&&U.styleSheets.length>0&&(x=U.styleSheets[U.styleSheets.length-1]),I=o}x&&(typeof x.addRule!==R?x.addRule(e,t):typeof U.createTextNode!==R&&x.appendChild(U.createTextNode(e+" {"+t+"}")))}}function E(e,t){if(J){var n=t?"visible":"hidden",i=_(e);K&&i?i.style.visibility=n:"string"==typeof e&&b("#"+e,"visibility:"+n)}}function A(e){var t=/[\\\"<>\.;]/,n=null!==t.exec(e);return n&&typeof encodeURIComponent!==R?encodeURIComponent(e):e}var T,S,k,P,x,I,R="undefined",L="object",D="Shockwave Flash",O="ShockwaveFlash.ShockwaveFlash",F="application/x-shockwave-flash",M="SWFObjectExprInst",N="DOMContentLoaded",j="onreadystatechange",B=window,U=document,q=navigator,V=!1,z=[],Q=[],H=[],W=[],K=!1,$=!1,J=!0,G=!1,X=function(){var e=typeof U.getElementById!==R&&typeof U.getElementsByTagName!==R&&typeof U.createElement!==R,t=q.userAgent.toLowerCase(),n=q.platform.toLowerCase(),i=n?/win/.test(n):/win/.test(t),r=n?/mac/.test(n):/mac/.test(t),o=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,s="Microsoft Internet Explorer"===q.appName,a=[0,0,0],l=null;if(typeof q.plugins!==R&&typeof q.plugins[D]===L)l=q.plugins[D].description,l&&typeof q.mimeTypes!==R&&q.mimeTypes[F]&&q.mimeTypes[F].enabledPlugin&&(V=!0,s=!1,l=l.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),a[0]=y(l.replace(/^(.*)\..*$/,"$1")),a[1]=y(l.replace(/^.*\.(.*)\s.*$/,"$1")),a[2]=/[a-zA-Z]/.test(l)?y(l.replace(/^.*[a-zA-Z]+(.*)$/,"$1")):0);else if(typeof B.ActiveXObject!==R)try{var c=new ActiveXObject(O);c&&(l=c.GetVariable("$version"),l&&(s=!0,l=l.split(" ")[1].split(","),a=[y(l[0]),y(l[1]),y(l[2])]))}catch(u){}return{w3:e,pv:a,wk:o,ie:s,win:i,mac:r}}();return function(){X.w3&&((typeof U.readyState!==R&&"complete"===U.readyState||typeof U.readyState===R&&(U.getElementsByTagName("body")[0]||U.body))&&e(),K||(typeof U.addEventListener!==R&&U.addEventListener(N,function t(){U.removeEventListener(N,t,!1),e()},!1),X.ie&&(U.attachEvent(j,function i(){"complete"===U.readyState&&(U.detachEvent(j,i),e())}),B===top&&!function r(){if(!K){try{U.documentElement.doScroll("left")}catch(t){return void setTimeout(r,10)}e()}}()),X.wk&&!function o(){return K?void 0:/^(loaded|complete)$/.test(U.readyState)?void e():void setTimeout(o,10)}(),n(e)))}(),z[0]=function(){V?r():o()},function(){X.ie&&window.attachEvent("onunload",function(){for(var e=W.length,t=0;e>t;t++)W[t][0].detachEvent(W[t][1],W[t][2]);for(var n=H.length,r=0;n>r;r++)f(H[r]);for(var o in X)X[o]=null;X=null;for(var s in i)i[s]=null;i=null})}(),{registerObject:function(e,t,n,i){if(X.w3&&e&&t){var r={};r.id=e,r.swfVersion=t,r.expressInstall=n,r.callbackFn=i,Q[Q.length]=r,E(e,!1)}else i&&i({success:!1,id:e})},getObjectById:function(e){return X.w3?s(e):void 0},embedSWF:function(e,n,i,r,o,s,c,u,d,p){var f=m(n),g={success:!1,id:f};X.w3&&!(X.wk&&X.wk<312)&&e&&n&&i&&r&&o?(E(f,!1),t(function(){i+="",r+="";var t={};if(d&&typeof d===L)for(var m in d)t[m]=d[m];t.data=e,t.width=i,t.height=r;var _={};if(u&&typeof u===L)for(var v in u)_[v]=u[v];if(c&&typeof c===L)for(var y in c)if(c.hasOwnProperty(y)){var C=G?encodeURIComponent(y):y,b=G?encodeURIComponent(c[y]):c[y];typeof _.flashvars!==R?_.flashvars+="&"+C+"="+b:_.flashvars=C+"="+b}if(w(o)){var A=h(t,_,n);t.id==f&&E(f,!0),g.success=!0,g.ref=A,g.id=A.id}else{if(s&&a())return t.data=s,void l(t,_,n,p);E(f,!0)}p&&p(g)})):p&&p(g)},switchOffAutoHideShow:function(){J=!1},enableUriEncoding:function(e){G=typeof e===R?!0:e},ua:X,getFlashPlayerVersion:function(){return{major:X.pv[0],minor:X.pv[1],release:X.pv[2]}},hasFlashPlayerVersion:w,createSWF:function(e,t,n){return X.w3?h(e,t,n):void 0},showExpressInstall:function(e,t,n,i){X.w3&&a()&&l(e,t,n,i)},removeSWF:function(e){X.w3&&f(e)},createCSS:function(e,t,n,i){X.w3&&b(e,t,n,i)},addDomLoadEvent:t,addLoadEvent:n,getQueryParamValue:function(e){var t=U.location.search||U.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),!e)return A(t);for(var n=t.split("&"),i=0;i<n.length;i++)if(n[i].substring(0,n[i].indexOf("="))==e)return A(n[i].substring(n[i].indexOf("=")+1))}return""},expressInstallCallback:function(){if($){var e=_(M);e&&T&&(e.parentNode.replaceChild(T,e),S&&(E(S,!0),X.ie&&(T.style.display="block")),k&&k(P)),$=!1}},version:"2.3"}}();t.exports=i},{}],100:[function(e,t,n){(function(e){"use strict";function n(e,t,n,i){return r(e).then(t,n,i)}function i(e,t){this.then=e,this.inspect=t}function r(e){return a(function(t){t(e)})}function o(e){return n(e,d)}function s(){function e(e,o,s){t.resolve=t.resolver.resolve=function(t){return i?r(t):(i=!0,e(t),n)},t.reject=t.resolver.reject=function(e){return i?r(d(e)):(i=!0,o(e),n)},t.notify=t.resolver.notify=function(e){return s(e),e}}var t,n,i;return t={promise:B,resolve:B,reject:B,notify:B,resolver:{resolve:B,reject:B,notify:B}},t.promise=n=a(e),t}function a(e){return l(e,j.PromiseStatus&&j.PromiseStatus())}function l(e,t){function n(e,n,i){var r=l(function(t,r,o){function s(s){s.then(e,n,i).then(t,r,o)}g?g.push(s):S(function(){s(f)})},t&&t.observed());return r}function r(){return f?f.inspect():T()}function o(e){g&&(f=c(e),p(g,f),g=B,t&&f.then(function(){t.fulfilled()},function(e){t.rejected(e)}))}function s(e){o(d(e))}function a(e){g&&p(g,h(e))}var u,f,g=[];u=new i(n,r);try{e(o,s,a)}catch(m){s(m)}return u}function c(e){return e instanceof i?e:e===Object(e)&&"then"in e?a(function(t,n,i){S(function(){try{var r=e.then;"function"==typeof r?R(r,e,t,n,i):t(u(e))}catch(o){n(o)}})}):u(e)}function u(e){var t=new i(function(n){try{return"function"==typeof n?c(n(e)):t}catch(i){return d(i)}},function(){return E(e)});return t}function d(e){var t=new i(function(n,i){try{return"function"==typeof i?c(i(e)):t}catch(r){return d(r)}},function(){return A(e)});return t}function h(e){var t=new i(function(n,i,r){try{return"function"==typeof r?h(r(e)):t}catch(o){return h(o)}});return t}function p(e,t){S(function(){for(var n,i=0;n=e[i++];)n(t)})}function f(e){return e&&"function"==typeof e.then}function g(e,t,i,r,o){return n(e,function(e){function s(i,r,o){function s(e){p(e)}function a(e){h(e)}var l,c,u,d,h,p,f,g;if(f=e.length>>>0,l=Math.max(0,Math.min(t,f)),u=[],c=f-l+1,d=[],l)for(p=function(e){d.push(e),--c||(h=p=P,r(d))},h=function(e){u.push(e),--l||(h=p=P,i(u))},g=0;f>g;++g)g in e&&n(e[g],a,s,o);else i(u)}return a(s).then(i,r,o)})}function m(e,t,n,i){function r(e){return t?t(e[0]):e[0]}return g(e,1,r,n,i)}function _(e,t,n,i){return w(e,P).then(t,n,i)}function v(){return w(arguments,P)}function y(e){return w(e,E,A)}function C(e,t){return w(e,t)}function w(e,t,i){return n(e,function(e){function r(r,o,s){function a(e,a){n(e,t,i).then(function(e){l[a]=e,--u||r(l)},o,s)}var l,c,u,d;if(u=c=e.length>>>0,l=[],!u)return void r(l);for(d=0;c>d;d++)d in e?a(e[d],d):--u}return a(r)})}function b(e,t){var i=R(I,arguments,1);return n(e,function(e){var r;return r=e.length,i[0]=function(e,i,o){return n(e,function(e){return n(i,function(n){return t(e,n,o,r)})})},x.apply(e,i)})}function E(e){return{state:"fulfilled",value:e}}function A(e){return{state:"rejected",reason:e}}function T(){return{state:"pending"}}function S(e){1===D.push(e)&&L(k)}function k(){for(var e,t=0;e=D[t++];)e();D=[]}function P(e){return e}n.promise=a,n.resolve=r,n.reject=o,n.defer=s,n.join=v,n.all=_,n.map=C,n.reduce=b,n.settle=y,n.any=m,n.some=g,n.isPromise=f,i.prototype={otherwise:function(e){return this.then(B,e)},ensure:function(e){function t(){return r(e())}return this.then(t,t)["yield"](this)},"yield":function(e){return this.then(function(){return e})},spread:function(e){return this.then(function(t){return _(t,function(t){return e.apply(B,t)})})},always:function(e,t){return this.then(e,e,t)}};var x,I,R,L,D,O,F,M,N,j,B;D=[],j="undefined"!=typeof console?console:n,O=e.setTimeout,L="function"==typeof setImmediate?setImmediate.bind(e):function(e){O(e,0)},F=Function.prototype,M=F.call,R=F.bind?M.bind(M):function(e,t){return e.apply(t,I.call(arguments,2))},N=[],I=N.slice,x=N.reduce||function(e){var t,n,i,r,o;if(o=0,t=Object(this),r=t.length>>>0,n=arguments,n.length<=1)for(;;){if(o in t){i=t[o++];break}if(++o>=r)throw new TypeError}else i=n[1];for(;r>o;++o)o in t&&(i=e(i,t[o],o,t));return i},t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[11]),function(e){"use strict";var t=document,n=t.createElement("script"),i=t.getElementsByTagName("script")[0],r="https:"===document.location.protocol;n.type="text/javascript",n.src=(r?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js",i.parentNode.insertBefore(n,i)}(),!function(){function e(){}function t(e){return e}function n(e){return!!e}function i(e){return!e}function r(e){return function(){if(null===e)throw new Error("Callback was already called.");e.apply(this,arguments),e=null}}function o(e){return function(){null!==e&&(e.apply(this,arguments),e=null)}}function s(e){return M(e)||"number"==typeof e.length&&e.length>=0&&e.length%1===0}function a(e,t){for(var n=-1,i=e.length;++n<i;)t(e[n],n,e)}function l(e,t){for(var n=-1,i=e.length,r=Array(i);++n<i;)r[n]=t(e[n],n,e);return r}function c(e){return l(Array(e),function(e,t){return t})}function u(e,t,n){return a(e,function(e,i,r){n=t(n,e,i,r)}),n}function d(e,t){a(j(e),function(n){t(e[n],n)})}function h(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}function p(e){var t,n,i=-1;return s(e)?(t=e.length,function(){return i++,t>i?i:null}):(n=j(e),t=n.length,function(){return i++,t>i?n[i]:null})}function f(e,t){return t=null==t?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),i=Array(n),r=0;n>r;r++)i[r]=arguments[r+t];switch(t){case 0:return e.call(this,i);case 1:return e.call(this,arguments[0],i)}}}function g(e){return function(t,n,i){return e(t,i)}}function m(t){return function(n,i,s){s=o(s||e),n=n||[];var a=p(n);if(0>=t)return s(null);var l=!1,c=0,u=!1;!function d(){if(l&&0>=c)return s(null);for(;t>c&&!u;){var e=a();if(null===e)return l=!0,void(0>=c&&s(null));c+=1,i(n[e],e,r(function(e){c-=1,e?(s(e),u=!0):d()}))}}()}}function _(e){return function(t,n,i){return e(D.eachOf,t,n,i)}}function v(e){return function(t,n,i,r){return e(m(n),t,i,r)}}function y(e){return function(t,n,i){return e(D.eachOfSeries,t,n,i)}}function C(t,n,i,r){r=o(r||e),n=n||[];var a=s(n)?[]:{};t(n,function(e,t,n){i(e,function(e,i){a[t]=i,n(e)})},function(e){r(e,a)})}function w(e,t,n,i){var r=[];e(t,function(e,t,i){n(e,function(n){n&&r.push({index:t,value:e}),i()})},function(){i(l(r.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})}function b(e,t,n,i){w(e,t,function(e,t){n(e,function(e){t(!e)})},i)}function E(e,t,n){return function(i,r,o,s){function a(){s&&s(n(!1,void 0))}function l(e,i,r){return s?void o(e,function(i){s&&t(i)&&(s(n(!0,e)),s=o=!1),r()}):r()}arguments.length>3?e(i,r,l,a):(s=o,o=r,e(i,l,a))}}function A(e,t){return t}function T(t,n,i){i=i||e;var r=s(n)?[]:{};t(n,function(e,t,n){e(f(function(e,i){i.length<=1&&(i=i[0]),r[t]=i,n(e)}))},function(e){i(e,r)})}function S(e,t,n,i){var r=[];e(t,function(e,t,i){n(e,function(e,t){r=r.concat(t||[]),i(e)})},function(e){i(e,r)})}function k(t,n,i){function o(t,n,i,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");return t.started=!0,M(n)||(n=[n]),0===n.length&&t.idle()?D.setImmediate(function(){t.drain()}):(a(n,function(n){var o={data:n,callback:r||e};i?t.tasks.unshift(o):t.tasks.push(o),t.tasks.length===t.concurrency&&t.saturated()}),void D.setImmediate(t.process))}function s(e,t){return function(){c-=1;var n=!1,i=arguments;a(t,function(e){a(u,function(t,i){t!==e||n||(u.splice(i,1),n=!0)}),e.callback.apply(e,i)}),e.tasks.length+c===0&&e.drain(),e.process()}}if(null==n)n=1;else if(0===n)throw new Error("Concurrency must not be zero");var c=0,u=[],d={tasks:[],concurrency:n,payload:i,saturated:e,empty:e,drain:e,started:!1,paused:!1,push:function(e,t){o(d,e,!1,t)},kill:function(){d.drain=e,d.tasks=[]},unshift:function(e,t){o(d,e,!0,t)},process:function(){if(!d.paused&&c<d.concurrency&&d.tasks.length)for(;c<d.concurrency&&d.tasks.length;){var e=d.payload?d.tasks.splice(0,d.payload):d.tasks.splice(0,d.tasks.length),n=l(e,function(e){return e.data});0===d.tasks.length&&d.empty(),c+=1,u.push(e[0]);var i=r(s(d,e));t(n,i)}},length:function(){return d.tasks.length},running:function(){return c},workersList:function(){return u},idle:function(){return d.tasks.length+c===0},pause:function(){d.paused=!0},resume:function(){if(d.paused!==!1){d.paused=!1;for(var e=Math.min(d.concurrency,d.tasks.length),t=1;e>=t;t++)D.setImmediate(d.process)}}};return d}function P(e){return f(function(t,n){t.apply(null,n.concat([f(function(t,n){"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&a(n,function(t){console[e](t)}))})]))})}function x(e){return function(t,n,i){e(c(t),n,i)}}function I(e){return f(function(t,n){var i=f(function(n){var i=this,r=n.pop();return e(t,function(e,t,r){e.apply(i,n.concat([r]))},r)});return n.length?i.apply(this,n):i})}function R(e){return f(function(t){var n=t.pop();t.push(function(){var e=arguments;i?D.setImmediate(function(){n.apply(null,e)}):n.apply(null,e)});var i=!0;e.apply(this,t),i=!1})}var L,D={},O="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this;null!=O&&(L=O.async),D.noConflict=function(){return O.async=L,D};var F=Object.prototype.toString,M=Array.isArray||function(e){return"[object Array]"===F.call(e)},N=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},j=Object.keys||function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},B="function"==typeof setImmediate&&setImmediate,U=B?function(e){B(e)}:function(e){setTimeout(e,0)};"object"==typeof process&&"function"==typeof process.nextTick?D.nextTick=process.nextTick:D.nextTick=U,D.setImmediate=B?U:D.nextTick,D.forEach=D.each=function(e,t,n){return D.eachOf(e,g(t),n)},D.forEachSeries=D.eachSeries=function(e,t,n){return D.eachOfSeries(e,g(t),n)},D.forEachLimit=D.eachLimit=function(e,t,n,i){return m(t)(e,g(n),i)},D.forEachOf=D.eachOf=function(t,n,i){function s(e){c--,e?i(e):null===a&&0>=c&&i(null)}i=o(i||e),t=t||[];for(var a,l=p(t),c=0;null!=(a=l());)c+=1,n(t[a],a,r(s));0===c&&i(null)},D.forEachOfSeries=D.eachOfSeries=function(t,n,i){function s(){var e=!0;return null===l?i(null):(n(t[l],l,r(function(t){if(t)i(t);else{if(l=a(),null===l)return i(null);e?D.setImmediate(s):s()}})),void(e=!1))}i=o(i||e),t=t||[];var a=p(t),l=a();s()},D.forEachOfLimit=D.eachOfLimit=function(e,t,n,i){m(t)(e,n,i)},D.map=_(C),D.mapSeries=y(C),D.mapLimit=v(C),D.inject=D.foldl=D.reduce=function(e,t,n,i){D.eachOfSeries(e,function(e,i,r){n(t,e,function(e,n){t=n,r(e)})},function(e){i(e,t)})},D.foldr=D.reduceRight=function(e,n,i,r){var o=l(e,t).reverse();D.reduce(o,n,i,r)},D.transform=function(e,t,n,i){3===arguments.length&&(i=n,n=t,t=M(e)?[]:{}),D.eachOf(e,function(e,i,r){n(t,e,i,r)},function(e){i(e,t)})},D.select=D.filter=_(w),D.selectLimit=D.filterLimit=v(w),D.selectSeries=D.filterSeries=y(w),D.reject=_(b),D.rejectLimit=v(b),D.rejectSeries=y(b),D.any=D.some=E(D.eachOf,n,t),D.someLimit=E(D.eachOfLimit,n,t),D.all=D.every=E(D.eachOf,i,i),D.everyLimit=E(D.eachOfLimit,i,i),D.detect=E(D.eachOf,t,A),D.detectSeries=E(D.eachOfSeries,t,A),D.detectLimit=E(D.eachOfLimit,t,A),D.sortBy=function(e,t,n){function i(e,t){var n=e.criteria,i=t.criteria;return i>n?-1:n>i?1:0}D.map(e,function(e,n){t(e,function(t,i){t?n(t):n(null,{value:e,criteria:i})})},function(e,t){return e?n(e):void n(null,l(t.sort(i),function(e){return e.value}))})},D.auto=function(t,n,i){function r(e){_.unshift(e)}function s(e){var t=h(_,e);t>=0&&_.splice(t,1)}function l(){p--,a(_.slice(0),function(e){e()})}i||(i=n,n=null),i=o(i||e);var c=j(t),p=c.length;if(!p)return i(null);n||(n=p);var g={},m=0,_=[];r(function(){p||i(null,g)}),a(c,function(e){function o(){return n>m&&u(v,function(e,t){return e&&g.hasOwnProperty(t)},!0)&&!g.hasOwnProperty(e)}function a(){o()&&(m++,s(a),p[p.length-1](_,g))}for(var c,p=M(t[e])?t[e]:[t[e]],_=f(function(t,n){if(m--,n.length<=1&&(n=n[0]),t){var r={};d(g,function(e,t){r[t]=e}),r[e]=n,i(t,r)}else g[e]=n,D.setImmediate(l)}),v=p.slice(0,p.length-1),y=v.length;y--;){if(!(c=t[v[y]]))throw new Error("Has inexistant dependency");if(M(c)&&h(c,e)>=0)throw new Error("Has cyclic dependencies")}o()?(m++,p[p.length-1](_,g)):r(a)})},D.retry=function(e,t,n){function i(e,t){if("number"==typeof t)e.times=parseInt(t,10)||o;else{if("object"!=typeof t)throw new Error("Unsupported argument type for 'times': "+typeof t);e.times=parseInt(t.times,10)||o,e.interval=parseInt(t.interval,10)||s}}function r(e,t){function n(e,n){return function(i){e(function(e,t){i(!e||n,{err:e,result:t})},t)}}function i(e){return function(t){setTimeout(function(){t(null)},e)}}for(;l.times;){var r=!(l.times-=1);a.push(n(l.task,r)),!r&&l.interval>0&&a.push(i(l.interval))}D.series(a,function(t,n){n=n[n.length-1],(e||l.callback)(n.err,n.result)})}var o=5,s=0,a=[],l={times:o,interval:s},c=arguments.length;if(1>c||c>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");return 2>=c&&"function"==typeof e&&(n=t,t=e),"function"!=typeof e&&i(l,e),l.callback=n,l.task=t,l.callback?r():r},D.waterfall=function(t,n){function i(e){return f(function(t,r){if(t)n.apply(null,[t].concat(r));else{var o=e.next();o?r.push(i(o)):r.push(n),R(e).apply(null,r)}})}if(n=o(n||e),!M(t)){var r=new Error("First argument to waterfall must be an array of functions");return n(r)}return t.length?void i(D.iterator(t))():n()},D.parallel=function(e,t){T(D.eachOf,e,t)},D.parallelLimit=function(e,t,n){T(m(t),e,n)},D.series=function(e,t){T(D.eachOfSeries,e,t)},D.iterator=function(e){function t(n){function i(){return e.length&&e[n].apply(null,arguments),i.next()}return i.next=function(){return n<e.length-1?t(n+1):null},i}return t(0)},D.apply=f(function(e,t){return f(function(n){return e.apply(null,t.concat(n))})}),D.concat=_(S),D.concatSeries=y(S),D.whilst=function(t,n,i){if(i=i||e,t()){var r=f(function(e,o){e?i(e):t.apply(this,o)?n(r):i(null)});n(r)}else i(null)},D.doWhilst=function(e,t,n){var i=0;return D.whilst(function(){return++i<=1||t.apply(this,arguments)},e,n)},D.until=function(e,t,n){return D.whilst(function(){return!e.apply(this,arguments)},t,n)},D.doUntil=function(e,t,n){return D.doWhilst(e,function(){return!t.apply(this,arguments)},n)},D.during=function(t,n,i){i=i||e;var r=f(function(e,n){e?i(e):(n.push(o),t.apply(this,n))}),o=function(e,t){e?i(e):t?n(r):i(null)};t(o)},D.doDuring=function(e,t,n){var i=0;D.during(function(e){i++<1?e(null,!0):t.apply(this,arguments)},e,n)},D.queue=function(e,t){var n=k(function(t,n){e(t[0],n)},t,1);return n},D.priorityQueue=function(t,n){function i(e,t){return e.priority-t.priority}function r(e,t,n){for(var i=-1,r=e.length-1;r>i;){var o=i+(r-i+1>>>1);n(t,e[o])>=0?i=o:r=o-1}return i}function o(t,n,o,s){if(null!=s&&"function"!=typeof s)throw new Error("task callback must be a function");return t.started=!0,M(n)||(n=[n]),0===n.length?D.setImmediate(function(){t.drain()}):void a(n,function(n){var a={data:n,priority:o,callback:"function"==typeof s?s:e};t.tasks.splice(r(t.tasks,a,i)+1,0,a),t.tasks.length===t.concurrency&&t.saturated(),D.setImmediate(t.process)})}var s=D.queue(t,n);return s.push=function(e,t,n){o(s,e,t,n)},delete s.unshift,s},D.cargo=function(e,t){return k(e,1,t)},D.log=P("log"),D.dir=P("dir"),D.memoize=function(e,n){var i={},r={};n=n||t;var o=f(function(t){var o=t.pop(),s=n.apply(null,t);s in i?D.setImmediate(function(){o.apply(null,i[s])}):s in r?r[s].push(o):(r[s]=[o],e.apply(null,t.concat([f(function(e){i[s]=e;var t=r[s];delete r[s];for(var n=0,o=t.length;o>n;n++)t[n].apply(null,e)})])))});return o.memo=i,o.unmemoized=e,o},D.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},D.times=x(D.map),D.timesSeries=x(D.mapSeries),D.timesLimit=function(e,t,n,i){return D.mapLimit(c(e),t,n,i)},D.seq=function(){var t=arguments;return f(function(n){var i=this,r=n[n.length-1];"function"==typeof r?n.pop():r=e,D.reduce(t,n,function(e,t,n){t.apply(i,e.concat([f(function(e,t){n(e,t)})]))},function(e,t){r.apply(i,[e].concat(t))})})},D.compose=function(){return D.seq.apply(null,Array.prototype.reverse.call(arguments))},D.applyEach=I(D.eachOf),D.applyEachSeries=I(D.eachOfSeries),D.forever=function(t,n){function i(e){return e?o(e):void s(i)}var o=r(n||e),s=R(t);i()},D.ensureAsync=R,D.constant=f(function(e){var t=[null].concat(e);return function(e){return e.apply(this,t)}}),D.wrapSync=D.asyncify=function(e){return f(function(t){var n,i=t.pop();try{n=e.apply(this,t)}catch(r){return i(r)}N(n)&&"function"==typeof n.then?n.then(function(e){i(null,e)})["catch"](function(e){i(e.message?e:new Error(e))}):i(null,n)})},"object"==typeof module&&module.exports?module.exports=D:"function"==typeof define&&define.amd?define([],function(){return D}):O.async=D}(),async.parallelWithTimeout=function(e,t,n,i){var r=n.map(function(e){return function(t){e.callback(function(n,i){e.isCompleted=!0,t(n,i)})}}),o=setTimeout(function(){o=null;for(var r=0;r<n.length;r++)n[r].isCompleted||console.log(e+" timeout occurred - "+n[r].name);i("async.parallel timed out out after "+t+"ms.",null)},t);async.parallel(r,function(e,t){o&&(clearTimeout(o),i(e,t))})},function(e){"use strict";function t(){return c&&c.call(l)||(new Date).getTime()}var n=[],i={},r={},o=function(){},s="-----";s+=s,s+=s,s+=s,s+=s;var a="\n\n\n\n\n\n",l=window.performance,c=l&&(l.now||l.mozNow||l.msNow||l.oNow||l.webkitNow);e.log&&"function"==typeof e.log||(e.log=o),e.profile&&"function"==typeof e.profile||(e.profile=o),e.profileEnd&&"function"==typeof e.profileEnd||(e.profileEnd=o),e.timeStamp&&"function"==typeof e.timeStamp||(e.timeStamp=o),e.trace&&"function"==typeof e.trace||(e.trace=o),e.debug&&"function"==typeof e.debug||(e.debug=e.log),e.info&&"function"==typeof e.info||(e.info=e.log),e.warn&&"function"==typeof e.warn||(e.warn=e.log),e.error&&"function"==typeof e.error||(e.error=e.log),e.dir&&"function"==typeof e.dir||(e.dir=e.log),e.dirxml&&"function"==typeof e.dirxml||(e.dirxml=e.dir);var u=!1;!u&&e.group||(e.group=function(t){n.push(t),e.log(s+"\nBEGIN GROUP: "+t)}),!u&&e.groupCollapsed||(e.groupCollapsed=e.group),!u&&e.groupEnd||(e.groupEnd=function(){e.log("END GROUP: "+n.pop()+"\n"+s)}),!u&&e.time||(e.time=function(e){i[e]=t()}),!u&&e.timeEnd||(e.timeEnd=function(n){e.log(n+": "+(t()-i[n]).toFixed(3)+"ms"),delete i[n]}),!u&&e.assert||(e.assert=function(t,n){t||e.error("Assertion failed: "+n)}),!u&&e.count||(e.count=function(t){r[t]||(r[t]=0),r[t]++,e.log(t+": "+r[t])}),!u&&e.clear||(e.clear=function(){e.log(a)})}(window.console=window.console||{}),!window.addEventListener&&function(e,t,n,i,r,o,s){e[i]=t[i]=n[i]=function(e,t){var n=this;s.unshift([n,e,t,function(e){e.currentTarget=n,e.preventDefault=function(){e.returnValue=!1},e.stopPropagation=function(){e.cancelBubble=!0},e.target=e.srcElement||n,t.call(n,e)}]),this.attachEvent("on"+e,s[0][3])},e[r]=t[r]=n[r]=function(e,t){for(var n,i=0;n=s[i];++i)if(n[0]==this&&n[1]==e&&n[2]==t)return this.detachEvent("on"+e,s.splice(i,1)[0][3])},e[o]=t[o]=n[o]=function(e){return this.fireEvent("on"+e.type,e)}}(window.prototype,document.prototype,Element.prototype,"addEventListener","removeEventListener","dispatchEvent",[]),"undefined"!=typeof CustomEvent&&"function"==typeof CustomEvent||!function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n;return document.createEvent?(n=document.createEvent("CustomEvent"),n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail)):document.createEventObject&&(n=document.createEventObject()),n}e.prototype=window.Event.prototype,window.CustomEvent=e}(),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n;if(null===this)throw new TypeError('"this" is null or not defined');var i=Object(this),r=i.length>>>0;if(0===r)return-1;var o=+t||0;if(Math.abs(o)===1/0&&(o=0),o>=r)return-1;for(n=Math.max(o>=0?o:r-Math.abs(o),0);r>n;){if(n in i&&i[n]===e)return n;n++}return-1}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var AdFuel=function(){function e(e){return"function"==typeof e}function t(t,n){if(!e(t))throw new TypeError("Bind must be called on a function");var i=te.call(arguments,2);return function(){return t.apply(n,i.concat(te.call(arguments)))}}function n(){window.console.log.apply(window.console,arguments)}function i(e,t,n){e.addEventListener?e.addEventListener(t,n,!0):e.attachEvent&&e.attachEvent("on"+t,n)}function r(){for(var e="",t=0;9>t;t++)e+=Math.floor(16*Math.random()).toString(16);return e}function o(e){var t="";if(document.location.search){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n="[\\?&]"+e+"=([^&#]*)",i=new RegExp(n),r=i.exec(document.location.search);r&&(t=r[1])}return t}function s(e){if(document.cookie){for(var t=document.cookie.split(";"),n=e+"=",i=0;i<t.length;i++){for(var r=t[i];" "==r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(n))return r.substring(n.length,r.length)}return null}return null}function a(e){if(null==e||"object"!=typeof e)return e;if(e instanceof Date){var t=new Date;return t.setTime(e.getTime()),t}if(e instanceof Array){for(var n=[],i=0,r=e.length;r>i;i++)n[i]=a(e[i]);return n}if(e instanceof Object){var o={};for(var s in e)e.hasOwnProperty(s)&&(o[s]=a(e[s]));return o}throw new Error("Unable to copy obj! Its type isn't supported.")}function l(){function e(){n||(n=!0,de("AdFuel DOM Ready Detection"),re=!0,P())}function t(){if(!n)try{document.documentElement.doScroll("left"),e()}catch(i){setTimeout(t,10)}}var n=!1;if(document.addEventListener)document.addEventListener("DOMContentLoaded",e,!1);else if(document.attachEvent){var i=!1;try{i=null!==window.frameElement}catch(r){}document.documentElement.doScroll&&!i&&t(),document.attachEvent("onreadystatechange",function(){"complete"!==document.readyState&&"loaded"!==document.readyState&&"interactive"!==document.readyState||e()})}if(window.addEventListener)window.addEventListener("load",e,!0);else if(window.attachEvent)window.attachEvent("onload",e);else{var o=window.onload;window.onload=function(){o&&o(),e()}}"complete"!==document.readyState&&"loaded"!==document.readyState&&"interactive"!==document.readyState||e()}function c(){try{var e=o("adsqa");if(e){var t=e.split("%3D");Z=t[0],ee=t[1],le.pageTargets[Z]=ee}}catch(n){pe("checkForAdsQA",n)}}function u(e){
if(window[e]){if(window[e].adTargets)for(var t in window[e].adTargets)window[e].adTargets.hasOwnProperty(t)&&(le.pageTargets[t]=window[e].adTargets[t]);if(window[e].slotTargets)for(var n in window[e].slotTargets)if(window[e].slotTargets.hasOwnProperty(n)){var i=window[e].slotTargets[n];le.slotTargets[n]||(le.slotTargets[n]={});for(var t in i)i.hasOwnProperty(t)&&(le.slotTargets[n][t]=i[t])}}}function d(e){var t=a(e.targeting);Array.isArray(t)||(t=[t]);var n=le.slotTargets;if(n[e.rktr_slot_id])for(var i in n[e.rktr_slot_id])n[e.rktr_slot_id].hasOwnProperty(i)&&t.push([i,n[e.rktr_slot_id][i]]);return t}function h(){i(window,"focus",function(){ue=!0}),i(window,"blur",function(){ue=!1})}function p(){i(document,"GPTRenderComplete",function(e){de("GPT Render Complete",{renderEvent:e});var t=document.getElementById(e.detail.divId);t&&t.className.indexOf("adfuel-rendered")<0&&(t.className+=" adfuel-rendered")})}function f(e,t){le.pageTargets[e]=t,ye.executeWhenAvailable("Adding Page Level Target",function(){ye.setTargeting(e,t)})}function g(e){ye.executeWhenAvailable("Removing Page Level Target",function(){ye.clearTargeting(e),e?delete le.pageTargets[e]:(le.pageTargets={},Z&&f(Z,ee))})}function m(e,t,n){le.slotTargets[e]=le.slotTargets[e]||{},le.slotTargets[e][t]=n,ye.executeWhenAvailable("Adding Slot Level Target",function(){var i=fe[e];i&&ye.setSlotTargeting(i,t,n)})}function _(e,t){ye.executeWhenAvailable("Removing Slot Level Target",function(){var t=fe[e];if(t){var n={},i=t.getTargetingKeys();for(var r in i){var o=i[r];n[o]=t.getTargeting(o)}s?delete n[s]:n={pos:n.pos},ye.clearSlotTargeting(t);for(var s in n)ye.setSlotTargeting(t,s,n[s])}le.slotTargets[e]&&(s?delete le.slotTargets[e][s]:le.slotTargets[e].length=0)})}function v(){var e=s("gptgeo");if(e){var t=e.split("%2C"),n=parseFloat(t[0]),i=parseFloat(t[1]);ye.executeWhenAvailable("setting location",function(){ye.setLocation(n,i)})}else he("Unable to retrieve location cookie",e);ye.executeWhenAvailable("setting page level targeting",function(){var e=a(ie),t=le.pageTargets;for(var n in t)t.hasOwnProperty(n)&&e.push([n,t[n]]);de("Page Level Targeting",JSON.stringify(e));for(var i=0;i<e.length;i++){var r=e[i][1];if(de("Setting Page-Level Targeting",e[i][0],r),r&&!Array.isArray(r)&&(r=r.indexOf(",")>=0?r.split(","):[r]),"exclusions"==e[i][0])for(var o=0;o<r.length;o++){var s=e[i][1][o];ye.setCategoryExclusion(s)}else{var l=e[i][0];ye.setTargeting(l,r)}}})}function y(e){var t=document.querySelectorAll("div#"+e.rktr_slot_id);if(0!=t.length)for(var n=0;n<t.length;n++){var i=t[n];if(!(i.className.indexOf("adfuel-rendered")>=0)){if(1==t.length&&fe[e.rktr_slot_id]){var r=A(e,!0);return b(r.rktr_slot_id),r}return A(e)}de("Found rendered slot...",e.rktr_slot_id)}return he("Not building slot... Can't Find Unrendered Slot On Page",e.rktr_slot_id),null}function C(e){var t=ae.networkId;e.inherit&&Y&&(e.rktr_ad_id=Y),de("Building Slot",e);var n="/"+t+"/"+e.rktr_ad_id,i=e.rktr_slot_id,r=e.rktr_slot_id.indexOf("_oop")>=1,o=r?"Defining OOP Slot":"Defining Standard Slot";ye.executeWhenAvailable(o,function(){r?fe[i]=ye.defineOutOfPageSlot(n,i):fe[i]=ye.defineSlot(n,e.sizes,i)}),de("Slots",fe),ye.executeWhenAvailable("Defining slot targeting",function(){var t=d(e);for(var n in t)if(t.hasOwnProperty(n)){var r;if(r=t[n]&&t[n][1]?JSON.stringify(t[n][1]):""){r=JSON.parse(r);var o=fe[i];if("exclusions"==t[n][0])if(Array.isArray(t[n][1]))for(var s in t[n][1])t[n][1].hasOwnProperty(s)&&(r=t[n][1][s],ye.setSlotCategoryExclusion(o,r));else ye.setSlotCategoryExclusion(o,r);else{var a=t[n][0];ye.setSlotTargeting(o,a,r)}}}}),de("Checking Responsive Mapping For Slot",e.responsive,e.responsive.length),e.responsive=e.responsive||[],e.responsive.length>0&&E(e.rktr_slot_id,e.responsive)}function w(e,t){function n(e){var t=ge.indexOf(e);t>=0&&ge.splice(t,1)}for(var i=[],r=0;r<e.length;r++){var o=e[r],s=t&&t.ignoreCheck,a=!0;s||y(o)||(n(o),a=!1),a&&(C(o),i.push(o),n(o))}return i}function b(e){e=e||[],Array.isArray(e)||(e=[e]),de("Clearing Slots",{slotDivIds:e}),ye.executeWhenAvailable("clearing slots",function(){var t=[];e.length>0&&(t=e.filter(function(e){return!!fe[e]}).map(function(e){return fe[e]}),0==t.length)||ye.clearSlots(t)})}function E(e,t){for(var n=0;n<t.length;n++){for(var i=JSON.parse(JSON.stringify(t[n])),r=0;r<i.length;r++)if(Array.isArray(i[r]))for(var o=0;o<i[r].length;o++)if(Array.isArray(i[r][o]))for(var s=0;s<i[r][o].length;s++)i[r][o][s]=parseInt(i[r][o][s]);else parseInt(i[r][o])>=0?i[r][o]=parseInt(i[r][o]):i[r]=[];else i[r]=[];t[n]=i}ye.executeWhenAvailable("setting slot mappings",function(){ye.defineSlotSizeMapping(fe[e],t)})}function A(e,t){de("Checking to see if slot div id needs updated.",{slot:e});var n=e.rktr_slot_id,i=n,o=n.split("_"),s=o[o.length-1],a=document.querySelectorAll("div#"+n);if(a.length>1||1==a.length&&t){for(de("updating slot div id.",{slot:e});fe[i];)3==o.length?s=r():(s=parseInt(s)+1,s=10>s?"0"+String(s):String(s)),o[o.length-1]=s,i=o.join("_");T(e,i,n),S(n,i)}return e}function T(e,t,n){e.rktr_slot_id=t;try{var i=new CustomEvent("SlotIdChange",{detail:{asset:e,originalId:n,newId:t}});document.dispatchEvent(i)}catch(r){he("error dispatching custom Event: SlotIdChange",r)}}function S(e,t){var n=document.querySelectorAll("div#"+e);if(n.length>0)for(var i=0;i<n.length;i++){var r=n[i];(r.className.indexOf("adfuel-rendered")<0&&n.length>1||1==n.length)&&(r.id=t)}}function k(){return ce&&re}function P(){if(k())if(me.length>0){for(var e=0;e<me.length;e++)me[e]();me.length=0}else ae.autoDispatch&&AdFuel.dispatchQueue()}function x(e){if(!k())return de("Delaying Queue Dispatch"),void me.push(function(){x(e)});if(e=e||{},de("Registry",AdFuel.registry),de("SlotQueue: ",ge),de("Dispatch Options: ",e),ge.length>0){var t=ge.filter(function(t){return(!e.slots||0==e.slots.length||e.slots.indexOf(t.rktr_slot_id)>=0)&&(!e.exclude||0==e.exclude.length||e.exclude.indexOf(t.rktr_slot_id)<0)&&(e.slots&&e.slots.length>0||ve.indexOf(t.rktr_slot_id)<0)});if(e.slots&&e.slots.length>0&&ve.length>0)for(var n=0;n<e.slots.length;n++){var i=ve.indexOf(e.slots[n]);i>=0&&ve.splice(i,1)}var r=w(t,e);if(r.length>0){v();var o=a(r),s=_e.filter(function(e){return!!e.callbacks.preDispatchCallback}).map(function(e){return oe(e.name,function(t){e.callbacks.preDispatchCallback(o,t)})});e&&e.preDispatchCallback&&s.push(oe("dispatchOptions",function(t){e.preDispatchCallback(o,t)})),async.parallelWithTimeout("preDispatch",ae.dispatchCallbackTimeoutInMilliseconds,s,function(t){t&&he("error calling preDispatchCallbacks for registered modules",t);var n=D(r,e),i=a(n),o=_e.filter(function(e){return!!e.callbacks.postDispatchCallback}).map(function(e){return oe(e.name,function(t){e.callbacks.postDispatchCallback(i,t)})});e&&e.postDispatchCallback&&o.push(oe("dispatchOptions",function(t){e.postDispatchCallback(i,t)})),async.parallelWithTimeout("postDispatch",ae.dispatchCallbackTimeoutInMilliseconds,o,function(e){e&&he("error calling postDispatchCallbacks for registered modules",e),de("Slot Queue After Dispatch:",ge)})})}}}function I(e,t){function n(){t.dispatch&&AdFuel.dispatchQueue(t)}if(t=t||{dispatch:ae.autoDispatch},t.exclude&&t.exclude.length>0)for(var i=0;i<t.exclude.length;i++){var r=t.exclude[i];ve.indexOf(r)<0&&ve.push(r)}!function(t){var n=document,i=n.createElement("script"),r=n.getElementsByTagName("script")[0],o=/^(complete|loaded)$/,s=!1;i.type="text/javascript",i.src=e,i.onload=i.onreadystatechange=function(){s||"readyState"in i&&o.test(i.readyState)||(i.onload=i.onreadystatechange=null,s=!0,t())},r.parentNode.insertBefore(i,r)}(n)}function R(e,t,n){function i(){if(o++==t){var a=n();a&&R(e,t,n)}else{var l=(new Date).getTime()-s-o*r;window.setTimeout(i,r-l)}}t=t||10;var r=e/t,o=0,s=(new Date).getTime();window.setTimeout(i,r)}function L(e,t){function n(e){de("starting refresh interval: "+e,t);var r=1e3*e;R(r,5,function(){if(!t.interval||0==parseInt(t.interval))return de("stopping refresh interval: "+e,t),!1;var r=parseInt(t.interval);return e!=r?(de("changing refresh interval: "+e,t),n(r),!1):(i(),!0)})}!e||Array.isArray(e)||t?t=t||{}:(t=e,e=[]),e||(e=[]),t.pageload=void 0==t.pageload?!0:t.pageload,de("Refresh Options",t);var i=function(){if(ue||!ae.refreshOnFocusOnly){var n=[],i=[],r=[];if(0==e.length)for(var o in fe)fe.hasOwnProperty(o)&&r.push(o);else r=e;for(var s=0;s<r.length;s++){var o=r[s];if(document.getElementById(o)){var a=fe[o];a&&(n.push(a),i.push(o))}else he("Cannot find element on page to refresh: "+o)}if(e.length>0&&0==i.length)return;var l=_e.filter(function(e){return!!e.callbacks.preRefreshCallback}).map(function(e){return oe(e.name,function(t){e.callbacks.preRefreshCallback(i,t)})});t.preRefreshCallback&&l.push(oe("refreshOptions",function(e){t.preRefreshCallback(i,e)})),async.parallelWithTimeout("preRefresh",ae.refreshCallbackTimeoutInMilliseconds,l,function(e){e&&he("error calling preRefreshCallbacks for all registered modules",e),b(i),ye.updateCorrelator(),t.pageload?ye.setTargeting("pageload","ref"):ye.clearTargeting("pageload"),ye.refreshSlots(n);var r=i,o=_e.filter(function(e){return!!e.callbacks.postRefreshCallback}).map(function(e){return oe(e.name,function(t){e.callbacks.postRefreshCallback(r,t)})});t.postRefreshCallback&&o.push(oe("refreshOptions",function(e){t.postRefreshCallback(r,e)})),async.parallelWithTimeout("postRefresh",ae.refreshCallbackTimeoutInMilliseconds,o,function(e){e&&he("error calling postRefreshCallbacks for all registered modules",e)})})}};if(t.interval&&parseInt(t.interval)>0){var r=parseInt(t.interval);n(r)}else i()}function D(e,t){de("Sending Request...",e),t=t||{sync:!1,syncSlots:[],maintainCorrelator:!1};var n=[];ye.configurePubAds();for(var i=function(e){ye.executeWhenAvailable("displaying slot",function(){ye.displaySlotById(e)})},r=0;r<e.length;r++){var o=e[r].rktr_slot_id;document.getElementById(o)?(i(o),n.push(e[r])):he("Can't Find Slot On Page",o)}var s=n.map(function(e){return e.rktr_slot_id});ye.executeWhenAvailable("refreshing slots",function(){var e=[];for(var n in fe)fe.hasOwnProperty(n)&&(t.sync&&(!t.syncSlots||0==t.syncSlots.length||t.syncSlots.indexOf(n)>=0)||s.indexOf(n)>=0)&&e.push(fe[n]);ye.refreshSlots(e)}),t.maintainCorrelator||ye.executeWhenAvailable("updating correlator",ye.updateCorrelator);try{var a=new CustomEvent("AdFuelRequestComplete",{detail:{slots:JSON.parse(JSON.stringify(n)),options:t}});document.dispatchEvent(a)}catch(l){he("error dispatching custom Event: AdFuelRequestComplete",l)}return n}function O(e){if(e)for(var t in e)if(e.hasOwnProperty(t))if("slotTargets"==t)for(var n in e[t])e[t].hasOwnProperty(n)&&AdFuel.addSlotLevelTarget(t,n,e[t][n]);else if("adTargets"==t)for(var n in e[t])e[t].hasOwnProperty(n)&&AdFuel.addPageLevelTarget(t,e[t]);else AdFuel.addPageLevelTarget(t,e[t])}function F(e){if(e.indexOf("/")>=0){var t=e.split("/")[0];if(parseInt(t)>0){var n=e.split("/");n.splice(0,1),e=n.join("/")}}return e}function M(e,t){de(t,e)}function N(e){de("Queuing Singleton",e),e.size=e.size||[[88,31]],e.targets=e.targets||[],e.responsive=e.responsive||[];var t=e.divId;e.adunit=F(e.adunit);var n={singleton:!0,rktr_id:"singleton_"+t,gpt_id:ae.networkId,root:e.adunit.split("/")[0].toUpperCase(),responsive:[],rktr_slot_id:"page"};if(ie&&e.targets.length>0){for(var i=[],r=0;r<e.targets.length;r++){for(var o=e.targets[r],s=!1,a=0;a<ie.length;a++)ie[a][0]==o[0]&&(s=!0);s||i.push(o)}e.targets=i}n.targeting=ie;var l={present:!0,responsive:e.responsive,rktr_slot_id:e.divId,sizes:e.size,targeting:e.targets,rktr_ad_id:e.adunit,inherit:e.inherit};if(l=y(l)){var c=[n,l];AdFuel.registry.push(c),e.dispatch&&!ae.autoDispatch&&AdFuel.dispatchQueue({slots:[l.rktr_slot_id]})}else he("missing singleton: "+e.divId)}function j(e){I(e,{dispatch:!0})}function B(e,t,n){AdFuel.refresh([e],{pageload:t,interval:0,updateCorrelator:n})}function U(e,t,n,i){AdFuel.refresh([e],{pageload:n||!1,interval:t||0,updateCorrelator:i||!0})}function q(e,t,n,i){AdFuel.refresh(e,{pageload:n||!1,interval:t||0,updateCorrelator:i||!0})}function V(e,t,n){var i={pageload:t||!1,interval:e||0,updateCorrelator:n||!0};return AdFuel.refresh([],i),!0}function z(e,t,n,i,r,o,s,a){e.indexOf("ad_carousel_slide")>=0&&(r="NBA/homepage"),N({divId:e,size:t,targets:n,responsive:i,adunit:r,delay:o,inherit:s,dispatch:void 0==a?!0:a,sync:!1,syncSlots:[]})}function Q(){i(document,"AdFuelRequestComplete",function(e){de("AdFuel Request Complete",{requestEvent:e})}),i(document,"GPTRenderComplete",function(e){de("GPT Render Complete",{renderEvent:e})}),i(document,"GPTSlotBuildComplete",function(e){de("GPT Slot Build Complete",{renderEvent:e})}),i(document,"SlotIdChange",function(e){de("Slot ID Change",{idChangeEvent:e})})}function H(){if(!ce){ce=!0,h(),p(),c(),Q(),l(),P();try{var e=new CustomEvent("AdFuelCreated",{detail:{AdFuel:window.AdFuel}});document.dispatchEvent(e)}catch(t){he("error dispatching custom Event: AdFuelCreated",t)}}}function W(){return a(ge)}function K(e){for(var t,n=0;n<AdFuel.registry.length;n++)for(var i=AdFuel.registry[n],r=1;r<i.length;r++){var o=i[r];o.rktr_slot_id==e&&(t=a(o))}var s,l={},c=fe[e];if(c){s=c.getAdUnitPath();var u=c.getTargetingKeys();for(var d in u){var h=u[d];l[h]=c.getTargeting(h)}}return{adUnit:s,slot:t,slotTargeting:l}}function $(e,t){de("registering module: "+e);for(var n=-1,i=0;i<_e.length;i++)_e[i].name==e&&(n=i);n>=0?_e[n].callbacks=t:_e.push({name:e,callbacks:t})}function J(e){for(var t=-1,n=0;n<_e.length;n++)_e[n].name==e&&(t=n);t>=0&&_e.splice(t,1)}function G(e){var t=arguments.callee,n="window/console";try{n=t.caller.toString()}catch(i){n="window/console"}return function(){return ce?void e.apply(this,arguments):(pe("ERROR: AdFuel must be initialized first!"),void de("------------------FUNCTION --------------------",e,"--------------- END FUNCTION ------------------","called by: "+n))}}function X(e){if(e){if(e.exclude&&e.exclude.length>0)for(var t=0;t<e.exclude.length;t++){var n=e.exclude[t];ve.indexOf(n)<0&&ve.push(n)}for(var i in e)e.hasOwnProperty(i)&&(ae[i]=e[i])}}var Y,Z,ee,te=Array.prototype.slice,ne=function(){},ie=[],re=!1,oe=function(e,t){return{name:e,callback:t}},se=function(){var e=[];return e.push=function(t){var n=a(t),i=_e.filter(function(e){return!!e.callbacks.preQueueCallback}).map(function(e){return oe(e.name,function(t){e.callbacks.preQueueCallback(n,t)})});async.parallelWithTimeout("preQueue",ae.queueCallbackTimeoutInMilliseconds,i,function(n){n&&he("error calling preQueueCallbacks for registered modules",n),Array.prototype.push.call(e,t),t[0].singleton||(ie=t[0].targeting,Y=F(t[1].rktr_ad_id));var i=t[0].root.toUpperCase();u(i);for(var r=t[0].rktr_id,o=new Date,s=1;s<t.length;s++){var l=t[s];l.parentRegistry=r,l.adfuel_queued_date=o,l.queued||(l.queued=!0,ge.push(l))}var c=a(ge),d=_e.filter(function(e){return!!e.callbacks.postQueueCallback}).map(function(e){return oe(e.name,function(t){e.callbacks.postQueueCallback(c,t)})});async.parallelWithTimeout("postQueue",ae.queueCallbackTimeoutInMilliseconds,d,function(e){e&&he("error calling postQueueCallbacks for registered modules",e),ae.autoDispatch&&AdFuel.dispatchQueue()})})},e},ae={refreshOnFocusOnly:!1,networkId:"8663477",autoDispatch:!0,exclude:[],queueCallbackTimeoutInMilliseconds:300,dispatchCallbackTimeoutInMilliseconds:300,refreshCallbackTimeoutInMilliseconds:300},le={pageTargets:{},slotTargets:{}},ce=!1,ue=!0,de="true"==o("debug")?t(n,null,"[AdFuel - DEBUG]"):ne,he=t(n,null,"[AdFuel - WARNING]"),pe=t(n,null,"[AdFuel - ERROR]"),fe={},ge=[],me=[],_e=[],ve=[],ye=function(){function e(e,t){return v||(v=window.googletag.apiReady&&window.googletag.pubads,!v&&e&&pe("GPT is unavailable - "+e,t)),v}function t(e,t){window.googletag.cmd.push(t)}function n(){_||(_=!0,AdFuel.requestScriptText+="googletag.pubads().collapseEmptyDivs(true);\n",AdFuel.requestScriptText+="googletag.pubads().enableAsyncRendering();\n",AdFuel.requestScriptText+="googletag.pubads().enableSingleRequest();\n",AdFuel.requestScriptText+="googletag.pubads().disableInitialLoad();\n",AdFuel.requestScriptText+="googletag.enableServices();\n",t("Sending Request",function(){window.googletag.pubads().addEventListener("slotRenderEnded",function(e){try{var t={};e.slot&&(t.asset=e.slot),e.slot.getTargeting("pos")&&(t.pos=e.slot.getTargeting("pos")),e.isEmpty?t.empty=!0:t.empty=!1,e.size&&(t.renderedSize=e.size),e.creativeId&&(t.creativeId=e.creativeId),e.lineItemId&&(t.lineItemId=e.lineItemId),e.serviceName&&(t.serviceName=e.serviceName),e.slot.getSlotElementId()&&(t.divId=e.slot.getSlotElementId()),de("GPTRenderComplete Details: ",t);var n=new CustomEvent("GPTRenderComplete",{detail:t});document.dispatchEvent(n)}catch(i){he("error dispatching custom Event: GPTRenderComplete",i)}}),window.googletag.pubads().collapseEmptyDivs(!0),window.googletag.pubads().enableAsyncRendering(),window.googletag.pubads().enableSingleRequest(),window.googletag.pubads().disableInitialLoad(),window.googletag.enableServices()}))}function i(t){var n=!1;return e("clearing target",{key:t?t:"all"})&&(t?window.googletag.pubads().clearTargeting(t):window.googletag.pubads().clearTargeting(),n=!0),n}function r(t,n){var i=!1;return e("setting target",{key:t,value:n})&&(window.googletag.pubads().setTargeting(t,n),i=!0),i}function o(t,n){var i=!1;return e("setting location",{latitude:t,logitude:n})&&(window.googletag.pubads().setLocation(t,n),i=!0),i}function s(t){var n=!1;return e("setting category exclusion: "+t)&&(AdFuel.requestScriptText+="googletag.pubads().setCategoryExclusion('"+t+"');\n",window.googletag.pubads().setCategoryExclusion(t),n=!0),n}function a(){var t=!1;return e("updating correlator")&&(AdFuel.requestScriptText+="googletag.pubads().updateCorrelator();\n",window.googletag.pubads().updateCorrelator(),t=!0),t}function l(t,n){var i;return e("defining out of page slot",{adPath:t,slotId:n})&&(de("Building OOP Slot Object",{adPath:t,slotId:n}),AdFuel.requestScriptText+="\n_pageSlots['"+n+"'] = googletag.defineOutOfPageSlot('"+t+"', '"+n+"').addService(googletag.pubads());\n",i=window.googletag.defineOutOfPageSlot(t,n).addService(window.googletag.pubads())),i}function c(t,n,i){var r;return e("defining standard slot",{adPath:t,sizes:n,slotId:i})&&(de("Building Standard Slot Object",{adPath:t,sizes:n,slotId:i}),AdFuel.requestScriptText+="\n_pageSlots['"+i+"'] = googletag.defineSlot('"+t+"', "+JSON.stringify(n)+", '"+i+"').addService(googletag.pubads());\n",r=window.googletag.defineSlot(t,n,i).addService(window.googletag.pubads())),r}function u(e,t){var n=e.getSlotElementId();de("Setting Slot Category Exclusion",{slotId:n,value:t}),AdFuel.requestScriptText+="_pageSlots['"+n+"'].setCategoryExclusion('"+t+"');\n",e.setCategoryExclusion(t)}function d(e,t,n){var i=e.getSlotElementId();de("Setting Slot Targeting",{slotId:i,key:t,value:n}),AdFuel.requestScriptText+="_pageSlots['"+i+"'].setTargeting('"+t+"', '"+n+"');\n",e.setTargeting(t,n)}function h(e,t){var n=e.getSlotElementId();de("Setting Slot size mapping",{slotId:n,responsiveMap:t}),AdFuel.requestScriptText+="_pageSlots['"+n+"'].defineSizeMapping('"+JSON.stringify(t)+"');\n",e.defineSizeMapping(t)}function p(e){de("Displaying Slot: "+e),AdFuel.requestScriptText+='googletag.display("'+e+'");\n',window.googletag.display(e)}function f(e){var t=e.getSlotElementId();de("Clearing targeting for Slot: "+t),AdFuel.requestScriptText+="_pageSlots['"+t+"'].clearTargeting();\n",e.clearTargeting()}function g(e){var t=0==e.length?"all":e.map(function(e){return e.getSlotElementId()}).join(",");AdFuel.requestScriptText+="googletag.pubads().clear("+t+");\n",e.length>0?window.googletag.pubads().clear(e):window.googletag.pubads().clear()}function m(e){var t=0==e.length?"all":e.map(function(e){return e.getSlotElementId()}).join(",");AdFuel.requestScriptText+="googletag.pubads().refresh("+t+");\n",e.length>0?window.googletag.pubads().refresh(e):window.googletag.pubads().refresh()}window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[];var _=!1,v=!1;return{executeWhenAvailable:t,isAvailable:e,configurePubAds:n,clearTargeting:i,setTargeting:r,setLocation:o,setCategoryExclusion:s,updateCorrelator:a,defineOutOfPageSlot:l,defineSlot:c,setSlotCategoryExclusion:u,setSlotTargeting:d,displaySlotById:p,defineSlotSizeMapping:h,refreshSlots:m,clearSlots:g,clearSlotTargeting:f}}();return{init:H,logit:M,addEvent:i,setOptions:X,clearSlot:G(b),clearSlots:G(b),clearAllSlots:G(b),queueSingleton:N,processNewRegistry:j,reloadAd:G(B),refreshAd:G(U),refreshAds:G(q),refreshAllAds:G(V),renderSingleSlot:z,requestAndRenderAds:x,pageSlots:fe,pageSlotsObj:fe,setBulkTargeting:O,dispatchQueue:x,queueRegistry:I,getQueuedSlots:W,getSlotDetails:K,refresh:G(L),removePageLevelTarget:G(g),removeSlotLevelTarget:G(_),addPageLevelTarget:G(f),addSlotLevelTarget:G(m),generateSingletonId:r,registry:new se,requestScriptText:"",readCookie:s,registerModule:$,unregisterModule:J}}();window.AMPTManager=window.AdFuel,window.AdFuel.init(),CNN.AdsConfig=CNN.AdsConfig||{},CNN.AdsConfig.amazon=CNN.AdsConfig.amazon||{},CNN.AmazonVideoAds=CNN.AmazonVideoAds||{},CNN.Features=CNN.Features||{},CNN.AmazonVideoAds.Manager=function(){"use strict";this.initialize=function(){var e={amznkey:CNN.AdsConfig.amazon.amznkey||"3159",timeout:"number"==typeof CNN.AdsConfig.amazon.timeout?CNN.AdsConfig.amazon.timeout:2e3};CNN.Features.enableAmazonVideoAds===!0&&"object"==typeof AmazonDirectMatchBuy&&AmazonDirectMatchBuy.init(e)},this.cvpAdSetup=function(e,t){CNN.Features.enableAmazonVideoAds&&"object"==typeof AmazonDirectMatchBuy&&(AmazonDirectMatchBuy.setAdKeyValuePairs(window.cnnVideoManager.getPlayerByContainer(e).videoInstance.cvp),AmazonDirectMatchBuy.requestAdRefresh())},this.addAmazonCallback=function(e){"undefined"!=typeof e&&(e.onAdSetup=this.cvpAdSetup)},this.initialize()},CNN.AmazonVideoAds.Manager.getInstance=function(){"use strict";return"undefined"==typeof window.amazonAdManager&&(window.amazonAdManager=new CNN.AmazonVideoAds.Manager),window.amazonAdManager},CNN.Utils=CNN.Utils||function(e,t,n,i){"use strict";function r(e){var t=null;return"string"==typeof e&&Date.parse(e)?t=e:"number"==typeof e&&(t=new Date(Date.now()+e*b).toGMTString()),t}function o(e){var t,n=!0,r=function(e){return e!==i&&null!==e};for(t=0;t<arguments.length;t++)if(!r(arguments[t])){n=!1;break}return n}function s(e){var t,n=!0,i=function(e){return"object"==typeof e&&null!==e};for(t=0;t<arguments.length;t++)if(!i(arguments[t])){n=!1;break}return n}function a(){var e,t,i={},r=0;if(n.cookie)for(e=n.cookie.split("; ");r<e.length;r++)t=e[r].split("="),i[t[0]]=decodeURIComponent(t[1])||null;return i}function l(e){return null!==c(e)}function c(e){var t=new RegExp("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)"),i=n.cookie.match(t);return i?i.pop():null}function u(e,t,i,s,a,l){var c="";o(e)&&o(t)&&(i=r(i),s=o(s)?s:"/",a=o(a)?a:"",l=o(l)?l:!1,c+=e+"="+encodeURIComponent(t),o(i)&&(c+=";expires="+i),s&&(c+=";path="+s),a&&(c+=";domain="+a),l&&(c+="; secure"),n.cookie=c)}function d(e,t,n,i){u(e,t,n,"/",".cnn.com",i)}function h(e,t,i){var r="";o(e)&&(t=o(t)?t:"/",i=o(i)?i:"",r+=e+"=;expires="+E,t&&(r+=";path="+t),i&&(r+=";domain="+i),n.cookie=r)}function p(e){h(e,"/",".cnn.com")}function f(e,n,i){var r;if("string"==typeof e&&e.length>0&&"string"==typeof n)if(w===!1)u(e,n,i,"/",".cnn.com",!1);else try{t.localStorage.setItem(e,n),"number"==typeof i?(r=new Date(Date.now()+i*b),t.localStorage.setItem(e+"__expires",r.getTime().toString(10))):"string"==typeof i&&(r=new Date(i),r.getTime()>Date.now()&&t.localStorage.setItem(e+"__expires",r.getTime().toString(10)))}catch(o){}}function g(e){if("string"==typeof e&&e.length>0)if(w===!1)h(e);else try{t.localStorage.removeItem(e),t.localStorage.removeItem(e+"__expires")}catch(n){}}function m(e){var n,i=null;if("string"==typeof e&&e.length>0)try{w===!1?c(e):null!==(n=t.localStorage.getItem(e+"__expires"))?parseInt(n,10)>Date.now()?i=t.localStorage.getItem(e):g(e):i=t.localStorage.getItem(e)}catch(r){}return i}function _(e){var n,i,r,o,s,a,l=e;if("function"==typeof t.btoa)try{n=t.btoa(l)}catch(c){n=t.btoa(e.replace(/[^\w\s\!\@\#\$\%\^\&\*\(\)\-\=\+\.\,\\\;\:\'\"\?]/,"-"))}else{if(i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),r="",o="",s=l.length%3,s>0)for(;3>s;s++)o+="=",l+="\x00";for(s=0;s<l.length;s+=3)s>0&&s/3*4%76===0&&(r+="\r\n"),a=(l.charCodeAt(s)<<16)+(l.charCodeAt(s+1)<<8)+l.charCodeAt(s+2),a=[a>>>18&63,a>>>12&63,a>>>6&63,63&a],r+=i[a[0]]+i[a[1]]+i[a[2]]+i[a[3]];n=r.substring(0,r.length-o.length)+o}return n}function v(e){var n,i,r,o,s,a,l,c,u=e;if("function"==typeof t.atob)try{n=t.atob(u)}catch(d){console.log(d.message,"\nString to decode: "+u)}else{for(i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),r={},c=0;c<i.length;c++)r[i[c]]=c;for(u=u.replace(new RegExp("[^"+i.join("")+"=]","g"),""),s="="===u.charAt(u.length-1)?"="===u.charAt(u.length-2)?"AA":"A":"",o="",u=u.substr(0,u.length-s.length)+s,a=0;a<u.length;a+=4)l=(r[u.charAt(a)]<<18)+(r[u.charAt(a+1)]<<12)+(r[u.charAt(a+2)]<<6)+r[u.charAt(a+3)],o+=String.fromCharCode(l>>>16&255,l>>>8&255,255&l);n=o.substring(0,o.length-s.length)}return n}function y(e){return e.replace("#","")}function C(){return t.Modernizr.phone}var w,b=36e5,E="Thu, 01 Jan 1970 00:00:00 UTC";return w=function(){try{var e="__test_it";return t.localStorage.setItem(e,e),t.localStorage.removeItem(e),!0}catch(n){return!1}}(),{exists:o,existsObject:s,getCookies:a,getCookie:c,cookieExists:l,setCookie:u,deleteCookie:h,setCNNCookie:d,deleteCNNCookie:p,storeLocalValue:f,deleteLocalValue:g,getLocalValue:m,b64Encode:_,b64Decode:v,stripHash:y,isPhone:C}}(jQuery,window,document),function(e){var t=function(){"use strict";return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(e){return!e||/^\s*$/.test(e)},escapeRegExChars:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isArray:e.isArray,isFunction:e.isFunction,isObject:e.isPlainObject,isUndefined:function(e){return"undefined"==typeof e},toStr:function(e){return t.isUndefined(e)||null===e?"":e+""},bind:e.proxy,each:function(t,n){function i(e,t){return n(t,e)}e.each(t,i)},map:e.map,filter:e.grep,every:function(t,n){var i=!0;return t?(e.each(t,function(e,r){return(i=n.call(null,r,e,t))?void 0:!1}),!!i):i},some:function(t,n){var i=!1;return t?(e.each(t,function(e,r){return(i=n.call(null,r,e,t))?!1:void 0}),!!i):i},mixin:e.extend,getUniqueId:function(){var e=0;return function(){return e++}}(),templatify:function(t){function n(){return String(t)}return e.isFunction(t)?t:n},defer:function(e){setTimeout(e,0)},debounce:function(e,t,n){var i,r;return function(){var o,s,a=this,l=arguments;return o=function(){i=null,n||(r=e.apply(a,l))},s=n&&!i,clearTimeout(i),i=setTimeout(o,t),s&&(r=e.apply(a,l)),r}},throttle:function(e,t){var n,i,r,o,s,a;return s=0,a=function(){s=new Date,r=null,o=e.apply(n,i)},function(){var l=new Date,c=t-(l-s);return n=this,i=arguments,0>=c?(clearTimeout(r),r=null,s=l,o=e.apply(n,i)):r||(r=setTimeout(a,c)),o}},noop:function(){}}}(),n="0.10.5",i=function(){"use strict";function e(e){return e=t.toStr(e),e?e.split(/\s+/):[]}function n(e){return e=t.toStr(e),e?e.split(/\W+/):[]}function i(e){return function(){var n=[].slice.call(arguments,0);return function(i){var r=[];return t.each(n,function(n){r=r.concat(e(t.toStr(i[n])))}),r}}}return{nonword:n,whitespace:e,obj:{nonword:i(n),whitespace:i(e)}}}(),r=function(){"use strict";function n(n){this.maxSize=t.isNumber(n)?n:100,this.reset(),this.maxSize<=0&&(this.set=this.get=e.noop)}function i(){this.head=this.tail=null}function r(e,t){this.key=e,this.val=t,this.prev=this.next=null}return t.mixin(n.prototype,{set:function(e,t){var n,i=this.list.tail;this.size>=this.maxSize&&(this.list.remove(i),delete this.hash[i.key]),(n=this.hash[e])?(n.val=t,this.list.moveToFront(n)):(n=new r(e,t),this.list.add(n),this.hash[e]=n,this.size++)},get:function(e){var t=this.hash[e];return t?(this.list.moveToFront(t),t.val):void 0},reset:function(){this.size=0,this.hash={},this.list=new i}}),t.mixin(i.prototype,{add:function(e){this.head&&(e.next=this.head,this.head.prev=e),this.head=e,this.tail=this.tail||e},remove:function(e){e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev},moveToFront:function(e){this.remove(e),this.add(e)}}),n}(),o=function(){"use strict";function e(e){this.prefix=["__",e,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+t.escapeRegExChars(this.prefix))}function n(){return(new Date).getTime()}function i(e){return JSON.stringify(t.isUndefined(e)?null:e)}function r(e){return JSON.parse(e)}var o,s;try{o=window.localStorage,o.setItem("~~~","!"),o.removeItem("~~~")}catch(a){o=null}return s=o&&window.JSON?{_prefix:function(e){return this.prefix+e},_ttlKey:function(e){return this._prefix(e)+this.ttlKey},get:function(e){return this.isExpired(e)&&this.remove(e),r(o.getItem(this._prefix(e)))},set:function(e,r,s){return t.isNumber(s)?o.setItem(this._ttlKey(e),i(n()+s)):o.removeItem(this._ttlKey(e)),o.setItem(this._prefix(e),i(r))},remove:function(e){return o.removeItem(this._ttlKey(e)),o.removeItem(this._prefix(e)),this},clear:function(){var e,t,n=[],i=o.length;for(e=0;i>e;e++)(t=o.key(e)).match(this.keyMatcher)&&n.push(t.replace(this.keyMatcher,""));for(e=n.length;e--;)this.remove(n[e]);return this},isExpired:function(e){var i=r(o.getItem(this._ttlKey(e)));return!!(t.isNumber(i)&&n()>i)}}:{get:t.noop,set:t.noop,remove:t.noop,clear:t.noop,isExpired:t.noop},t.mixin(e.prototype,s),e}(),s=function(){"use strict";function n(t){t=t||{},this.cancelled=!1,this.lastUrl=null,this._send=t.transport?i(t.transport):e.ajax,this._get=t.rateLimiter?t.rateLimiter(this._get):this._get,this._cache=t.cache===!1?new r(0):l}function i(n){return function(i,r){function o(e){t.defer(function(){a.resolve(e)})}function s(e){t.defer(function(){a.reject(e)})}var a=e.Deferred();return n(i,r,o,s),a}}var o=0,s={},a=6,l=new r(10);return n.setMaxPendingRequests=function(e){a=e},n.resetCache=function(){l.reset()},t.mixin(n.prototype,{_get:function(e,t,n){function i(t){n&&n(null,t),u._cache.set(e,t)}function r(){n&&n(!0)}function l(){o--,delete s[e],u.onDeckRequestArgs&&(u._get.apply(u,u.onDeckRequestArgs),u.onDeckRequestArgs=null)}var c,u=this;this.cancelled||e!==this.lastUrl||((c=s[e])?c.done(i).fail(r):a>o?(o++,s[e]=this._send(e,t).done(i).fail(r).always(l)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(e,n,i){var r;return t.isFunction(n)&&(i=n,n={}),this.cancelled=!1,this.lastUrl=e,(r=this._cache.get(e))?t.defer(function(){i&&i(null,r)}):this._get(e,n,i),!!r},cancel:function(){this.cancelled=!0}}),n}(),a=function(){"use strict";function n(t){t=t||{},t.datumTokenizer&&t.queryTokenizer||e.error("datumTokenizer and queryTokenizer are both required"),this.datumTokenizer=t.datumTokenizer,this.queryTokenizer=t.queryTokenizer,this.reset()}function i(e){return e=t.filter(e,function(e){return!!e}),e=t.map(e,function(e){return e.toLowerCase()})}function r(){return{ids:[],children:{}}}function o(e){for(var t={},n=[],i=0,r=e.length;r>i;i++)t[e[i]]||(t[e[i]]=!0,n.push(e[i]));return n}function s(e,t){function n(e,t){return e-t}var i=0,r=0,o=[];e=e.sort(n),t=t.sort(n);for(var s=e.length,a=t.length;s>i&&a>r;)e[i]<t[r]?i++:e[i]>t[r]?r++:(o.push(e[i]),i++,r++);return o}return t.mixin(n.prototype,{bootstrap:function(e){this.datums=e.datums,this.trie=e.trie},add:function(e){var n=this;e=t.isArray(e)?e:[e],t.each(e,function(e){var o,s;o=n.datums.push(e)-1,s=i(n.datumTokenizer(e)),t.each(s,function(e){var t,i,s;for(t=n.trie,i=e.split("");s=i.shift();)t=t.children[s]||(t.children[s]=r()),t.ids.push(o)})})},get:function(e){var n,r,a=this;return n=i(this.queryTokenizer(e)),t.each(n,function(e){var t,n,i,o;if(r&&0===r.length)return!1;for(t=a.trie,n=e.split("");t&&(i=n.shift());)t=t.children[i];return t&&0===n.length?(o=t.ids.slice(0),
void(r=r?s(r,o):o)):(r=[],!1)}),r?t.map(o(r),function(e){return a.datums[e]}):[]},reset:function(){this.datums=[],this.trie=r()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),n}(),l=function(){"use strict";function i(e){return e.local||null}function r(i){var r,o;return o={url:null,thumbprint:"",ttl:864e5,filter:null,ajax:{}},(r=i.prefetch||null)&&(r=t.isString(r)?{url:r}:r,r=t.mixin(o,r),r.thumbprint=n+r.thumbprint,r.ajax.type=r.ajax.type||"GET",r.ajax.dataType=r.ajax.dataType||"json",!r.url&&e.error("prefetch requires url to be set")),r}function o(n){function i(e){return function(n){return t.debounce(n,e)}}function r(e){return function(n){return t.throttle(n,e)}}var o,s;return s={url:null,cache:!0,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}},(o=n.remote||null)&&(o=t.isString(o)?{url:o}:o,o=t.mixin(s,o),o.rateLimiter=/^throttle$/i.test(o.rateLimitBy)?r(o.rateLimitWait):i(o.rateLimitWait),o.ajax.type=o.ajax.type||"GET",o.ajax.dataType=o.ajax.dataType||"json",delete o.rateLimitBy,delete o.rateLimitWait,!o.url&&e.error("remote requires url to be set")),o}return{local:i,prefetch:r,remote:o}}();!function(n){"use strict";function r(t){t&&(t.local||t.prefetch||t.remote)||e.error("one of local, prefetch, or remote is required"),this.limit=t.limit||5,this.sorter=c(t.sorter),this.dupDetector=t.dupDetector||u,this.local=l.local(t),this.prefetch=l.prefetch(t),this.remote=l.remote(t),this.cacheKey=this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null,this.index=new a({datumTokenizer:t.datumTokenizer,queryTokenizer:t.queryTokenizer}),this.storage=this.cacheKey?new o(this.cacheKey):null}function c(e){function n(t){return t.sort(e)}function i(e){return e}return t.isFunction(e)?n:i}function u(){return!1}var d,h;return d=n.Bloodhound,h={data:"data",protocol:"protocol",thumbprint:"thumbprint"},n.Bloodhound=r,r.noConflict=function(){return n.Bloodhound=d,r},r.tokenizers=i,t.mixin(r.prototype,{_loadPrefetch:function(t){function n(e){o.clear(),o.add(t.filter?t.filter(e):e),o._saveToStorage(o.index.serialize(),t.thumbprint,t.ttl)}var i,r,o=this;return(i=this._readFromStorage(t.thumbprint))?(this.index.bootstrap(i),r=e.Deferred().resolve()):r=e.ajax(t.url,t.ajax).done(n),r},_getFromRemote:function(e,t){function n(e,n){t(e?[]:o.remote.filter?o.remote.filter(n):n)}var i,r,o=this;if(this.transport)return e=e||"",r=encodeURIComponent(e),i=this.remote.replace?this.remote.replace(this.remote.url,e):this.remote.url.replace(this.remote.wildcard,r),this.transport.get(i,this.remote.ajax,n)},_cancelLastRemoteRequest:function(){this.transport&&this.transport.cancel()},_saveToStorage:function(e,t,n){this.storage&&(this.storage.set(h.data,e,n),this.storage.set(h.protocol,location.protocol,n),this.storage.set(h.thumbprint,t,n))},_readFromStorage:function(e){var t,n={};return this.storage&&(n.data=this.storage.get(h.data),n.protocol=this.storage.get(h.protocol),n.thumbprint=this.storage.get(h.thumbprint)),t=n.thumbprint!==e||n.protocol!==location.protocol,n.data&&!t?n.data:null},_initialize:function(){function n(){r.add(t.isFunction(o)?o():o)}var i,r=this,o=this.local;return i=this.prefetch?this._loadPrefetch(this.prefetch):e.Deferred().resolve(),o&&i.done(n),this.transport=this.remote?new s(this.remote):null,this.initPromise=i.promise()},initialize:function(e){return!this.initPromise||e?this._initialize():this.initPromise},add:function(e){this.index.add(e)},get:function(e,n){function i(e){var i=o.slice(0);t.each(e,function(e){var n;return n=t.some(i,function(t){return r.dupDetector(e,t)}),!n&&i.push(e),i.length<r.limit}),n&&n(r.sorter(i))}var r=this,o=[],s=!1;o=this.index.get(e),o=this.sorter(o).slice(0,this.limit),o.length<this.limit?s=this._getFromRemote(e,i):this._cancelLastRemoteRequest(),s||(o.length>0||!this.transport)&&n&&n(o)},clear:function(){this.index.reset()},clearPrefetchCache:function(){this.storage&&this.storage.clear()},clearRemoteCache:function(){this.transport&&s.resetCache()},ttAdapter:function(){return t.bind(this.get,this)}}),r}(this);var c=function(){return{wrapper:'<span class="twitter-typeahead"></span>',dropdown:'<span class="tt-dropdown-menu"></span>',dataset:'<div class="tt-dataset-%CLASS%"></div>',suggestions:'<span class="tt-suggestions"></span>',suggestion:'<div class="tt-suggestion"></div>'}}(),u=function(){"use strict";var e={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},suggestions:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};return t.isMsie()&&t.mixin(e.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),t.isMsie()&&t.isMsie()<=7&&t.mixin(e.input,{marginTop:"-1px"}),e}(),d=function(){"use strict";function n(t){t&&t.el||e.error("EventBus initialized without el"),this.$el=e(t.el)}var i="typeahead:";return t.mixin(n.prototype,{trigger:function(e){var t=[].slice.call(arguments,1);this.$el.trigger(i+e,t)}}),n}(),h=function(){"use strict";function e(e,t,n,i){var r;if(!n)return this;for(t=t.split(l),n=i?a(n,i):n,this._callbacks=this._callbacks||{};r=t.shift();)this._callbacks[r]=this._callbacks[r]||{sync:[],async:[]},this._callbacks[r][e].push(n);return this}function t(t,n,i){return e.call(this,"async",t,n,i)}function n(t,n,i){return e.call(this,"sync",t,n,i)}function i(e){var t;if(!this._callbacks)return this;for(e=e.split(l);t=e.shift();)delete this._callbacks[t];return this}function r(e){var t,n,i,r,s;if(!this._callbacks)return this;for(e=e.split(l),i=[].slice.call(arguments,1);(t=e.shift())&&(n=this._callbacks[t]);)r=o(n.sync,this,[t].concat(i)),s=o(n.async,this,[t].concat(i)),r()&&c(s);return this}function o(e,t,n){function i(){for(var i,r=0,o=e.length;!i&&o>r;r+=1)i=e[r].apply(t,n)===!1;return!i}return i}function s(){var e;return e=window.setImmediate?function(e){setImmediate(function(){e()})}:function(e){setTimeout(function(){e()},0)}}function a(e,t){return e.bind?e.bind(t):function(){e.apply(t,[].slice.call(arguments,0))}}var l=/\s+/,c=s();return{onSync:n,onAsync:t,off:i,trigger:r}}(),p=function(e){"use strict";function n(e,n,i){for(var r,o=[],s=0,a=e.length;a>s;s++)o.push(t.escapeRegExChars(e[s]));return r=i?"\\b("+o.join("|")+")\\b":"("+o.join("|")+")",n?new RegExp(r):new RegExp(r,"i")}var i={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(r){function o(t){var n,i,o;return(n=a.exec(t.data))&&(o=e.createElement(r.tagName),r.className&&(o.className=r.className),i=t.splitText(n.index),i.splitText(n[0].length),o.appendChild(i.cloneNode(!0)),t.parentNode.replaceChild(o,i)),!!n}function s(e,t){for(var n,i=3,r=0;r<e.childNodes.length;r++)n=e.childNodes[r],n.nodeType===i?r+=t(n)?1:0:s(n,t)}var a;r=t.mixin({},i,r),r.node&&r.pattern&&(r.pattern=t.isArray(r.pattern)?r.pattern:[r.pattern],a=n(r.pattern,r.caseSensitive,r.wordsOnly),s(r.node,o))}}(window.document),f=function(){"use strict";function n(n){var r,o,a,l,c=this;n=n||{},n.input||e.error("input is missing"),r=t.bind(this._onBlur,this),o=t.bind(this._onFocus,this),a=t.bind(this._onKeydown,this),l=t.bind(this._onInput,this),this.$hint=e(n.hint),this.$input=e(n.input).on("blur.tt",r).on("focus.tt",o).on("keydown.tt",a),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=t.noop),t.isMsie()?this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(e){s[e.which||e.keyCode]||t.defer(t.bind(c._onInput,c,e))}):this.$input.on("input.tt",l),this.query=this.$input.val(),this.$overflowHelper=i(this.$input)}function i(t){return e('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:t.css("font-family"),fontSize:t.css("font-size"),fontStyle:t.css("font-style"),fontVariant:t.css("font-variant"),fontWeight:t.css("font-weight"),wordSpacing:t.css("word-spacing"),letterSpacing:t.css("letter-spacing"),textIndent:t.css("text-indent"),textRendering:t.css("text-rendering"),textTransform:t.css("text-transform")}).insertAfter(t)}function r(e,t){return n.normalizeQuery(e)===n.normalizeQuery(t)}function o(e){return e.altKey||e.ctrlKey||e.metaKey||e.shiftKey}var s;return s={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},n.normalizeQuery=function(e){return(e||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")},t.mixin(n.prototype,h,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.trigger("focused")},_onKeydown:function(e){var t=s[e.which||e.keyCode];this._managePreventDefault(t,e),t&&this._shouldTrigger(t,e)&&this.trigger(t+"Keyed",e)},_onInput:function(){this._checkInputValue()},_managePreventDefault:function(e,t){var n,i,r;switch(e){case"tab":i=this.getHint(),r=this.getInputValue(),n=i&&i!==r&&!o(t);break;case"up":case"down":n=!o(t);break;default:n=!1}n&&t.preventDefault()},_shouldTrigger:function(e,t){var n;switch(e){case"tab":n=!o(t);break;default:n=!0}return n},_checkInputValue:function(){var e,t,n;e=this.getInputValue(),t=r(e,this.query),n=t?this.query.length!==e.length:!1,this.query=e,t?n&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(e){this.query=e},getInputValue:function(){return this.$input.val()},setInputValue:function(e,t){this.$input.val(e),t?this.clearHint():this._checkInputValue()},resetInputValue:function(){this.setInputValue(this.query,!0)},getHint:function(){return this.$hint.val()},setHint:function(e){this.$hint.val(e)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var e,t,n,i;e=this.getInputValue(),t=this.getHint(),n=e!==t&&0===t.indexOf(e),i=""!==e&&n&&!this.hasOverflow(),!i&&this.clearHint()},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function(){var e=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=e},isCursorAtEnd:function(){var e,n,i;return e=this.$input.val().length,n=this.$input[0].selectionStart,t.isNumber(n)?n===e:document.selection?(i=document.selection.createRange(),i.moveStart("character",-e),e===i.text.length):!0},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$hint=this.$input=this.$overflowHelper=null}}),n}(),g=function(){"use strict";function n(n){n=n||{},n.templates=n.templates||{},n.source||e.error("missing source"),n.name&&!o(n.name)&&e.error("invalid dataset name: "+n.name),this.query=null,this.highlight=!!n.highlight,this.name=n.name||t.getUniqueId(),this.source=n.source,this.displayFn=i(n.display||n.displayKey),this.templates=r(n.templates,this.displayFn),this.$el=e(c.dataset.replace("%CLASS%",this.name))}function i(e){function n(t){return t[e]}return e=e||"value",t.isFunction(e)?e:n}function r(e,n){function i(e){return"<p>"+n(e)+"</p>"}return{empty:e.empty&&t.templatify(e.empty),header:e.header&&t.templatify(e.header),footer:e.footer&&t.templatify(e.footer),suggestion:e.suggestion||i}}function o(e){return/^[_a-zA-Z0-9-]+$/.test(e)}var s="ttDataset",a="ttValue",l="ttDatum";return n.extractDatasetName=function(t){return e(t).data(s)},n.extractValue=function(t){return e(t).data(a)},n.extractDatum=function(t){return e(t).data(l)},t.mixin(n.prototype,h,{_render:function(n,i){function r(){return g.templates.empty({query:n,isEmpty:!0})}function o(){function r(t){var n;return n=e(c.suggestion).append(g.templates.suggestion(t)).data(s,g.name).data(a,g.displayFn(t)).data(l,t),n.children().each(function(){e(this).css(u.suggestionChild)}),n}var o,d;return o=e(c.suggestions).css(u.suggestions),d=t.map(i,r),o.append.apply(o,d),g.highlight&&p({className:"tt-highlight",node:o[0],pattern:n}),o}function d(){return g.templates.header({query:n,isEmpty:!f})}function h(){return g.templates.footer({query:n,isEmpty:!f})}if(this.$el){var f,g=this;this.$el.empty(),f=i&&i.length,!f&&this.templates.empty?this.$el.html(r()).prepend(g.templates.header?d():null).append(g.templates.footer?h():null):f&&this.$el.html(o()).prepend(g.templates.header?d():null).append(g.templates.footer?h():null),this.trigger("rendered")}},getRoot:function(){return this.$el},update:function(e){function t(t){n.canceled||e!==n.query||n._render(e,t)}var n=this;this.query=e,this.canceled=!1,this.source(e,t)},cancel:function(){this.canceled=!0},clear:function(){this.cancel(),this.$el.empty(),this.trigger("rendered")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=null}}),n}(),m=function(){"use strict";function n(n){var r,o,s,a=this;n=n||{},n.menu||e.error("menu is required"),this.isOpen=!1,this.isEmpty=!0,this.datasets=t.map(n.datasets,i),r=t.bind(this._onSuggestionClick,this),o=t.bind(this._onSuggestionMouseEnter,this),s=t.bind(this._onSuggestionMouseLeave,this),this.$menu=e(n.menu).on("click.tt",".tt-suggestion",r).on("mouseenter.tt",".tt-suggestion",o).on("mouseleave.tt",".tt-suggestion",s),t.each(this.datasets,function(e){a.$menu.append(e.getRoot()),e.onSync("rendered",a._onRendered,a)})}function i(e){return new g(e)}return t.mixin(n.prototype,h,{_onSuggestionClick:function(t){this.trigger("suggestionClicked",e(t.currentTarget))},_onSuggestionMouseEnter:function(t){this._removeCursor(),this._setCursor(e(t.currentTarget),!0)},_onSuggestionMouseLeave:function(){this._removeCursor()},_onRendered:function(){function e(e){return e.isEmpty()}this.isEmpty=t.every(this.datasets,e),this.isEmpty?this._hide():this.isOpen&&this._show(),this.trigger("datasetRendered")},_hide:function(){this.$menu.hide()},_show:function(){this.$menu.css("display","block")},_getSuggestions:function(){return this.$menu.find(".tt-suggestion")},_getCursor:function(){return this.$menu.find(".tt-cursor").first()},_setCursor:function(e,t){e.first().addClass("tt-cursor"),!t&&this.trigger("cursorMoved")},_removeCursor:function(){this._getCursor().removeClass("tt-cursor")},_moveCursor:function(e){var t,n,i,r;if(this.isOpen){if(n=this._getCursor(),t=this._getSuggestions(),this._removeCursor(),i=t.index(n)+e,i=(i+1)%(t.length+1)-1,-1===i)return void this.trigger("cursorRemoved");-1>i&&(i=t.length-1),this._setCursor(r=t.eq(i)),this._ensureVisible(r)}},_ensureVisible:function(e){var t,n,i,r;t=e.position().top,n=t+e.outerHeight(!0),i=this.$menu.scrollTop(),r=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10),0>t?this.$menu.scrollTop(i+t):n>r&&this.$menu.scrollTop(i+(n-r))},close:function(){this.isOpen&&(this.isOpen=!1,this._removeCursor(),this._hide(),this.trigger("closed"))},open:function(){this.isOpen||(this.isOpen=!0,!this.isEmpty&&this._show(),this.trigger("opened"))},setLanguageDirection:function(e){this.$menu.css("ltr"===e?u.ltr:u.rtl)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},getDatumForSuggestion:function(e){var t=null;return e.length&&(t={raw:g.extractDatum(e),value:g.extractValue(e),datasetName:g.extractDatasetName(e)}),t},getDatumForCursor:function(){return this.getDatumForSuggestion(this._getCursor().first())},getDatumForTopSuggestion:function(){return this.getDatumForSuggestion(this._getSuggestions().first())},update:function(e){function n(t){t.update(e)}t.each(this.datasets,n)},empty:function(){function e(e){e.clear()}t.each(this.datasets,e),this.isEmpty=!0},isVisible:function(){return this.isOpen&&!this.isEmpty},destroy:function(){function e(e){e.destroy()}this.$menu.off(".tt"),this.$menu=null,t.each(this.datasets,e)}}),n}(),_=function(){"use strict";function n(n){var r,o,s;n=n||{},n.input||e.error("missing input"),this.isActivated=!1,this.autoselect=!!n.autoselect,this.minLength=t.isNumber(n.minLength)?n.minLength:1,this.$node=i(n.input,n.withHint),r=this.$node.find(".tt-dropdown-menu"),o=this.$node.find(".tt-input"),s=this.$node.find(".tt-hint"),o.on("blur.tt",function(e){var n,i,s;n=document.activeElement,i=r.is(n),s=r.has(n).length>0,t.isMsie()&&(i||s)&&(e.preventDefault(),e.stopImmediatePropagation(),t.defer(function(){o.focus()}))}),r.on("mousedown.tt",function(e){e.preventDefault()}),this.eventBus=n.eventBus||new d({el:o}),this.dropdown=new m({menu:r,datasets:n.datasets}).onSync("suggestionClicked",this._onSuggestionClicked,this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onAsync("datasetRendered",this._onDatasetRendered,this),this.input=new f({input:o,hint:s}).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this),this._setLanguageDirection()}function i(t,n){var i,o,a,l;i=e(t),o=e(c.wrapper).css(u.wrapper),a=e(c.dropdown).css(u.dropdown),l=i.clone().css(u.hint).css(r(i)),l.val("").removeData().addClass("tt-hint").removeAttr("id name placeholder required").prop("readonly",!0).attr({autocomplete:"off",spellcheck:"false",tabindex:-1}),i.data(s,{dir:i.attr("dir"),autocomplete:i.attr("autocomplete"),spellcheck:i.attr("spellcheck"),style:i.attr("style")}),i.addClass("tt-input").attr({autocomplete:"off",spellcheck:!1}).css(n?u.input:u.inputWithNoHint);try{!i.attr("dir")&&i.attr("dir","auto")}catch(d){}return i.wrap(o).parent().prepend(n?l:null).append(a)}function r(e){return{backgroundAttachment:e.css("background-attachment"),backgroundClip:e.css("background-clip"),backgroundColor:e.css("background-color"),backgroundImage:e.css("background-image"),backgroundOrigin:e.css("background-origin"),backgroundPosition:e.css("background-position"),backgroundRepeat:e.css("background-repeat"),backgroundSize:e.css("background-size")}}function o(e){var n=e.find(".tt-input");t.each(n.data(s),function(e,i){t.isUndefined(e)?n.removeAttr(i):n.attr(i,e)}),n.detach().removeData(s).removeClass("tt-input").insertAfter(e),e.remove()}var s="ttAttrs";return t.mixin(n.prototype,{_onSuggestionClicked:function(e,t){var n;(n=this.dropdown.getDatumForSuggestion(t))&&this._select(n)},_onCursorMoved:function(){var e=this.dropdown.getDatumForCursor();this.input.setInputValue(e.value,!0),this.eventBus.trigger("cursorchanged",e.raw,e.datasetName)},_onCursorRemoved:function(){this.input.resetInputValue(),this._updateHint()},_onDatasetRendered:function(){this._updateHint()},_onOpened:function(){this._updateHint(),this.eventBus.trigger("opened")},_onClosed:function(){this.input.clearHint(),this.eventBus.trigger("closed")},_onFocused:function(){this.isActivated=!0,this.dropdown.open()},_onBlurred:function(){this.isActivated=!1,this.dropdown.empty(),this.dropdown.close()},_onEnterKeyed:function(e,t){var n,i;n=this.dropdown.getDatumForCursor(),i=this.dropdown.getDatumForTopSuggestion(),n?(this._select(n),t.preventDefault()):this.autoselect&&i&&(this._select(i),t.preventDefault())},_onTabKeyed:function(e,t){var n;(n=this.dropdown.getDatumForCursor())?(this._select(n),t.preventDefault()):this._autocomplete(!0)},_onEscKeyed:function(){this.dropdown.close(),this.input.resetInputValue()},_onUpKeyed:function(){var e=this.input.getQuery();this.dropdown.isEmpty&&e.length>=this.minLength?this.dropdown.update(e):this.dropdown.moveCursorUp(),this.dropdown.open()},_onDownKeyed:function(){var e=this.input.getQuery();this.dropdown.isEmpty&&e.length>=this.minLength?this.dropdown.update(e):this.dropdown.moveCursorDown(),this.dropdown.open()},_onLeftKeyed:function(){"rtl"===this.dir&&this._autocomplete()},_onRightKeyed:function(){"ltr"===this.dir&&this._autocomplete()},_onQueryChanged:function(e,t){this.input.clearHintIfInvalid(),t.length>=this.minLength?this.dropdown.update(t):this.dropdown.empty(),this.dropdown.open(),this._setLanguageDirection()},_onWhitespaceChanged:function(){this._updateHint(),this.dropdown.open()},_setLanguageDirection:function(){var e;this.dir!==(e=this.input.getLanguageDirection())&&(this.dir=e,this.$node.css("direction",e),this.dropdown.setLanguageDirection(e))},_updateHint:function(){var e,n,i,r,o,s;e=this.dropdown.getDatumForTopSuggestion(),e&&this.dropdown.isVisible()&&!this.input.hasOverflow()?(n=this.input.getInputValue(),i=f.normalizeQuery(n),r=t.escapeRegExChars(i),o=new RegExp("^(?:"+r+")(.+$)","i"),s=o.exec(e.value),s?this.input.setHint(n+s[1]):this.input.clearHint()):this.input.clearHint()},_autocomplete:function(e){var t,n,i,r;t=this.input.getHint(),n=this.input.getQuery(),i=e||this.input.isCursorAtEnd(),t&&n!==t&&i&&(r=this.dropdown.getDatumForTopSuggestion(),r&&this.input.setInputValue(r.value),this.eventBus.trigger("autocompleted",r.raw,r.datasetName))},_select:function(e){this.input.setQuery(e.value),this.input.setInputValue(e.value,!0),this._setLanguageDirection(),this.eventBus.trigger("selected",e.raw,e.datasetName),this.dropdown.close(),t.defer(t.bind(this.dropdown.empty,this.dropdown))},open:function(){this.dropdown.open()},close:function(){this.dropdown.close()},setVal:function(e){e=t.toStr(e),this.isActivated?this.input.setInputValue(e):(this.input.setQuery(e),this.input.setInputValue(e,!0)),this._setLanguageDirection()},getVal:function(){return this.input.getQuery()},destroy:function(){this.input.destroy(),this.dropdown.destroy(),o(this.$node),this.$node=null}}),n}();!function(){"use strict";var n,i,r;n=e.fn.typeahead,i="ttTypeahead",r={initialize:function(n,r){function o(){var o,s,a=e(this);t.each(r,function(e){e.highlight=!!n.highlight}),s=new _({input:a,eventBus:o=new d({el:a}),withHint:t.isUndefined(n.hint)?!0:!!n.hint,minLength:n.minLength,autoselect:n.autoselect,datasets:r}),a.data(i,s)}return r=t.isArray(r)?r:[].slice.call(arguments,1),n=n||{},this.each(o)},open:function(){function t(){var t,n=e(this);(t=n.data(i))&&t.open()}return this.each(t)},close:function(){function t(){var t,n=e(this);(t=n.data(i))&&t.close()}return this.each(t)},val:function(t){function n(){var n,r=e(this);(n=r.data(i))&&n.setVal(t)}function r(e){var t,n;return(t=e.data(i))&&(n=t.getVal()),n}return arguments.length?this.each(n):r(this.first())},destroy:function(){function t(){var t,n=e(this);(t=n.data(i))&&(t.destroy(),n.removeData(i))}return this.each(t)}},e.fn.typeahead=function(t){var n;return r[t]&&"initialize"!==t?(n=this.filter(function(){return!!e(this).data(i)}),r[t].apply(n,[].slice.call(arguments,1))):r.initialize.apply(this,arguments)},e.fn.typeahead.noConflict=function(){return e.fn.typeahead=n,this}}()}(window.jQuery),jQuery(document).onZonesAndDomReady(function(){"use strict";function e(e,t,n){jQuery(e).off(t).on(t,n)}function t(){w.CurrentWidth.getClientWidth()>w.minWidthForExpandElements?(fastdom.measure(function(){e(".js__image--expandable","click",function(){var e=jQuery(this),t=e.parents(".el__embedded");fastdom.mutate(function(){t.find(".el__image__close--expandable").show(),e.stop().animate({width:"100%","margin-top":I,"margin-right":0},A,function(){w.ResponsiveImages.processChildrenImages(this),t.addClass("el__embedded--open").height(e.outerHeight())}).show().addClass("el__image--expandfull").removeClass("el__image--expandable")})})}),fastdom.measure(function(){e(".js__image__close--expandable","click",function(e){var t=jQuery(this),n=t.parents(".el__embedded");n.removeClass("el__embedded--open").css("height","auto"),t.hide(),fastdom.mutate(function(){n.find(".js__image--expandable").stop().animate({width:b,"margin-top":"10px","margin-right":"30px"},A,function(){w.ResponsiveImages.processChildrenImages(this)}).show().addClass("el__image--expandable").removeClass("el__image--expandfull")}),e.stopPropagation()})}),fastdom.mutate(function(){jQuery(".el__image--expandable .el__image__expand--expandable").show(),jQuery(".el__image--expandfull .el__image__close--expandable").show()})):fastdom.mutate(function(){jQuery(".el__image__close--expandable").hide(),jQuery(".el__image__expand--expandable").hide(),jQuery(".js__image--expandable").off()})}function n(e,t){fastdom.measure(function(){var n=t.parents(".el__embedded"),i=t.find(".media__video--thumbnail"),r=t.find(".media__video--responsive"),o=t.find(".el__storyelements--close"),s=n.find(".video-red-spinner"),a=r.find("object").get(0),l=r.find("video").get(0),c=navigator.userAgent.toLowerCase();"undefined"==typeof C&&(C=t.width()),fastdom.mutate(function(){i.css("position",""),t.stop().animate({width:"100%","margin-top":I,"margin-right":0},A,function(){S?(s.show(),-1===c.indexOf("msie")&&-1===c.indexOf("trident")||"undefined"==typeof a||a.replayContent()):"undefined"!=typeof l&&l.play(),n.addClass("el__embedded--open"),t.find(".el__video__play-button").triggerHandler("click")}),t.show().addClass("el__video--expandfull").removeClass(e),r.show(),window.innerWidth>w.minWidthForExpandElements?(o.show(),o.css("display","block")):(o.hide(),o.css("display","none"))})})}function i(e,t,n){var i,r=t.parents(".el__embedded"),o=".js-media__video .js-video__end-slate",s=r.find(".media__video--thumbnail"),a=r.find(".media__video--responsive"),l=r.find(".video-red-spinner"),c=a.find("object").get(0),u=a.find("video").get(0),d=navigator.userAgent.toLowerCase();t=t.parent(),fastdom.mutate(function(){r.removeClass("el__embedded--open"),t.stop().animate({width:C,"margin-top":"10px","margin-right":"30px"},A,function(){t.css("width","")}),t.find(".el__video__close--expandable").hide(),t.addClass(e).removeClass("el__video--expandfull"),a.hide(),s.show(),s.css("position","relative"),S?(l.hide(),-1===d.indexOf("msie")&&-1===d.indexOf("trident")||"undefined"==typeof c||c.stopContent()):"undefined"!=typeof u&&u.pause()}),i=r.find(o).eq(0),fastdom.mutate(function(){i.removeClass("video__end-slate--active").addClass("video__end-slate--inactive"),r.find(".js-video-demand").show()}),n.stopPropagation()}function r(){w.CurrentWidth.getClientWidth()>w.minWidthForExpandElements?(e(".js__video--standard","click",function(){n("el__video--standard",jQuery(this))}),e(".js__video--expandable","click",function(){n("el__video--expandable",jQuery(this))}),e(".js__video__close--standard","click",function(e){i("el__video--standard",jQuery(this),e)}),e(".js__video__close--expandable","click",function(e){i("el__video--expandable",jQuery(this),e)}),fastdom.mutate(function(){jQuery(".el__video--expandfull .el__video__close--standard").show(),jQuery(".el__video--expandfull .el__video__close--expandable").show(),jQuery(".el__video--expandable .el__video__expand--expandable").show(),jQuery(".el__video--standard .el__video__expand--standard").show(),jQuery(".js-video-demand").show()})):fastdom.mutate(function(){jQuery(".el__video__close--standard").hide(),jQuery(".el__video__expand--standard").hide(),jQuery(".el__video__close--expandable").hide(),jQuery(".el__video__expand--expandable").hide(),jQuery(".js-video-demand").hide(),w.orientationLandscape===!0&&jQuery(".js-video-demand").show()}),x===!1&&w.orientationLandscape===!0&&(jQuery(".js__video--standard").each(function(){var e=jQuery(this);0===e.find(".js-el__video__play-button").size()?(e.find(".js-video-demand").hide(),w.orientationLandscape===!0&&n("el__video--standard",e.find(".el__video__expand--standard"))):fastdom.mutate(function(){e.find(".js-video-demand").show()})}),jQuery(".js__video--expandable").each(function(){var e=jQuery(this);0===e.find(".js-el__video__play-button").size()?(e.find(".js-video-demand").hide(),w.orientationLandscape===!0&&n("el__video--expandable",e.find(".el__video__expand--expandable"))):fastdom.mutate(function(){e.find(".js-video-demand").show()})})),x=!1}function o(e,t,n){t.is(".el__gallery--expandfull")||fastdom.measure(function(){if("undefined"==typeof y&&(y=t.width()),w.CurrentWidth.getClientWidth()>w.minWidthForExpandElements){var i,r,o=t.parents(".el__embedded"),s=t,a=t.find(".el__gallery--teaseimage"),l=t.find(".el-carousel__wrapper"),c=l.find(".js-owl-carousel"),d=l.find(".js-owl-filmstrip"),h=!!l.attr("data-initialized");l.css({display:"block",visibility:"visible",opacity:"0"}),r=function(){l.css({opacity:"1",position:"relative","z-index":"0"}),l.attr("data-initialized","true")},s.stop().animate({width:o.width()+"px","margin-top":I,"margin-right":0},A,function(){s.css("width","100%"),i=9*o.width()/16/2-T,c.siblings(".ad-slide").find(".ad-slide__prev, .ad-slide__next").css("top",i+"px"),o.addClass("el__embedded--open"),o.css("overflow","hidden"),s.css({"min-height":a.height()+"px","max-height":a.height()+"px"}),setTimeout(function(e,t){e.css({"max-height":1.5*t.height()+"px"})},100,s,c),h===!1||c.data("owl.carousel").width()!==s.width()?(c.on("resized.owl.carousel",function(e){r(),jQuery(this).off("resized.owl.carousel")}),d.on("resized.owl.carousel",function(e){w.Carousel.owl().setNumberOfItems(e),e.relatedTarget.to(1),e.relatedTarget.to(0),jQuery(this).off("resized.owl.carousel")}),c.data("owl.carousel").onResize(),d.data("owl.carousel").onResize()):r()}),s.addClass("el__gallery--expandfull").removeClass(e),"undefined"!=typeof l.attr("isExtended")&&"false"!==l.attr("isExtended")||(setTimeout(function(){u(jQuery(l.find(".owl-wrapper-outer")),!0,!0)},2e3),l.attr("isExtended","true"))}else n.stopPropagation()})}function s(e,t,n){var i=t.parents(".el__embedded"),r=i.find(".el-carousel__wrapper"),o=r.find(".owl-wrapper-outer"),s=o.find(".el__gallery-caption"),a=t.parents(".el__gallery--expandfull");fastdom.mutate(function(){i.css({"max-height":"",overflow:""}),r.css({position:"absolute",opacity:0}),i.removeClass("el__embedded--open"),a.css({"min-height":"","max-height":""}),a.stop().animate({width:y,"margin-top":"10px","margin-right":"30px"},A,function(){a.addClass(e).removeClass("el__gallery--expandfull")}),r.attr("isExtended","false"),a.addClass(e).removeClass("el__gallery--expandfull")}),s.hasClass("el__gallery-caption--closed")&&(s.toggleClass("el__gallery-caption--closed"),s.text(a.hasClass("el__gallery-caption--closed")?"Show Caption":"Hide Caption")),n.stopPropagation()}function a(){window.innerWidth>w.minWidthForExpandElements?(e(".js__gallery--standard","click",function(e){o("el__gallery--standard",jQuery(this),e)}),e(".js__gallery--expandable","click",function(e){o("el__gallery--expandable",jQuery(this),e)}),e(".js__gallery__close--standard","click",function(e){s("el__gallery--standard",jQuery(this),e)}),e(".js__gallery__close--expandable","click",function(e){s("el__gallery--expandable",jQuery(this),e)}),jQuery(".js__gallery__close--standard, .js__gallery__close--expandable").trigger("click"),fastdom.mutate(function(){jQuery(".el-carousel__wrapper").not(jQuery(".zn-large-media .el-carousel__wrapper, .el__embedded--fullstandardwidth .el-carousel__wrapper,.pg-special-article__head .el-carousel__wrapper")).css({opacity:"0",position:"","z-index":""})})):fastdom.mutate(function(){jQuery(".el-carousel__wrapper").css({opacity:"1",position:"relative","z-index":"0"})}),E===!1&&window.innerWidth<=w.showGalleryCaptionWidth&&l()}function l(){jQuery(".js__leafmedia--gallery").each(function(e,t){fastdom.mutate(function(){jQuery(".el__gallery_image-title",t).hide(),jQuery(".el__gallery-caption",t).addClass("el__gallery-caption--closed").text("Show Caption")})})}function c(e,t){var n=jQuery(e),i=n.closest(".owl-stage"),r=i.find(".el__gallery_image-title"),o=i.find(".el__gallery-caption");w.CurrentWidth.getClientWidth()>w.minWidthForExpandElements?o.hasClass("el__gallery-caption--closed")?(o.removeClass("el__gallery-caption--closed"),r.show()):(o.addClass("el__gallery-caption--closed"),
r.hide()):(o.toggleClass("el__gallery-caption--closed"),r.toggle()),w.Carousel.refreshCarousels(),o.text(o.hasClass("el__gallery-caption--closed")?"Show Caption":"Hide Caption")}function u(e,t,n){var i=0,r=0,o=jQuery(".owl-item",e).each(function(){r=jQuery(this).height(),t&&jQuery(this).attr("owlItemHeight",r),r>i&&(i=r)});t&&jQuery(e).attr("max",i),o.each(function(){var i=jQuery(this),r=jQuery(".el__gallery-showhide",i);t||n?r.css("bottom",i.attr("owlItemHeight")-jQuery(e).attr("max")+"px"):r.css("bottom","0px")})}function d(e){if(e){var t,n;for(t=0,n=e.length;n>t;t++)u(e[t],!0,!0)}}function h(){t(),r(),a()}function p(){var e=j[0].getBoundingClientRect().bottom,t=U.find(".el__alignbottom").last(),n=U.find(".el__locked").last();R(H)&&R(H[0])&&(H[0].getBoundingClientRect().top<=e&&!H.hasClass("el__alignbottom")&&f(H,e),t.length>0&&t[0].getBoundingClientRect().top>=e&&f(t,e),n.length>0&&n.parent()[0].getBoundingClientRect().top>n[0].getBoundingClientRect().top&&(n.removeClass("el__locked").attr("style",""),1===n.length&&(H=Q.eq(0).find(".l-container"),W=Q.eq(1))),H[0].getBoundingClientRect().bottom>W[0].getBoundingClientRect().top&&(H.removeClass("el__locked").attr("style","").addClass("el__alignbottom"),J===!0&&(H=Q.eq(1).find(".l-container"),W=Q.eq(2))))}function f(e,t){e.removeClass("el__alignbottom").addClass("el__locked").css({left:jQuery(".pg-rail")[0].getBoundingClientRect().left,top:t})}function g(e){e.css("opacity",1)}function m(e,t){q.eq(2).length>0&&(D=e-q.eq(2)[0].getBoundingClientRect().height),e!==t.css("min-height")+t.next(".zn").css("min-height")&&(t.height()>e&&(e=t.height()),J===!0&&(D=e/2,t.next(".zn").css("min-height",e)),t.css("min-height",D)),g(q)}function _(){var e,t,n,i=[],r=[];if(O===!0){for(J===!0&&null!==Y?i=Y:null!==ee&&(i=ee),n=0;n<i.length;n++)R(i[n].adId)&&(r.push(i[n].adId),e=i[n].adId,t=q.eq(i[n].zonePosition).find(".zn__containers .column").eq(i[n].columnPosition),t.find(".ad--desktop").length<=0&&t.prepend('<div class="ad ad--epic ad--desktop" data-ad-text="show"><div data-ad-id="'+e+'" data-ad-position="desktop" data-ad-refresh="adtop"><div id="'+e+'" class="ad-'+e+' ad-refresh-adbody"></div></div></div>'));if(w.contentModel.registryURL)try{AdFuel.clearSlot(r),AdFuel.dispatchQueue({slots:r})}catch(o){console.log("Failed to insert ad container.")}G=!0}}function v(){var e,t=V.length>0?V[0].getBoundingClientRect().height:0,n=z.length>0?z[0].getBoundingClientRect().height+t:0;if(S===!0&&n>L){if(w.adLockLongArticleEnable===!0&&n>X&&!q.eq(1).is(":visible")){if(J=!0,Z.length>0&&K.eq(0).find(".js-m-outbrain").length<=0&&(K.eq(0).find(".cn").append('<li><article class="cd cd--tool cd--tool__outbrain"><div class="OB_'+Z+'"><div class="OUTBRAIN js-m-outbrain m-outbrain" data-src="'+$+'" data-widget-id="'+Z+'" data-ob-template="cnn"></div></article></li>'),R(window.OBR)&&R(window.OBR.extern)))try{window.OBR.extern.researchWidget()}catch(i){console.log("Failed to load Outbrain widget ID",Z)}null!==Y&&K.eq(1).length<=0&&K.after('<div class="column"></div>'),W=q.eq(1),W.show(),Q=U.find(".zn:visible")}e=q.eq(0),m(n,e),p()}else g(q);G===!1&&_()}var y,C,w=window.CNN||{},b=jQuery(".js__image--expandable").width(),E=!1,A=700,T=30,S=Modernizr&&!Modernizr.phone&&!Modernizr.mobile&&!Modernizr.tablet,k=jQuery("html.mobile").length>0,P=jQuery(window),x=!0,I="36px",R=w.Utils.exists,L=1e3,D=0,O=R(w.rightRailConfig),F=!(!O||!R(w.rightRailConfig.longArticle)),M=!(!O||!R(w.rightRailConfig.shortArticle)),N=jQuery(document),j=jQuery(".nav"),B=jQuery(".pg-rail"),U=jQuery(".pg-rail.pg-rail-tall__rail"),q=U.find(".zn"),V=jQuery(".pg-rail-tall__head .zn-body"),z=jQuery(".pg-rail-tall__body .zn-body"),Q=U.find(".zn:visible"),H=Q.eq(0).find(".l-container"),W=Q.eq(1),K=q.eq(1).find(".zn__containers").find(".column"),$=jQuery('meta[property="vr:canonical"]').attr("content")||"",J=!1,G=!1,X=F&&w.rightRailConfig.longArticle.articleLength||0,Y=F&&w.rightRailConfig.longArticle.epic||null,Z=F&&w.rightRailConfig.longArticle.outbrain&&w.rightRailConfig.longArticle.outbrain.widgetId||"",ee=M&&w.rightRailConfig.shortArticle.epic||null;w.contentModel=w.contentModel||{},w.CurrentWidth=w.CurrentWidth||{},w.CurrentWidth.getClientWidth=w.CurrentWidth.getClientWidth||jQuery.noop,w.minWidthForExpandElements=480,w.showGalleryCaptionWidth=640,w.orientationLandscape=!1,w.adLockingDisableWidth=960,w.adLockEnable=!!(R(w.AdsConfig)&&w.AdsConfig.enableAdLock===!0&&w.CurrentWidth.getClientWidth()>=w.adLockingDisableWidth&&jQuery(".pg-rail.pg-rail-tall__rail").length>0&&jQuery(".pg-rail-tall__head").length>0),w.adLockLongArticleEnable=!(!w.adLockEnable||!F||w.rightRailConfig.longArticle.enableAdLock!==!0||0===X),h(),k?P.on("orientationchange",function(){w.Carousel.resetOnResize()}):jQuery(window).resize(function(){E=!0,h(),setTimeout(function(){d(jQuery(".owl-wrapper-outer"))},2e3)}),function(){function e(e,t){function n(){r.addClass(t)}function i(){r.removeClass(t)}var r=jQuery(e).children().last(),o=window.CNN.eventListenerWithOptions&&window.CNN.eventListenerWithOptions.addListener;o(e,"touchstart",n,{passive:!0}),o(e,"touchcancel",i,{passive:!0}),o(e,"touchend",i,{passive:!0})}function t(t,r){e(r,i[n].className)}var n=0,i=[];for(i=[{selector:".js__image--expandable",className:"el__image--touchhover"},{selector:".js__video--standard",className:"el__video--touchhover"},{selector:".js__video--expandable",className:"el__video--touchhover"},{selector:".js__gallery--standard",className:"el__gallery--touchhover"},{selector:".js__gallery--expandable",className:"el__gallery--touchhover"}],n=0;n<i.length;n++)jQuery(i[n].selector).each(t)}(),jQuery(".js-el__gallery-caption").on("click",function(){c(this)}),w.adLockEnable===!0&&(jQuery(window).throttleEvent("scroll",function(){w.adLockEnable===!0&&(v(),0===N.scrollTop()&&q.find(".l-container").removeClass("el__locked"))},10,this),jQuery(window).throttleEvent("resize",function(){w.adLockEnable===!0&&S===!0&&(v(),w.CurrentWidth.getClientWidth()<w.adLockingDisableWidth?(B.find(".l-container").removeClass("el__locked").attr("style",""),q.eq(0).attr("style",""),w.adLockEnable=!1):0===N.scrollTop()&&q.find(".el__locked").css({left:jQuery(".pg-rail")[0].getBoundingClientRect().left}))},50,this),v())});var nativo={},$staggeredZone,$staggeredColumn,$nativeContainer,layoutSize,$staggeredNativo,$authorDetails,$twitterImage,$nativeEmbedVideo,$bigPicture,isGalleryRendered=!1,epicScript,$nativeHubCarousel,isEpicRendered=!1;!function(){"use strict";function e(e,t){var n=jQuery(e).closest(document.getElementById("bigPicture")),i=n.find(".media__caption"),r=n.find(".el__gallery-caption");CNN.CurrentWidth=CNN.CurrentWidth||{},CNN.CurrentWidth.getClientWidth=CNN.CurrentWidth.getClientWidth||jQuery.noop,CNN.CurrentWidth.getClientWidth()>CNN.minWidthForExpandElements?r.hasClass("el__gallery-caption--closed")?r.removeClass("el__gallery-caption--closed"):r.addClass("el__gallery-caption--closed"):r.toggleClass("el__gallery-caption--closed"),i.toggle(t),r.text(r.hasClass("el__gallery-caption--closed")?"Show Caption":"Hide Caption")}function t(e){var t=jQuery(".js-pg-sponsor .owl-stage-outer .owl-stage .owl-item.synced"),i=t.next(),r=t.prev();"prev"===e?"undefined"!=typeof r&&r.length>0&&n(r):"undefined"!=typeof i&&i.length>0&&n(i)}function n(e){var t=jQuery(".js-pg-sponsor"),n=t.find(".cnngo-bigPicture"),i=n.find("img"),r=e.find(".link").attr("data-img-full");i.attr("src",r),e.parent().find(".owl-item").removeClass("synced"),e.addClass("synced"),n.find(".js-active-count").html(e.closest(".owl-item").index()+1),n.find(".image__caption").html(e.find(".link").attr("data-value"))}nativo={fbFeed:"",twFeed:"",social_hub:{icons:{twitter:"",facebook:"",linkedin:"",google:"",pinterest:"",instagram:""},fb_like:"",tw_follow:""}},nativo.renderAuthor=function(){"string"==typeof nativo.authorName&&nativo.authorName.length>0&&($authorDetails=jQuery(".js-sponsor-article-author"),$authorDetails.find(".js-author_name").text(nativo.authorName+","),$authorDetails.show())},nativo.renderEpic=function(){var e="international"===CNN.contentModel.edition?"cnni":"cnn";"string"==typeof nativo.epicAdName&&nativo.epicAdName.length>0&&!isEpicRendered&&(window.AMPTManager.processNewRegistry(CNN.epicAdRegistry+"/"+e+"_native_"+nativo.epicAdName+".js"),jQuery(".js-epicAd_Render").show(),isEpicRendered=!0)},nativo.renderFacebook=function(){if("string"==typeof nativo.fbFeed&&nativo.fbFeed.length>0){var e=encodeURIComponent(nativo.fbFeed),t=document.getElementById("fb-likebox");t.innerHTML='<iframe src="//www.facebook.com/plugins/likebox.php?href='+e+'&amp;width=300&amp;height=590&amp;show_faces=true&amp;colorscheme=light&amp;stream=true&amp;show_border=true&amp;header=true&amp;appId=70673860847" scrolling="no" frameborder="0" class="sponsor-content-fb" allowTransparency="true"></iframe>'}},nativo.renderTwitter=function(){"string"==typeof nativo.twFeed&&nativo.twFeed.length>0&&(jQuery(document.getElementById("tw-feedbox")).html(nativo.twFeed),jQuery(".js-right-rail-tw").show());var e,t=document.getElementsByTagName("script")[0];document.getElementById("twitter-wjs")||(e=document.createElement("script"),e.id="twitter-wjs",e.src="//platform.twitter.com/widgets.js",t.parentNode.insertBefore(e,t)),"string"==typeof nativo.twitterImage&&nativo.twitterImage.length>0&&($twitterImage=jQuery(".js-twitterImage"),$twitterImage.find("img").attr("src",nativo.twitterImage),$twitterImage.show())},nativo.renderGallery=function(){setTimeout(function(){jQuery(".js-pg-sponsor .owl-carousel").owlCarousel({slideSpeed:300,pagination:!0,paginationSpeed:400,items:9,nav:!0,navText:["",""],dots:!1,lazyLoad:!0,loop:!1,autoWidth:!0,autoHeight:!1});var n=jQuery(".js-pg-sponsor"),i=n.find(".cnngo-bigPicture"),r=i.find("img"),o=n.find(".owl-carousel").find(".link"),s=o.first().attr("data-img-full"),a=o.first().attr("data-value"),l=i.attr("data-title"),c=n.find(".owl-stage-outer .owl-stage"),u=c.find(".owl-item").length,d=1;0===i.find("img").length&&i.append("<img/>"),r.attr("src",s),i.append(n.find(".js-galleryCaption")),i.append(n.find(".js-owl-nav")),u>=1&&(i.find(".js-active-count").html(d),i.find(".js-total-count").html(u),i.find(".js-gallery-title").html(l),i.find(".el__storyelement__gray").html(" "+u+" Photos"),c.find(".owl-item").first().addClass("synced"),i.find(".image__caption").html(a)),o.on("click",function(e){var t=jQuery(this);r.attr("src",t.data("imgFull")),t.parent().parent().find(".owl-item").removeClass("synced"),t.parent().addClass("synced"),i.find(".js-active-count").html(t.closest(".owl-item").index()+1),i.find(".image__caption").html(t.attr("data-value"))}),i.find(".js-el__gallery-caption").click(function(){e(this,"slow")}),i.find(".js-owl-prev").click(function(){t("prev")}),i.find(".js-owl-next").click(function(){t("next")}),changeOwlCarousalWidth()},800)},jQuery(window).resize(function(){setTimeout(function(){changeOwlCarousalWidth()},300)})}(),function(){"use strict";try{CNN.INJECTOR.scriptComplete("header2")}catch(e){console.log(e)}}();