!function(e){"use strict";function t(e){var t=e.attr("id");if("undefined"==typeof t||""===t){do t="gigyaShareBar_"+N,N+=1;while(document.getElementById(t));e.attr("id",t)}return t}function a(e,t){if("function"==typeof window.trackMetrics)try{window.trackMetrics({type:"social-click",data:{clickObj:{socialType:"social: "+e,headline:t}}})}catch(a){}}function i(t,i){e.each(t.providers.split(","),function(n,o){a(o,i.title),e.ajax({url:CNN.SocialConfig.gigya.shareStatsPostURL||"",dataType:"json",type:"POST",data:{actionType:"socialShare",socialType:o||"",headline:i.title||"",shortUrl:t.targetURL||"",url:window.location.href||"",env:CNN.contentModel.env||""}})})}function n(e,t){var a=e.clone();return t&&t.url&&a.setLinkBack(t.url),a}function o(a,n){var o,r,s,d,c=CNN.accounts.cfg.gigya;n=n||{},"undefined"!=typeof n.elem&&"undefined"!=typeof n.elem.data("isshorturl")&&(C=n.elem.data("isshorturl")),r=e("<div>").attr("data-js-gigya-share","wrapper").appendTo("body"),s=t(r),d=C?"never":"whenRequired",o={deviceType:"auto",wrap:!0,operationMode:"simpleShare",containerID:s,userAction:a,moreEnabledProviders:c.primaryProviders+","+c.moreEnabledProviders,shortURLs:d,onSendDone:function(e){i(e,a)}},gigya.socialize.showShareUI(o),window.setTimeout(function(){r.attr("data-js-gigya-share-fade","")},10),window.setTimeout(function(){r.attr("data-js-gigya-share-active","")},300)}function r(e){var t=v||w;t?(t=n(t,e),o(t,e)):window.console&&window.console.error&&window.console.error("No canonical share widget has been defined")}function s(a,n){var o,r,s,d,c,l,u=CNN.accounts.cfg.gigya;n=n||{},"undefined"!=typeof n.elem&&null!==n.elem&&"function"==typeof n.elem.data&&"undefined"!=typeof n.elem.data("isshorturl")&&(C=n.elem.data("isshorturl")),r=e("<div>"),!Modernizr.mobile||Modernizr.ios&&Modernizr.tablet?r.appendTo(n.elem):(r.appendTo("body"),r.css("z-index","100")),s=t(r),d=C?"never":"whenRequired",o={deviceType:"auto",wrap:!0,operationMode:"simpleShare",containerID:s,userAction:a,moreEnabledProviders:u.primaryProviders+","+u.moreEnabledProviders,shortURLs:d,onSendDone:function(e){i(e,a)},onLoad:function(t){c=e(n.elem).offset(),l=e(n.elem).find(e("div.gig-simpleShareUI")),"undefined"!=typeof l&&c.left<320&&(!Modernizr.mobile||Modernizr.ios&&Modernizr.tablet?e(l).css("margin-left","35px"):e(l).css("margin-left","0px")),e("div.gig-simpleShareUI-caption").on("click",function(){return!1}),e("div.gig-simpleShareUI-button").on("click",function(){return e("div.gig-simpleShareUI").hide(),!1})}},gigya.socialize.showShareUI(o),window.setTimeout(function(){r.attr("data-js-gigya-share-fade","")},10),window.setTimeout(function(){r.attr("data-js-gigya-share-active","")},300)}function d(t){var a,i=t.attr("data-canonical"),n=t.attr("data-user-message"),o=t.attr("data-link"),r=t.attr("data-title"),s=t.attr("data-subtitle"),d=t.attr("data-description"),c=t.attr("data-twitter-account"),l=t.attr("data-image-src"),u=new gigya.socialize.UserAction;return n&&u.setUserMessage(n),o&&(u.setLinkBack(o),u.addActionLink("Read More",o)),r&&u.setTitle(e.trim(r)+(c?" @"+c:"")),s&&u.setSubtitle(s),d&&u.setDescription(d),l&&(a={type:"image",src:l},o&&(a.href=o),u.addMediaItem(a)),"undefined"!=typeof i&&(v=u),C=t.attr("data-isshorturl"),u}function c(a,n,o){var r,s,d=CNN.accounts.cfg.gigya,c=e("<div>"),l=t(c),u=d.showCounts,h="gigya-sharebar-element";b>3&&(h+=" gigya-element-large"),c.addClass(h).appendTo(n),b+=1,"none"===u&&"Facebook-Like"===a&&(u="right"),r=C?"never":"Facebook"===a?"never":"whenRequired",void 0!==d.providerCfg[a]?(d.providerCfg[a].provider=a,s=[d.providerCfg[a]]):s=a,gigya.socialize.showShareBarUI({deviceType:"auto",operationMode:"simpleShare",containerID:l,showCounts:u,userAction:o,shareButtons:s,moreEnabledProviders:d.moreEnabledProviders,shortURLs:r,useEmailCaptcha:!1,showEmailButton:!0,emailBody:"$userMsg$<br /><br />I thought you'd like this:<br />$URL$<br /><br />$title$<br />$description$<br />",useHTML:!0,onSendDone:function(e){i(e,o)}})}function l(e){var t,a=CNN.accounts.cfg.gigya.shareButtons.split(","),i=d(e),n=a.length;for(b=1,"undefined"==typeof w&&(w=i),t=0;n>t;t++)c(a[t],e,i)}function u(e){var t=d(e);e.on("click",function(){o(t,{elem:e})}),e.show()}function h(t){var a,i;t.on("click",function(n){i=e(this),a=d(i),s(a,{elem:t})})}function g(t,a,i,n){return!t&&window.console&&window.console.error?void window.console.error("Gigya not loaded -- share bar disabled."):(a.each(function(){l(e(this))}),i.each(function(){u(e(this))}),void n.each(function(){h(e(this))}))}function f(t){var a=e(".js-gigya-sharebar"),i=e(".js-gigya-share"),n=e(".js-gigya-share-collection");(a.length||i.length||n.length)&&(m=t,CNN.accounts.loadGigya(function(e){g(e,a,i,n)}))}function p(){var t,a,i=e(".share-bar-whatsapp-container"),n=0,o=0;if(i.length)if(e("html").hasClass("mobile")&&e("html").hasClass("phone"))for(t=e(".gigya-sharebar-element"),a=0;a<t.length;a++)3!==a&&5!==n||(e(t[a]).after(e(i[o])),e(i[o]).show(),n=0,o++),n++;else e(i).hide()}function y(){var t,a,i=e(".js-gigya-sharebar"),n=e(".js-gigya-share"),o=e(".js-gigya-share-collection");if(i&&i.length>0){for(t=0;t<i.length;t++)a=e(i[t]).find("div.share-bar-whatsapp-container"),"undefined"!=typeof a&&e(i[t]).before(e(a));i.html("")}n&&n.length>0&&n.html(""),o&&o.length>0&&o.html(""),(i.length||n.length||o.length)&&CNN.accounts.loadGigya(function(e){g(e,i,n,o),p()})}var m,w,v,b,N=0,C=!1;e(window).load(p),e(function(){CNN.accounts.onInitialized(f)}),window.CNN=window.CNN||{},CNN.gigyaShareBar=function(){CNN.accounts.onInitialized(f)},CNN.share=CNN.share||{},CNN.share.popup=r,CNN.share.reloadShareBar=y}(jQuery);